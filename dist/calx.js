/*! For license information please see calx.js.LICENSE.txt */
!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(self,(()=>(()=>{var t={386:(t,e)=>{var n=function(){function t(t,e){var n;if(Object.defineProperty(this,"name",{enumerable:!1,writable:!1,value:"JisonParserError"}),null==t&&(t="???"),Object.defineProperty(this,"message",{enumerable:!1,writable:!0,value:t}),this.hash=e,e&&e.exception instanceof Error){var r=e.exception;this.message=r.message||t,n=r.stack}n||(Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,this.constructor):n=new Error(t).stack),n&&Object.defineProperty(this,"stack",{enumerable:!1,writable:!1,value:n})}function e(t,e,n){n=n||0;for(var r=0;r<e;r++)this.push(t),t+=n}function n(t,e){for(e+=t=this.length-t;t<e;t++)this.push(this[t])}function r(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];"function"==typeof i?(n++,i.apply(e,t[n])):e.push(i)}return e}"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf(t.prototype,Error.prototype):t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t.prototype.name="JisonParserError";var i={trace:function(){},JisonParserError:t,yy:{},options:{type:"lalr",hasPartialLrUpgradeOnConflict:!0,errorRecoveryTokenDiscardCount:3},symbols_:{"!":19,"#":22,$accept:0,$end:1,"%":21,"&":3,"(":6,")":7,"*":13,"+":5,",":17,"-":12,"/":14,":":18,";":20,"<":11,"=":4,">":10,CELL:36,COLUMNRANGE:38,DECIMAL:41,E:16,EOF:1,FALSE:24,FIXEDCELL:35,FUNCTION:34,GTE:30,IF:33,LTE:29,NE:31,NOT:32,NULL:25,NUMBER:42,ROWRANGE:39,SHEET:37,STRING:28,TIME_24:27,TIME_AMPM:26,TRUE:23,VARIABLE:40,"[":8,"]":9,"^":15,cell:45,e:44,error:2,expressions:43,expseq:46,number:48,variableSequence:47},terminals_:{1:"EOF",3:"&",4:"=",5:"+",6:"(",7:")",8:"[",9:"]",10:">",11:"<",12:"-",13:"*",14:"/",15:"^",16:"E",17:",",18:":",19:"!",20:";",21:"%",22:"#",23:"TRUE",24:"FALSE",25:"NULL",26:"TIME_AMPM",27:"TIME_24",28:"STRING",29:"LTE",30:"GTE",31:"NE",32:"NOT",33:"IF",34:"FUNCTION",35:"FIXEDCELL",36:"CELL",37:"SHEET",38:"COLUMNRANGE",39:"ROWRANGE",40:"VARIABLE",41:"DECIMAL",42:"NUMBER"},TERROR:2,EOF:1,originalQuoteName:null,originalParseError:null,cleanupAfterParse:null,constructParseErrorInfo:null,yyMergeLocationInfo:null,__reentrant_call_depth:0,__error_infos:[],__error_recovery_infos:[],quoteName:function(t){return'"'+t+'"'},getSymbolName:function(t){if(this.terminals_[t])return this.terminals_[t];var e=this.symbols_;for(var n in e)if(e[n]===t)return n;return null},describeSymbol:function(t){if(t!==this.EOF&&this.terminal_descriptions_&&this.terminal_descriptions_[t])return this.terminal_descriptions_[t];if(t===this.EOF)return"end of input";var e=this.getSymbolName(t);return e?this.quoteName(e):null},collect_expected_token_set:function(t,e){var n=this.TERROR,r=[],i={};if(!e&&this.state_descriptions_&&this.state_descriptions_[t])return[this.state_descriptions_[t]];for(var o in this.table[t])if((o=+o)!==n){var s=e?o:this.describeSymbol(o);s&&!i[s]&&(r.push(s),i[s]=!0)}return r},productions_:function(t){for(var e=[],n=t.pop,r=t.rule,i=0,o=n.length;i<o;i++)e.push([n[i],r[i]]);return e}({pop:r([43,e,[44,32],e,[45,10],e,[46,3],47,47,e,[48,3],2,2]),rule:r([2,e,[1,8],e,[3,15],2,2,1,8,3,4,1,1,2,1,3,n,[27,3],5,n,[6,4],n,[8,3],n,[5,4],2,3,4])}),performAction:function(t,e,n){var r=this.yy;switch(r.parser,r.lexer,t){case 0:case 14:case 33:this.$=n[e-1];break;case 1:return this.$=n[e-1],n[e-1];case 2:this.$=r.activeSheet.getVariable(n[e]);break;case 3:this.$=!0;break;case 4:this.$=!1;break;case 5:this.$=null;break;case 6:case 7:this.$=r.utility.time(n[e]);break;case 8:case 26:this.$=1*n[e],isNaN(this.$)&&(this.$=0);break;case 9:this.$=n[e].substring(1,n[e].length-1);break;case 10:this.$=""+n[e-2]+n[e];break;case 11:this.$=r.comparator.equal.call(r,n[e-2],n[e]);break;case 12:this.$=r.formula.math.SUM.call(r,n[e-2],n[e]);break;case 13:this.$=1*n[e-1];break;case 15:this.$=r.comparator.lessEqualThan.call(r,n[e-2],n[e]);break;case 16:this.$=r.comparator.greaterEqualThan.call(r,n[e-2],n[e]);break;case 17:this.$=r.comparator.notEqual.call(r,n[e-2],n[e]);break;case 18:this.$=n[e-2]!=n[e];break;case 19:this.$=r.comparator.greaterThan.call(r.activeSheet,n[e-2],n[e]);break;case 20:this.$=r.comparator.lessThan.call(r.activeSheet,n[e-2],n[e]);break;case 21:this.$=r.formula.math.SUBTRACT.call(r.activeSheet,n[e-2],n[e]);break;case 22:this.$=r.formula.math.MULTIPLY.call(r.activeSheet,n[e-2],n[e]);break;case 23:this.$=r.formula.math.DIVIDE.call(r.activeSheet,n[e-2],n[e]);break;case 24:this.$=r.formula.math.POWER.call(r.activeSheet,n[e-2],n[e]);break;case 25:this.$=-1*n[e],isNaN(this.$)&&(this.$=0);break;case 27:this.$=Math.E;break;case 28:this.$=r.activeSheet.eval(n[e-6])?r.activeSheet.eval(n[e-4]):r.activeSheet.eval(n[e-2]);break;case 29:this.$=r.utility.callFormula(n[e-2]);break;case 30:this.$=r.utility.callFormula(n[e-3],n[e-1]);break;case 31:case 32:this.$=n[e];break;case 34:case 36:this.$=r.activeSheet.getCellValue(n[e]);break;case 35:case 37:this.$=r.activeSheet.getCellRangeValue(n[e-2],n[e]);break;case 38:this.$=r.activeSheet.getRemoteCellValue(n[e-2],n[e]);break;case 39:this.$=r.activeSheet.getRemoteCellRangeValue(n[e-4],n[e-2],n[e]);break;case 40:this.$=r.activeSheet.getColumnRange(n[e]);break;case 41:this.$=r.activeSheet.getRemoteColumnRange(n[e-2],n[e]);break;case 42:this.$=r.activeSheet.getRowRange(n[e]);break;case 43:this.$=r.activeSheet.getRemoteRowRange(n[e-2],n[e]);break;case 44:case 47:this.$=[n[e]];break;case 45:case 46:n[e-2].push(n[e]),this.$=n[e-2];break;case 48:this.$=$.isArray(n[e-2])?n[e-2]:[n[e-2]],this.$.push(n[e]);break;case 49:this.$=1*n[e];break;case 50:this.$=1*(n[e-2]+"."+n[e]);break;case 51:this.$=.01*n[e-1];break;case 52:case 53:this.$=n[e-2]+n[e-1]+n[e]}},table:function(t){for(var e=[],n=t.len,r=t.symbol,i=t.type,o=t.state,s=t.mode,a=t.goto,c=0,l=n.length;c<l;c++){for(var u=n[c],h={},f=0;f<u;f++){var p=r.shift();switch(i.shift()){case 2:h[p]=[s.shift(),a.shift()];break;case 0:h[p]=o.shift();break;default:h[p]=[3]}}e.push(h)}return e}({len:r([27,1,14,19,e,[18,5],19,18,26,27,26,26,18,1,1,18,21,20,20,19,19,1,18,n,[11,3],e,[26,13],1,19,14,3,17,18,18,27,28,n,[25,3],e,[1,3],3,n,[34,3],e,[18,11],n,[69,3],26,26,2,18,3,1,n,[9,3],n,[3,3],20,17,17,27,18,20,1,2,16,18,27,3,18]),symbol:r([2,5,6,8,12,16,e,[22,7,1],e,[33,8,1],e,[42,4,1],47,48,1,1,3,4,5,e,[10,6,1],e,[29,4,1],n,[14,4],7,e,[9,7,1],17,20,n,[18,4],41,n,[19,18],n,[18,86],21,n,[37,22],n,[188,22],n,[187,4],n,[26,24],46,n,[27,26],n,[26,28],n,[123,18],6,6,n,[180,19],e,[2,4,1],n,[19,10],22,n,[20,4],40,n,[39,14],n,[20,5],n,[311,15],n,[221,5],n,[20,14],18,n,[260,18],n,[19,6],19,n,[316,36],40,1,n,[228,52],n,[26,286],n,[456,15],n,[436,5],n,[18,4],n,[799,10],9,17,20,n,[746,53],n,[683,30],7,n,[28,24],n,[73,18],22,40,42,35,36,36,38,39,n,[548,37],n,[18,216],n,[1171,37],n,[513,52],17,20,n,[72,18],7,17,20,n,[365,15],n,[1193,23],n,[18,31],n,[1007,19],n,[18,37],n,[1122,6],n,[37,17],n,[611,44],n,[99,38],36,n,[732,6],n,[713,57],n,[297,3],n,[48,18]]),type:r([0,e,[2,21],e,[0,5],1,e,[2,160],n,[188,27],n,[26,26],n,[53,52],n,[144,61],n,[281,168],n,[26,285],n,[428,117],n,[118,23],n,[27,27],e,[2,294],n,[513,142],n,[240,146],n,[102,102]]),state:r([19,1,2,18,3,9,19,44,n,[5,4],46,18,45,n,[6,3],47,n,[11,4],48,n,[5,3],51,19,59,n,[11,4],60,n,[5,4],61,n,[5,4],62,n,[5,4],63,n,[5,4],64,n,[5,4],65,n,[5,4],66,n,[5,4],67,n,[5,4],68,n,[5,4],69,n,[5,4],70,n,[5,4],71,n,[82,6],77,n,[6,5],79,n,[6,3],88,n,[17,4],89,n,[5,4],95,18,94,n,[6,5],98,3,9]),mode:r([e,[1,35],e,[2,18],n,[19,19],e,[2,86],n,[105,23],e,[1,84],n,[102,20],n,[159,37],n,[38,15],n,[53,25],n,[25,14],n,[342,25],n,[348,37],1,n,[259,85],e,[1,190],n,[552,39],n,[22,8],n,[8,6],n,[43,12],n,[61,18],n,[622,49],n,[131,27],n,[475,6],n,[124,15],n,[142,36],n,[613,6],n,[18,51],n,[90,11],n,[54,40],n,[268,24],n,[663,20],n,[1029,80],n,[941,64],n,[943,34],n,[1138,59],n,[196,42],n,[466,14],n,[17,20],n,[699,37],n,[289,25],n,[561,22],n,[326,33],e,[2,18]]),goto:r([14,11,12,13,15,27,e,[4,5,1],10,16,17,e,[22,5,1],20,21,e,[28,4,1],e,[36,6,1],e,[32,4,1],e,[2,18],42,e,[3,18],e,[4,18],e,[5,18],e,[6,18],e,[7,18],e,[8,14],43,e,[8,4],e,[9,18],n,[181,21],n,[21,63],e,[27,18],49,50,e,[31,18],e,[32,14],27,e,[32,4],52,e,[47,14],53,e,[47,5],e,[49,19],54,e,[34,13],55,e,[34,5],e,[36,13],56,e,[36,5],57,e,[40,18],e,[42,18],58,1,n,[259,84],n,[21,189],72,e,[51,19],n,[711,3],73,n,[712,10],74,76,75,n,[17,3],44,44,n,[18,6],44,44,n,[20,4],e,[25,9],n,[18,3],e,[25,6],e,[26,9],n,[18,3],e,[26,6],n,[132,23],78,n,[22,19],e,[33,18],53,e,[80,8,1],e,[10,3],31,10,10,n,[124,6],10,10,n,[124,4],e,[11,3],31,11,11,n,[18,6],11,11,n,[18,4],e,[12,9],n,[18,3],e,[12,6],e,[15,3],31,e,[15,4],n,[36,4],e,[15,6],e,[16,3],31,e,[16,4],n,[18,4],e,[16,6],e,[17,3],31,e,[17,4],n,[18,4],e,[17,6],e,[18,3],31,18,18,n,[90,6],18,18,n,[90,3],18,e,[19,3],31,e,[19,4],n,[18,4],e,[19,6],e,[20,3],31,e,[20,4],n,[18,4],e,[20,6],e,[21,9],n,[18,3],e,[21,6],e,[22,11],41,e,[22,6],e,[23,11],41,e,[23,6],e,[24,18],e,[48,19],e,[13,18],e,[14,19],n,[491,41],90,75,e,[29,18],91,76,75,92,e,[50,19],e,[35,18],e,[37,18],e,[38,13],93,e,[38,5],e,[41,18],e,[43,18],e,[52,20],n,[608,3],45,45,n,[376,6],45,45,n,[466,4],n,[17,3],46,46,n,[17,6],46,46,n,[17,4],n,[209,21],e,[30,18],e,[53,20],96,97,n,[704,5],n,[78,12],e,[39,18],n,[96,21],99,76,75,e,[28,18]])}),defaultActions:function(t){for(var e={},n=t.idx,r=t.goto,i=0,o=n.length;i<o;i++)e[n[i]]=r[i];return e}({idx:r([e,[4,5,1],10,15,18,25,26,28,43,51,e,[71,4,1],78,81,82,83,85,86,87,91,92,96,99]),goto:r([e,[3,5,1],9,27,31,40,42,1,51,33,24,48,13,14,29,50,35,37,41,43,52,30,53,39,28])}),parseError:function(t,e,n){if(!e.recoverable)throw"function"==typeof this.trace&&this.trace(t),n||(n=this.JisonParserError),new n(t,e);"function"==typeof this.trace&&this.trace(t),e.destroy()},parse:function(t){var e,n=this,r=new Array(128),i=new Array(128),o=new Array(128),s=this.table,a=0,c=0,l=0,u=1/0,h=null,f=0,p=this.TERROR,d=this.EOF,E=0|this.options.errorRecoveryTokenDiscardCount||3,m=[0,100];e=this.__lexer__?this.__lexer__:this.__lexer__=Object.create(this.lexer);var y,_={parseError:void 0,quoteName:void 0,lexer:void 0,parser:void 0,pre_parse:void 0,post_parse:void 0,pre_lex:void 0,post_lex:void 0};function g(t){if("object"==typeof t){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}return t}y="function"!=typeof assert?function(t,e){if(!t)throw new Error("assertion failed: "+(e||"***"))}:assert,this.yyGetSharedState=function(){return _},this.yyGetErrorInfoTrack=function(){return h},function(t,e){for(var n in e)void 0===t[n]&&Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}(_,this.yy),_.lexer=e,_.parser=this,"function"==typeof _.parseError?this.parseError=function(t,e,n){return n||(n=this.JisonParserError),_.parseError.call(this,t,e,n)}:this.parseError=this.originalParseError,"function"==typeof _.quoteName?this.quoteName=function(t){return _.quoteName.call(this,t)}:this.quoteName=this.originalQuoteName,this.cleanupAfterParse=function(t,n,s){var c,l;if(n&&((_.post_parse||this.post_parse)&&(l=this.constructParseErrorInfo(null,null,null,!1)),_.post_parse&&void 0!==(c=_.post_parse.call(this,_,t,l))&&(t=c),this.post_parse&&void 0!==(c=this.post_parse.call(this,_,t,l))&&(t=c),l&&l.destroy&&l.destroy()),this.__reentrant_call_depth>1)return t;if(e.cleanupAfterLex&&e.cleanupAfterLex(s),_&&(_.lexer=void 0,_.parser=void 0,e.yy===_&&(e.yy=void 0)),_=void 0,this.parseError=this.originalParseError,this.quoteName=this.originalQuoteName,r.length=0,i.length=0,o.length=0,a=0,!s){for(var u=this.__error_infos.length-1;u>=0;u--)(f=this.__error_infos[u])&&"function"==typeof f.destroy&&f.destroy();for(this.__error_infos.length=0,u=this.__error_recovery_infos.length-1;u>=0;u--){var f;(f=this.__error_recovery_infos[u])&&"function"==typeof f.destroy&&f.destroy()}this.__error_recovery_infos.length=0,h&&(h=void 0)}return t},this.constructParseErrorInfo=function(t,n,s,l){var u={errStr:t,exception:n,text:e.match,value:e.yytext,token:this.describeSymbol(c)||c,token_id:c,line:e.yylineno,expected:s,recoverable:l,state:T,action:v,new_state:I,symbol_stack:r,state_stack:i,value_stack:o,stack_pointer:a,yy:_,lexer:e,parser:this,destroy:function(){var t=!!this.recoverable;for(var e in this)this.hasOwnProperty(e)&&"object"==typeof e&&(this[e]=void 0);this.recoverable=t}};return this.__error_infos.push(u),u},this.shallowCopyErrorInfo=function(t){var e=g(t);delete e.sharedState_yy,delete e.parser,delete e.lexer,e.value=g(e.value),e.symbol_stack=e.symbol_stack.slice(0),e.state_stack=e.state_stack.slice(0),e.value_stack=e.value_stack.map(g);for(var n=e.stack_pointer;void 0!==e.state_stack[n];n++);return e.base_pointer=n,e.info_stack_pointer=n,e.root_failure_pointer=e.stack_pointer,this.__error_recovery_infos.push(e),e};var T,v,A,R,O,S,L,I,N=function(){var t=e.lex();return"number"!=typeof t&&(t=n.symbols_[t]||t),t||d},k={$:!0,_$:void 0,yy:_},x=!1;function b(t){for(var e=a-1,n=0;e>=0;){if((s[t][p]||m)[0]){if(c===d){if(!(u>a-1-n)){--e,t=i[e],++n;continue}u=a-1-n}return n}if(0===t||e<1)return-1;--e,t=i[e],++n}return-1}try{for(this.__reentrant_call_depth++,e.setInput(t,_),"function"==typeof e.canIUse&&e.canIUse().fastLex&&(N=function(){var t=e.fastLex();return"number"!=typeof t&&(t=n.symbols_[t]||t),t||d}),o[a]=null,i[a]=0,r[a]=0,++a,this.pre_parse&&this.pre_parse.call(this,_),_.pre_parse&&_.pre_parse.call(this,_),I=i[a-1];;){if(T=I,this.defaultActions[T])v=2,I=this.defaultActions[T];else if(c||(c=N()),R=s[T]&&s[T][c]||m,I=R[1],!(v=R[0])){var C=b(T),P=null,M=this.describeSymbol(c)||c,w=this.collect_expected_token_set(T);if(!f){if(P="number"==typeof e.yylineno?"Parse error on line "+(e.yylineno+1)+": ":"Parse error: ","function"==typeof e.showPosition&&(P+="\n"+e.showPosition(69,10)+"\n"),w.length?P+="Expecting "+w.join(", ")+", got unexpected "+M:P+="Unexpected "+M,O=this.constructParseErrorInfo(P,null,w,C>=0),h=this.shallowCopyErrorInfo(O),void 0!==(A=this.parseError(O.errStr,O,this.JisonParserError))){x=A;break}if(!O.recoverable||C<0)break}var U=h.info_stack_pointer;if(f===E&&C>=0&&(h.symbol_stack[U]=c,h.value_stack[U]=g(e.yytext),h.state_stack[U]=I,++U,l=0,c=N()),C<0){y(f>0,"line 897"),h.info_stack_pointer=U;var F=this.__error_infos[this.__error_infos.length-1];P="number"==typeof e.yylineno?"Parsing halted on line "+(e.yylineno+1)+" while starting to recover from another error":"Parsing halted while starting to recover from another error",P+=F?" -- previous error which resulted in this fatal result: "+F.errStr:": ","function"==typeof e.showPosition&&(P+="\n"+e.showPosition(69,10)+"\n"),w.length?P+="Expecting "+w.join(", ")+", got unexpected "+M:P+="Unexpected "+M,O=this.constructParseErrorInfo(P,null,w,!1),F&&(O.extra_error_attributes=F),void 0!==(A=this.parseError(O.errStr,O,this.JisonParserError))&&(x=A);break}l=c===p?0:c,c=p;const t=3;if(h.symbol_stack[U]=l,h.value_stack[U]=P?{yytext:g(e.yytext),errorRuleDepth:C,errStr:P,errorSymbolDescr:M,expectedStr:w,stackSampleLength:C+t}:{yytext:g(e.yytext),errorRuleDepth:C,stackSampleLength:C+t},h.state_stack[U]=I||m[1],++U,h.info_stack_pointer=U,k.$=h,S=C,void 0!==(A=this.performAction.call(k,m[1],a-1,o))){x=A;break}for(var D=(a-=S)-t,j=D+S;D<j;D++,U++)h.symbol_stack[U]=r[D],h.value_stack[U]=g(o[D]),h.state_stack[U]=i[D];h.symbol_stack[U]=p,h.value_stack[U]=g(k.$),I=i[a-1],this.defaultActions[I]?h.state_stack[U]=this.defaultActions[I]:(R=s[I]&&s[I][c]||m,h.state_stack[U]=R[1]),++U,h.info_stack_pointer=U,f=E,y(h,"line 1049"),y(c===p,"line 1050"),y(!v,"line 1051");for(var $=!0;;){if(T=I,this.defaultActions[T])v=2,I=this.defaultActions[T];else if(c||(c=N(),$=!1),R=s[T]&&s[T][c]||m,I=R[1],!(v=R[0])){y(h,"line 1087"),I=T;break}switch(v){default:break;case 1:if(r[a]=c,c===p&&$?(y(h,"line 1131"),o[a]=h):(y(0!==c,"line 1135"),y(0===l,"line 1136"),o[a]=e.yytext),i[a]=I,++a,c=0,$=!1,l?(y(f>0,"line 1163"),c=l,l=0,(R=s[I]&&s[I][c]||m)[0]&&c!==p||(c=0)):f>0&&f--,y(0===l,"line 1194"),0===f)break;continue;case 2:if(S=(L=this.productions_[I-1])[1],void 0!==(A=this.performAction.call(k,I,a-1,o))){v=3,a=-2,x=A;break}a-=S;var B=L[0];r[a]=B,o[a]=k.$,I=s[i[a-1]][B],i[a]=I,++a;continue;case 3:x=!0,--a>=0&&void 0!==o[a]&&(x=o[a]),a=-2}break}if(y(2!==v,"line 1272"),!v||1===v)continue}switch(v){default:if(v instanceof Array){O=this.constructParseErrorInfo("Parse Error: multiple actions possible at state: "+T+", token: "+c,null,null,!1),void 0!==(A=this.parseError(O.errStr,O,this.JisonParserError))&&(x=A);break}O=this.constructParseErrorInfo("Parsing halted. No viable error recovery approach available due to internal system failure.",null,null,!1),void 0!==(A=this.parseError(O.errStr,O,this.JisonParserError))&&(x=A);break;case 1:r[a]=c,o[a]=e.yytext,i[a]=I,++a,c=0,y(0===l,"line 1352"),y(0===f,"line 1353");continue;case 2:if(y(0===l,"line 1364"),y(0===f,"line 1365"),S=(L=this.productions_[I-1])[1],void 0!==(A=this.performAction.call(k,I,a-1,o))){x=A;break}a-=S,B=L[0],r[a]=B,o[a]=k.$,I=s[i[a-1]][B],i[a]=I,++a;continue;case 3:-2!==a&&(x=!0,a--,void 0!==o[a]&&(x=o[a]))}break}}catch(t){if(t instanceof this.JisonParserError)throw t;if(e&&"function"==typeof e.JisonLexerError&&t instanceof e.JisonLexerError)throw t;O=this.constructParseErrorInfo("Parsing aborted due to exception.",t,null,!1),x=!1,void 0!==(A=this.parseError(O.errStr,O,this.JisonParserError))&&(x=A)}finally{x=this.cleanupAfterParse(x,!0,!0),this.__reentrant_call_depth--}return x}};i.originalParseError=i.parseError,i.originalQuoteName=i.quoteName;var o=function(){function t(t,e){var n;if(Object.defineProperty(this,"name",{enumerable:!1,writable:!1,value:"JisonLexerError"}),null==t&&(t="???"),Object.defineProperty(this,"message",{enumerable:!1,writable:!0,value:t}),this.hash=e,e&&e.exception instanceof Error){var r=e.exception;this.message=r.message||t,n=r.stack}n||(Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,this.constructor):n=new Error(t).stack),n&&Object.defineProperty(this,"stack",{enumerable:!1,writable:!1,value:n})}"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf(t.prototype,Error.prototype):t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t.prototype.name="JisonLexerError";var e={EOF:1,ERROR:2,__currentRuleSet__:null,__error_infos:[],__decompressed:!1,done:!1,_backtrack:!1,_input:"",_more:!1,_signaled_error_token:!1,conditionStack:[],match:"",matched:"",matches:!1,yytext:"",offset:0,yyleng:0,yylineno:0,yylloc:null,constructLexErrorInfo:function(t,e,n){if(t=""+t,null==n&&(n=!(t.indexOf("\n")>0&&t.indexOf("^")>0)),this.yylloc&&n)if("function"==typeof this.prettyPrintRange)this.prettyPrintRange(this.yylloc),/\n\s*$/.test(t)||(t+="\n"),t+="\n  Erroneous area:\n"+this.prettyPrintRange(this.yylloc);else if("function"==typeof this.showPosition){var r=this.showPosition();r&&(t.length&&"\n"!==t[t.length-1]&&"\n"!==r[0]?t+="\n"+r:t+=r)}var i={errStr:t,recoverable:!!e,text:this.match,token:null,line:this.yylineno,loc:this.yylloc,yy:this.yy,lexer:this,destroy:function(){var t=!!this.recoverable;for(var e in this)this.hasOwnProperty(e)&&"object"==typeof e&&(this[e]=void 0);this.recoverable=t}};return this.__error_infos.push(i),i},parseError:function(t,e,n){if(n||(n=this.JisonLexerError),this.yy){if(this.yy.parser&&"function"==typeof this.yy.parser.parseError)return this.yy.parser.parseError.call(this,t,e,n)||this.ERROR;if("function"==typeof this.yy.parseError)return this.yy.parseError.call(this,t,e,n)||this.ERROR}throw new n(t,e)},yyerror:function(t){var e="";this.yylloc&&(e=" on line "+(this.yylineno+1));var n=this.constructLexErrorInfo("Lexical error"+e+": "+t,this.options.lexerErrorsAreRecoverable),r=Array.prototype.slice.call(arguments,1);return r.length&&(n.extra_error_attributes=r),this.parseError(n.errStr,n,this.JisonLexerError)||this.ERROR},cleanupAfterLex:function(t){if(this.setInput("",{}),!t){for(var e=this.__error_infos.length-1;e>=0;e--){var n=this.__error_infos[e];n&&"function"==typeof n.destroy&&n.destroy()}this.__error_infos.length=0}return this},clear:function(){this.yytext="",this.yyleng=0,this.match="",this.matches=!1,this._more=!1,this._backtrack=!1;var t=this.yylloc?this.yylloc.last_column:0;this.yylloc={first_line:this.yylineno+1,first_column:t,last_line:this.yylineno+1,last_column:t,range:[this.offset,this.offset]}},setInput:function(t,e){if(this.yy=e||this.yy||{},!this.__decompressed){for(var n=this.rules,r=0,i=n.length;r<i;r++)"number"==typeof(f=n[r])&&(n[r]=n[f]);var o=this.conditions;for(var s in o){var a=o[s],c=a.rules,l=(i=c.length,new Array(i+1)),u=new Array(i+1);for(r=0;r<i;r++){var h=c[r],f=n[h];l[r+1]=f,u[r+1]=h}a.rules=u,a.__rule_regexes=l,a.__rule_count=i}this.__decompressed=!0}return this._input=t||"",this.clear(),this._signaled_error_token=!1,this.done=!1,this.yylineno=0,this.matched="",this.conditionStack=["INITIAL"],this.__currentRuleSet__=null,this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0,range:[0,0]},this.offset=0,this},editRemainingInput:function(t,e){var n=t.call(this,this._input,e);return"string"!=typeof n?n&&(this._input=""+n):this._input=n,this},input:function(){if(!this._input)return null;var t=this._input[0];this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t;var e=1,n=!1;if("\n"===t)n=!0;else if("\r"===t){n=!0;var r=this._input[1];"\n"===r&&(e++,t+=r,this.yytext+=r,this.yyleng++,this.offset++,this.match+=r,this.matched+=r,this.yylloc.range[1]++)}return n?(this.yylineno++,this.yylloc.last_line++,this.yylloc.last_column=0):this.yylloc.last_column++,this.yylloc.range[1]++,this._input=this._input.slice(e),t},unput:function(t){var e=t.length,n=t.split(/(?:\r\n?|\n)/g);if(this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.yyleng=this.yytext.length,this.offset-=e,this.match=this.match.substr(0,this.match.length-e),this.matched=this.matched.substr(0,this.matched.length-e),n.length>1){this.yylineno-=n.length-1,this.yylloc.last_line=this.yylineno+1;var r=this.match,i=r.split(/(?:\r\n?|\n)/g);1===i.length&&(i=(r=this.matched).split(/(?:\r\n?|\n)/g)),this.yylloc.last_column=i[i.length-1].length}else this.yylloc.last_column-=e;return this.yylloc.range[1]=this.yylloc.range[0]+this.yyleng,this.done=!1,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else{var t="";this.yylloc&&(t=" on line "+(this.yylineno+1));var e=this.constructLexErrorInfo("Lexical error"+t+": You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).",!1);this._signaled_error_token=this.parseError(e.errStr,e,this.JisonLexerError)||this.ERROR}return this},less:function(t){return this.unput(this.match.slice(t))},pastInput:function(t,e){var n=this.matched.substring(0,this.matched.length-this.match.length);t<0?t=n.length:t||(t=20),e<0?e=n.length:e||(e=1);var r=(n=n.substr(2*-t-2)).replace(/\r\n|\r/g,"\n").split("\n");return(n=(r=r.slice(-e)).join("\n")).length>t&&(n="..."+n.substr(-t)),n},upcomingInput:function(t,e){var n=this.match;t<0?t=n.length+this._input.length:t||(t=20),e<0?e=t:e||(e=1),n.length<2*t+2&&(n+=this._input.substring(0,2*t+2));var r=n.replace(/\r\n|\r/g,"\n").split("\n");return(n=(r=r.slice(0,e)).join("\n")).length>t&&(n=n.substring(0,t)+"..."),n},showPosition:function(t,e){var n=this.pastInput(t).replace(/\s/g," "),r=new Array(n.length+1).join("-");return n+this.upcomingInput(e).replace(/\s/g," ")+"\n"+r+"^"},deriveLocationInfo:function(t,e,n,r){var i={first_line:1,first_column:0,last_line:1,last_column:0,range:[0,0]};return t&&(i.first_line=0|t.first_line,i.last_line=0|t.last_line,i.first_column=0|t.first_column,i.last_column=0|t.last_column,t.range&&(i.range[0]=0|t.range[0],i.range[1]=0|t.range[1])),(i.first_line<=0||i.last_line<i.first_line)&&(i.first_line<=0&&e&&(i.first_line=0|e.last_line,i.first_column=0|e.last_column,e.range&&(i.range[0]=0|t.range[1])),(i.last_line<=0||i.last_line<i.first_line)&&n&&(i.last_line=0|n.first_line,i.last_column=0|n.first_column,n.range&&(i.range[1]=0|t.range[0])),i.first_line<=0&&r&&(i.last_line<=0||r.last_line<=i.last_line)&&(i.first_line=0|r.first_line,i.first_column=0|r.first_column,r.range&&(i.range[0]=0|r.range[0])),i.last_line<=0&&r&&(i.first_line<=0||r.first_line>=i.first_line)&&(i.last_line=0|r.last_line,i.last_column=0|r.last_column,r.range&&(i.range[1]=0|r.range[1]))),i.last_line<=0&&(i.first_line<=0?(i.first_line=this.yylloc.first_line,i.last_line=this.yylloc.last_line,i.first_column=this.yylloc.first_column,i.last_column=this.yylloc.last_column,i.range[0]=this.yylloc.range[0],i.range[1]=this.yylloc.range[1]):(i.last_line=this.yylloc.last_line,i.last_column=this.yylloc.last_column,i.range[1]=this.yylloc.range[1])),i.first_line<=0&&(i.first_line=i.last_line,i.first_column=0,i.range[1]=i.range[0]),i.first_column<0&&(i.first_column=0),i.last_column<0&&(i.last_column=i.first_column>0?i.first_column:80),i},prettyPrintRange:function(t,e,n){t=this.deriveLocationInfo(t,e,n);var r=(this.matched+this._input).split("\n"),i=Math.max(1,e?e.first_line:t.first_line-3),o=Math.max(1,n?n.last_line:t.last_line+1),s=1+Math.log10(1|o)|0,a=new Array(s).join(" "),c=[],l=r.slice(i-1,o+1).map((function(e,n){var r=n+i,o=(a+r).substr(-s)+": "+e,l=new Array(s+1).join("^"),u=3,h=0;return r===t.first_line?(u+=t.first_column,h=Math.max(2,(r===t.last_line?t.last_column:e.length)-t.first_column+1)):r===t.last_line?h=Math.max(2,t.last_column+1):r>t.first_line&&r<t.last_line&&(h=Math.max(2,e.length+1)),h&&(o+="\n"+l+new Array(u).join(".")+new Array(h).join("^"),e.trim().length>0&&c.push(n)),o.replace(/\t/g," ")}));if(c.length>4){var u=c[1]+1,h=c[c.length-2]-1,f=new Array(s+1).join(" ")+"  (...continued...)";f+="\n"+new Array(s+1).join("-")+"  (---------------)",l.splice(u,h-u+1,f)}return l.join("\n")},describeYYLLOC:function(t,e){var n,r=t.first_line,i=t.last_line,o=t.first_column,s=t.last_column;if(0==i-r?(n="line "+r+", ",n+=s-o<=1?"column "+o:"columns "+o+" .. "+s):n="lines "+r+"(column "+o+") .. "+i+"(column "+s+")",t.range&&e){var a=t.range[0],c=t.range[1]-1;n+=c<=a?" {String Offset: "+a+"}":" {String Offset range: "+a+" .. "+c+"}"}return n},test_match:function(t,e){var n,r,i,o,s;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.yylloc.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column,range:this.yylloc.range.slice(0)},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done}),s=(o=t[0]).length,(r=o.split(/(?:\r\n?|\n)/g)).length>1?(this.yylineno+=r.length-1,this.yylloc.last_line=this.yylineno+1,this.yylloc.last_column=r[r.length-1].length):this.yylloc.last_column+=s,this.yytext+=o,this.match+=o,this.matched+=o,this.matches=t,this.yyleng=this.yytext.length,this.yylloc.range[1]+=s,this.offset+=s,this._more=!1,this._backtrack=!1,this._input=this._input.slice(s),n=this.performAction.call(this,this.yy,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var a in i)this[a]=i[a];return this.__currentRuleSet__=null,!1}return!!this._signaled_error_token&&(n=this._signaled_error_token,this._signaled_error_token=!1,n)},next:function(){if(this.done)return this.clear(),this.EOF;var t,e,n,r;this._input||(this.done=!0),this._more||this.clear();var i=this.__currentRuleSet__;if(!(i||(i=this.__currentRuleSet__=this._currentRules())&&i.rules)){var o="";this.options.trackPosition&&(o=" on line "+(this.yylineno+1));var s=this.constructLexErrorInfo("Internal lexer engine error"+o+': The lex grammar programmer pushed a non-existing condition name "'+this.topState()+'"; this is a fatal error and should be reported to the application programmer team!',!1);return this.parseError(s.errStr,s,this.JisonLexerError)||this.ERROR}for(var a=i.rules,c=i.__rule_regexes,l=i.__rule_count,u=1;u<=l;u++)if((n=this._input.match(c[u]))&&(!e||n[0].length>e[0].length)){if(e=n,r=u,this.options.backtrack_lexer){if(!1!==(t=this.test_match(n,a[u])))return t;if(this._backtrack){e=void 0;continue}return!1}if(!this.options.flex)break}if(e)return!1!==(t=this.test_match(e,a[r]))&&t;if(this._input){o="",this.options.trackPosition&&(o=" on line "+(this.yylineno+1)),s=this.constructLexErrorInfo("Lexical error"+o+": Unrecognized text.",this.options.lexerErrorsAreRecoverable);var h=this._input,f=this.topState(),p=this.conditionStack.length;return(t=this.parseError(s.errStr,s,this.JisonLexerError)||this.ERROR)===this.ERROR&&(this.matches||h!==this._input||f!==this.topState()||p!==this.conditionStack.length||this.input()),t}return this.done=!0,this.clear(),this.EOF},lex:function(){var t;for("function"==typeof this.pre_lex&&(t=this.pre_lex.call(this,0)),"function"==typeof this.options.pre_lex&&(t=this.options.pre_lex.call(this,t)||t),this.yy&&"function"==typeof this.yy.pre_lex&&(t=this.yy.pre_lex.call(this,t)||t);!t;)t=this.next();return this.yy&&"function"==typeof this.yy.post_lex&&(t=this.yy.post_lex.call(this,t)||t),"function"==typeof this.options.post_lex&&(t=this.options.post_lex.call(this,t)||t),"function"==typeof this.post_lex&&(t=this.post_lex.call(this,t)||t),t},fastLex:function(){for(var t;!t;)t=this.next();return t},canIUse:function(){return{fastLex:!("function"==typeof this.pre_lex||"function"==typeof this.options.pre_lex||this.yy&&"function"==typeof this.yy.pre_lex||this.yy&&"function"==typeof this.yy.post_lex||"function"==typeof this.options.post_lex||"function"==typeof this.post_lex)&&"function"==typeof this.fastLex}},begin:function(t){return this.pushState(t)},pushState:function(t){return this.conditionStack.push(t),this.__currentRuleSet__=null,this},popState:function(){return this.conditionStack.length-1>0?(this.__currentRuleSet__=null,this.conditionStack.pop()):this.conditionStack[0]},topState:function(t){return(t=this.conditionStack.length-1-Math.abs(t||0))>=0?this.conditionStack[t]:"INITIAL"},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]]:this.conditions.INITIAL},stateStackSize:function(){return this.conditionStack.length},options:{trackPosition:!0},JisonLexerError:t,performAction:function(t,e,n){switch(e){case 0:case 15:break;default:return this.simpleCaseActionClusters[e]}},simpleCaseActionClusters:{1:28,2:28,3:37,4:34,5:26,6:27,7:35,8:36,9:38,10:39,11:34,12:40,13:40,14:42,16:" ",17:41,18:18,19:20,20:17,21:13,22:14,23:12,24:5,25:15,26:6,27:7,28:8,29:9,30:29,31:30,32:31,33:10,34:11,35:32,36:"PI",37:16,38:23,39:24,40:25,41:33,42:'"',43:"'",44:19,45:4,46:21,47:22,48:3,49:1},rules:[/^(?:\s+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:#\w+)/,/^(?:[A-Za-z]{1,}\w+(?=[(]))/,/^(?:([0]?[1-9]|1[0-2])[:][0-5]\d([:][0-5]\d)?[ ]?(AM|am|aM|Am|PM|pm|pM|Pm))/,/^(?:([0]?\d|1\d|2[0-3])[:][0-5]\d([:][0-5]\d)?)/,/^(?:\$?[A-Za-z]+\$?\d+)/,/^(?:[A-Za-z]+\d)/,/^(?:[A-Za-z]+[:][A-Za-z]+)/,/^(?:\d+[:]\d+)/,/^(?:[A-Za-z]+(?=[(]))/,/^(?:[A-Za-z]{1,}\w+)/,/^(?:[^\W\d]+)/,/^(?:\d+)/,/^(?:\$)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:\[)/,/^(?:\])/,/^(?:<=)/,/^(?:>=)/,/^(?:<>)/,/^(?:>)/,/^(?:<)/,/^(?:NOT)/,/^(?:PI)/,/^(?:E)/,/^(?:TRUE)/,/^(?:FALSE)/,/^(?:NULL)/,/^(?:IF)/,/^(?:")/,/^(?:')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:[#])/,/^(?:[&])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49],inclusive:!0}}};return e}();function s(){this.yy={}}return i.lexer=o,s.prototype=i,i.Parser=s,new s}();e.iX=n.Parser}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};return(()=>{"use strict";n.r(r),n.d(r,{createInterpreter:()=>Oc,createParser:()=>Rc,createWorkbook:()=>Tc,createWorkbookFromData:()=>vc,createWorkbookFromElement:()=>Ac});var t={};n.r(t),n.d(t,{arrayMerge:()=>hc,getCellsInRange:()=>ic,initial:()=>lc,isValidBinary:()=>oc,numToStr:()=>nc,objectToArray:()=>pc,rangeToTable:()=>Ec,repeat:()=>ac,rest:()=>uc,strRepeat:()=>sc,strToNum:()=>rc,toArray:()=>fc,transposeTable:()=>mc,trimEmptyCell:()=>dc,unique:()=>cc});const e=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t},i=function(t,e,n){for(var r=-1,i=Object(t),o=n(t),s=o.length;s--;){var a=o[++r];if(!1===e(i[a],a,i))break}return t},o="object"==typeof global&&global&&global.Object===Object&&global;var s="object"==typeof self&&self&&self.Object===Object&&self;const a=o||s||Function("return this")(),c=a.Symbol;var l=Object.prototype,u=l.hasOwnProperty,h=l.toString,f=c?c.toStringTag:void 0;var p=Object.prototype.toString;var d=c?c.toStringTag:void 0;const E=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":d&&d in Object(t)?function(t){var e=u.call(t,f),n=t[f];try{t[f]=void 0;var r=!0}catch(t){}var i=h.call(t);return r&&(e?t[f]=n:delete t[f]),i}(t):function(t){return p.call(t)}(t)},m=function(t){return null!=t&&"object"==typeof t},y=function(t){return m(t)&&"[object Arguments]"==E(t)};var _=Object.prototype,g=_.hasOwnProperty,T=_.propertyIsEnumerable;const v=y(function(){return arguments}())?y:function(t){return m(t)&&g.call(t,"callee")&&!T.call(t,"callee")},A=Array.isArray;var R="object"==typeof exports&&exports&&!exports.nodeType&&exports,O=R&&"object"==typeof module&&module&&!module.nodeType&&module,S=O&&O.exports===R?a.Buffer:void 0;const L=(S?S.isBuffer:void 0)||function(){return!1};var I=/^(?:0|[1-9]\d*)$/;const N=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&I.test(t))&&t>-1&&t%1==0&&t<e},k=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991};var x={};x["[object Float32Array]"]=x["[object Float64Array]"]=x["[object Int8Array]"]=x["[object Int16Array]"]=x["[object Int32Array]"]=x["[object Uint8Array]"]=x["[object Uint8ClampedArray]"]=x["[object Uint16Array]"]=x["[object Uint32Array]"]=!0,x["[object Arguments]"]=x["[object Array]"]=x["[object ArrayBuffer]"]=x["[object Boolean]"]=x["[object DataView]"]=x["[object Date]"]=x["[object Error]"]=x["[object Function]"]=x["[object Map]"]=x["[object Number]"]=x["[object Object]"]=x["[object RegExp]"]=x["[object Set]"]=x["[object String]"]=x["[object WeakMap]"]=!1;const b=function(t){return function(e){return t(e)}};var C="object"==typeof exports&&exports&&!exports.nodeType&&exports,P=C&&"object"==typeof module&&module&&!module.nodeType&&module,M=P&&P.exports===C&&o.process;const w=function(){try{return P&&P.require&&P.require("util").types||M&&M.binding&&M.binding("util")}catch(t){}}();var U=w&&w.isTypedArray;const F=U?b(U):function(t){return m(t)&&k(t.length)&&!!x[E(t)]};var D=Object.prototype.hasOwnProperty;const j=function(t,e){var n=A(t),r=!n&&v(t),i=!n&&!r&&L(t),o=!n&&!r&&!i&&F(t),s=n||r||i||o,a=s?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],c=a.length;for(var l in t)!e&&!D.call(t,l)||s&&("length"==l||i&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||N(l,c))||a.push(l);return a};var $=Object.prototype;const B=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||$)},G=function(t,e){return function(n){return t(e(n))}},K=G(Object.keys,Object);var V=Object.prototype.hasOwnProperty;const W=function(t){if(!B(t))return K(t);var e=[];for(var n in Object(t))V.call(t,n)&&"constructor"!=n&&e.push(n);return e},z=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},H=function(t){if(!z(t))return!1;var e=E(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},Y=function(t){return null!=t&&k(t.length)&&!H(t)},q=function(t){return Y(t)?j(t):W(t)},X=function(t,e){if(null==t)return t;if(!Y(t))return function(t,e){return t&&i(t,e,q)}(t,e);for(var n=t.length,r=-1,o=Object(t);++r<n&&!1!==e(o[r],r,o););return t},Z=function(t){return t},J=function(t,n){return(A(t)?e:X)(t,"function"==typeof(r=n)?r:Z);var r},Q=function(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i},tt=function(t){return null==t?[]:function(t,e){return Q(e,(function(e){return t[e]}))}(t,q(t))},et=a["__core-js_shared__"];var nt,rt=(nt=/[^.]+$/.exec(et&&et.keys&&et.keys.IE_PROTO||""))?"Symbol(src)_1."+nt:"";var it=Function.prototype.toString;const ot=function(t){if(null!=t){try{return it.call(t)}catch(t){}try{return t+""}catch(t){}}return""};var st=/^\[object .+?Constructor\]$/,at=Function.prototype,ct=Object.prototype,lt=at.toString,ut=ct.hasOwnProperty,ht=RegExp("^"+lt.call(ut).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const ft=function(t){return!(!z(t)||(e=t,rt&&rt in e))&&(H(t)?ht:st).test(ot(t));var e},pt=function(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return ft(n)?n:void 0},dt=pt(a,"DataView"),Et=pt(a,"Map"),mt=pt(a,"Promise"),yt=pt(a,"Set"),_t=pt(a,"WeakMap");var gt="[object Map]",Tt="[object Promise]",vt="[object Set]",At="[object WeakMap]",Rt="[object DataView]",Ot=ot(dt),St=ot(Et),Lt=ot(mt),It=ot(yt),Nt=ot(_t),kt=E;(dt&&kt(new dt(new ArrayBuffer(1)))!=Rt||Et&&kt(new Et)!=gt||mt&&kt(mt.resolve())!=Tt||yt&&kt(new yt)!=vt||_t&&kt(new _t)!=At)&&(kt=function(t){var e=E(t),n="[object Object]"==e?t.constructor:void 0,r=n?ot(n):"";if(r)switch(r){case Ot:return Rt;case St:return gt;case Lt:return Tt;case It:return vt;case Nt:return At}return e});const xt=kt;var bt=Object.prototype.hasOwnProperty;const Ct=function(t){if(null==t)return!0;if(Y(t)&&(A(t)||"string"==typeof t||"function"==typeof t.splice||L(t)||F(t)||v(t)))return!t.length;var e=xt(t);if("[object Map]"==e||"[object Set]"==e)return!t.size;if(B(t))return!W(t).length;for(var n in t)if(bt.call(t,n))return!1;return!0},Pt=function(t,e){return t===e||t!=t&&e!=e},Mt=function(t,e){for(var n=t.length;n--;)if(Pt(t[n][0],e))return n;return-1};var wt=Array.prototype.splice;function Ut(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Ut.prototype.clear=function(){this.__data__=[],this.size=0},Ut.prototype.delete=function(t){var e=this.__data__,n=Mt(e,t);return!(n<0||(n==e.length-1?e.pop():wt.call(e,n,1),--this.size,0))},Ut.prototype.get=function(t){var e=this.__data__,n=Mt(e,t);return n<0?void 0:e[n][1]},Ut.prototype.has=function(t){return Mt(this.__data__,t)>-1},Ut.prototype.set=function(t,e){var n=this.__data__,r=Mt(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};const Ft=Ut,Dt=pt(Object,"create");var jt=Object.prototype.hasOwnProperty;var $t=Object.prototype.hasOwnProperty;function Bt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Bt.prototype.clear=function(){this.__data__=Dt?Dt(null):{},this.size=0},Bt.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Bt.prototype.get=function(t){var e=this.__data__;if(Dt){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return jt.call(e,t)?e[t]:void 0},Bt.prototype.has=function(t){var e=this.__data__;return Dt?void 0!==e[t]:$t.call(e,t)},Bt.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Dt&&void 0===e?"__lodash_hash_undefined__":e,this};const Gt=Bt,Kt=function(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map};function Vt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Vt.prototype.clear=function(){this.size=0,this.__data__={hash:new Gt,map:new(Et||Ft),string:new Gt}},Vt.prototype.delete=function(t){var e=Kt(this,t).delete(t);return this.size-=e?1:0,e},Vt.prototype.get=function(t){return Kt(this,t).get(t)},Vt.prototype.has=function(t){return Kt(this,t).has(t)},Vt.prototype.set=function(t,e){var n=Kt(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};const Wt=Vt;function zt(t){var e=this.__data__=new Ft(t);this.size=e.size}zt.prototype.clear=function(){this.__data__=new Ft,this.size=0},zt.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},zt.prototype.get=function(t){return this.__data__.get(t)},zt.prototype.has=function(t){return this.__data__.has(t)},zt.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Ft){var r=n.__data__;if(!Et||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Wt(r)}return n.set(t,e),this.size=n.size,this};const Ht=zt;function Yt(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Wt;++e<n;)this.add(t[e])}Yt.prototype.add=Yt.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Yt.prototype.has=function(t){return this.__data__.has(t)};const qt=Yt,Xt=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1},Zt=function(t,e){return t.has(e)},Jt=function(t,e,n,r,i,o){var s=1&n,a=t.length,c=e.length;if(a!=c&&!(s&&c>a))return!1;var l=o.get(t),u=o.get(e);if(l&&u)return l==e&&u==t;var h=-1,f=!0,p=2&n?new qt:void 0;for(o.set(t,e),o.set(e,t);++h<a;){var d=t[h],E=e[h];if(r)var m=s?r(E,d,h,e,t,o):r(d,E,h,t,e,o);if(void 0!==m){if(m)continue;f=!1;break}if(p){if(!Xt(e,(function(t,e){if(!Zt(p,e)&&(d===t||i(d,t,n,r,o)))return p.push(e)}))){f=!1;break}}else if(d!==E&&!i(d,E,n,r,o)){f=!1;break}}return o.delete(t),o.delete(e),f},Qt=a.Uint8Array,te=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n},ee=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n};var ne=c?c.prototype:void 0,re=ne?ne.valueOf:void 0;const ie=function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t},oe=function(t,e,n){var r=e(t);return A(t)?r:ie(r,n(t))},se=function(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var s=t[n];e(s,n,t)&&(o[i++]=s)}return o},ae=function(){return[]};var ce=Object.prototype.propertyIsEnumerable,le=Object.getOwnPropertySymbols;const ue=le?function(t){return null==t?[]:(t=Object(t),se(le(t),(function(e){return ce.call(t,e)})))}:ae,he=function(t){return oe(t,q,ue)};var fe=Object.prototype.hasOwnProperty;var pe="[object Arguments]",de="[object Array]",Ee="[object Object]",me=Object.prototype.hasOwnProperty;const ye=function(t,e,n,r,i,o){var s=A(t),a=A(e),c=s?de:xt(t),l=a?de:xt(e),u=(c=c==pe?Ee:c)==Ee,h=(l=l==pe?Ee:l)==Ee,f=c==l;if(f&&L(t)){if(!L(e))return!1;s=!0,u=!1}if(f&&!u)return o||(o=new Ht),s||F(t)?Jt(t,e,n,r,i,o):function(t,e,n,r,i,o,s){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!o(new Qt(t),new Qt(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Pt(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var a=te;case"[object Set]":var c=1&r;if(a||(a=ee),t.size!=e.size&&!c)return!1;var l=s.get(t);if(l)return l==e;r|=2,s.set(t,e);var u=Jt(a(t),a(e),r,i,o,s);return s.delete(t),u;case"[object Symbol]":if(re)return re.call(t)==re.call(e)}return!1}(t,e,c,n,r,i,o);if(!(1&n)){var p=u&&me.call(t,"__wrapped__"),d=h&&me.call(e,"__wrapped__");if(p||d){var E=p?t.value():t,m=d?e.value():e;return o||(o=new Ht),i(E,m,n,r,o)}}return!!f&&(o||(o=new Ht),function(t,e,n,r,i,o){var s=1&n,a=he(t),c=a.length;if(c!=he(e).length&&!s)return!1;for(var l=c;l--;){var u=a[l];if(!(s?u in e:fe.call(e,u)))return!1}var h=o.get(t),f=o.get(e);if(h&&f)return h==e&&f==t;var p=!0;o.set(t,e),o.set(e,t);for(var d=s;++l<c;){var E=t[u=a[l]],m=e[u];if(r)var y=s?r(m,E,u,e,t,o):r(E,m,u,t,e,o);if(!(void 0===y?E===m||i(E,m,n,r,o):y)){p=!1;break}d||(d="constructor"==u)}if(p&&!d){var _=t.constructor,g=e.constructor;_==g||!("constructor"in t)||!("constructor"in e)||"function"==typeof _&&_ instanceof _&&"function"==typeof g&&g instanceof g||(p=!1)}return o.delete(t),o.delete(e),p}(t,e,n,r,i,o))},_e=function t(e,n,r,i,o){return e===n||(null==e||null==n||!m(e)&&!m(n)?e!=e&&n!=n:ye(e,n,r,i,t,o))},ge=function(t){return t==t&&!z(t)},Te=function(t,e){return function(n){return null!=n&&n[t]===e&&(void 0!==e||t in Object(n))}},ve=function(t){var e=function(t){for(var e=q(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,ge(i)]}return e}(t);return 1==e.length&&e[0][2]?Te(e[0][0],e[0][1]):function(n){return n===t||function(t,e,n,r){var i=n.length,o=i,s=!r;if(null==t)return!o;for(t=Object(t);i--;){var a=n[i];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++i<o;){var c=(a=n[i])[0],l=t[c],u=a[1];if(s&&a[2]){if(void 0===l&&!(c in t))return!1}else{var h=new Ht;if(r)var f=r(l,u,c,t,e,h);if(!(void 0===f?_e(u,l,3,r,h):f))return!1}}return!0}(n,t,e)}},Ae=function(t){return"symbol"==typeof t||m(t)&&"[object Symbol]"==E(t)};var Re=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Oe=/^\w*$/;const Se=function(t,e){if(A(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Ae(t))||Oe.test(t)||!Re.test(t)||null!=e&&t in Object(e)};function Le(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=t.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(Le.Cache||Wt),n}Le.Cache=Wt;var Ie=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ne=/\\(\\)?/g;const ke=(xe=Le((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Ie,(function(t,n,r,i){e.push(r?i.replace(Ne,"$1"):n||t)})),e}),(function(t){return 500===be.size&&be.clear(),t})),be=xe.cache,xe);var xe,be,Ce=c?c.prototype:void 0,Pe=Ce?Ce.toString:void 0;const Me=function t(e){if("string"==typeof e)return e;if(A(e))return Q(e,t)+"";if(Ae(e))return Pe?Pe.call(e):"";var n=e+"";return"0"==n&&1/e==-1/0?"-0":n},we=function(t){return null==t?"":Me(t)},Ue=function(t,e){return A(t)?t:Se(t,e)?[t]:ke(we(t))},Fe=function(t){if("string"==typeof t||Ae(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e},De=function(t,e){for(var n=0,r=(e=Ue(e,t)).length;null!=t&&n<r;)t=t[Fe(e[n++])];return n&&n==r?t:void 0},je=function(t,e){return null!=t&&e in Object(t)},$e=function(t,e,n){for(var r=-1,i=(e=Ue(e,t)).length,o=!1;++r<i;){var s=Fe(e[r]);if(!(o=null!=t&&n(t,s)))break;t=t[s]}return o||++r!=i?o:!!(i=null==t?0:t.length)&&k(i)&&N(s,i)&&(A(t)||v(t))},Be=function(t,e){return Se(t)&&ge(e)?Te(Fe(t),e):function(n){var r=function(t,e,n){var r=null==t?void 0:De(t,e);return void 0===r?n:r}(n,t);return void 0===r&&r===e?function(t,e){return null!=t&&$e(t,e,je)}(n,t):_e(e,r,3)}},Ge=function(t){return Se(t)?(e=Fe(t),function(t){return null==t?void 0:t[e]}):function(t){return function(e){return De(e,t)}}(t);var e},Ke=function(t){return"function"==typeof t?t:null==t?Z:"object"==typeof t?A(t)?Be(t[0],t[1]):ve(t):Ge(t)},Ve=function(t,e){var n=-1,r=Y(t)?Array(t.length):[];return X(t,(function(t,i,o){r[++n]=e(t,i,o)})),r},We=function(t,e){return(A(t)?Q:Ve)(t,Ke(e))};var ze=Object.prototype.hasOwnProperty;const He=function(t,e){return null!=t&&ze.call(t,e)},Ye=function(t,e){return null!=t&&$e(t,e,He)},qe=function(){try{var t=pt(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),Xe=function(t,e,n){"__proto__"==e&&qe?qe(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n};var Ze=Object.prototype.hasOwnProperty;const Je=function(t,e,n){var r=t[e];Ze.call(t,e)&&Pt(r,n)&&(void 0!==n||e in t)||Xe(t,e,n)},Qe=function(t,e,n,r){var i=!n;n||(n={});for(var o=-1,s=e.length;++o<s;){var a=e[o],c=r?r(n[a],t[a],a,n,t):void 0;void 0===c&&(c=t[a]),i?Xe(n,a,c):Je(n,a,c)}return n};var tn=Object.prototype.hasOwnProperty;const en=function(t){if(!z(t))return function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}(t);var e=B(t),n=[];for(var r in t)("constructor"!=r||!e&&tn.call(t,r))&&n.push(r);return n},nn=function(t){return Y(t)?j(t,!0):en(t)};var rn="object"==typeof exports&&exports&&!exports.nodeType&&exports,on=rn&&"object"==typeof module&&module&&!module.nodeType&&module,sn=on&&on.exports===rn?a.Buffer:void 0,an=sn?sn.allocUnsafe:void 0;const cn=G(Object.getPrototypeOf,Object),ln=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)ie(e,ue(t)),t=cn(t);return e}:ae,un=function(t){return oe(t,nn,ln)};var hn=Object.prototype.hasOwnProperty;const fn=function(t){var e=new t.constructor(t.byteLength);return new Qt(e).set(new Qt(t)),e};var pn=/\w*$/;var dn=c?c.prototype:void 0,En=dn?dn.valueOf:void 0;const mn=function(t,e,n){var r,i=t.constructor;switch(e){case"[object ArrayBuffer]":return fn(t);case"[object Boolean]":case"[object Date]":return new i(+t);case"[object DataView]":return function(t,e){var n=e?fn(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function(t,e){var n=e?fn(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}(t,n);case"[object Map]":case"[object Set]":return new i;case"[object Number]":case"[object String]":return new i(t);case"[object RegExp]":return function(t){var e=new t.constructor(t.source,pn.exec(t));return e.lastIndex=t.lastIndex,e}(t);case"[object Symbol]":return r=t,En?Object(En.call(r)):{}}};var yn=Object.create;const _n=function(){function t(){}return function(e){if(!z(e))return{};if(yn)return yn(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();var gn=w&&w.isMap;const Tn=gn?b(gn):function(t){return m(t)&&"[object Map]"==xt(t)};var vn=w&&w.isSet;const An=vn?b(vn):function(t){return m(t)&&"[object Set]"==xt(t)};var Rn="[object Arguments]",On="[object Function]",Sn="[object Object]",Ln={};Ln[Rn]=Ln["[object Array]"]=Ln["[object ArrayBuffer]"]=Ln["[object DataView]"]=Ln["[object Boolean]"]=Ln["[object Date]"]=Ln["[object Float32Array]"]=Ln["[object Float64Array]"]=Ln["[object Int8Array]"]=Ln["[object Int16Array]"]=Ln["[object Int32Array]"]=Ln["[object Map]"]=Ln["[object Number]"]=Ln[Sn]=Ln["[object RegExp]"]=Ln["[object Set]"]=Ln["[object String]"]=Ln["[object Symbol]"]=Ln["[object Uint8Array]"]=Ln["[object Uint8ClampedArray]"]=Ln["[object Uint16Array]"]=Ln["[object Uint32Array]"]=!0,Ln["[object Error]"]=Ln[On]=Ln["[object WeakMap]"]=!1;const In=function t(n,r,i,o,s,a){var c,l=1&r,u=2&r,h=4&r;if(i&&(c=s?i(n,o,s,a):i(n)),void 0!==c)return c;if(!z(n))return n;var f=A(n);if(f){if(c=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&hn.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(n),!l)return function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}(n,c)}else{var p=xt(n),d=p==On||"[object GeneratorFunction]"==p;if(L(n))return function(t,e){if(e)return t.slice();var n=t.length,r=an?an(n):new t.constructor(n);return t.copy(r),r}(n,l);if(p==Sn||p==Rn||d&&!s){if(c=u||d?{}:function(t){return"function"!=typeof t.constructor||B(t)?{}:_n(cn(t))}(n),!l)return u?function(t,e){return Qe(t,ln(t),e)}(n,function(t,e){return t&&Qe(e,nn(e),t)}(c,n)):function(t,e){return Qe(t,ue(t),e)}(n,function(t,e){return t&&Qe(e,q(e),t)}(c,n))}else{if(!Ln[p])return s?n:{};c=mn(n,p,l)}}a||(a=new Ht);var E=a.get(n);if(E)return E;a.set(n,c),An(n)?n.forEach((function(e){c.add(t(e,r,i,e,n,a))})):Tn(n)&&n.forEach((function(e,o){c.set(o,t(e,r,i,o,n,a))}));var m=f?void 0:(h?u?un:he:u?nn:q)(n);return e(m||n,(function(e,o){m&&(e=n[o=e]),Je(c,o,t(e,r,i,o,n,a))})),c},Nn=function(t){return In(t,4)};function kn(t){function e(){}e.prototype=t;const n=new e;function r(){return typeof n.bar}return r(),r(),t}const xn=function(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(n=n>i?i:n)<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var o=Array(i);++r<i;)o[r]=t[r+e];return o};var bn=/\s/;var Cn=/^\s+/;const Pn=function(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&bn.test(t.charAt(e)););return e}(t)+1).replace(Cn,""):t};var Mn=/^[-+]0x[0-9a-f]+$/i,wn=/^0b[01]+$/i,Un=/^0o[0-7]+$/i,Fn=parseInt;var Dn=1/0;const jn=function(t){return t?(t=function(t){if("number"==typeof t)return t;if(Ae(t))return NaN;if(z(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=z(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Pn(t);var n=wn.test(t);return n||Un.test(t)?Fn(t.slice(2),n?2:8):Mn.test(t)?NaN:+t}(t))===Dn||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0},$n=function(t){var e=jn(t),n=e%1;return e==e?n?e-n:e:0},Bn=function(t,e,n){var r=null==t?0:t.length;return r?(e=n||void 0===e?1:$n(e),xn(t,e<0?0:e,r)):[]},Gn=function(t){return"string"==typeof t||!A(t)&&m(t)&&"[object String]"==E(t)};var Kn=Math.max;const Vn=qe?function(t,e){return qe(t,"toString",{configurable:!0,enumerable:!1,value:(n=e,function(){return n}),writable:!0});var n}:Z;var Wn=Date.now;const zn=(Hn=Vn,Yn=0,qn=0,function(){var t=Wn(),e=16-(t-qn);if(qn=t,e>0){if(++Yn>=800)return arguments[0]}else Yn=0;return Hn.apply(void 0,arguments)});var Hn,Yn,qn;const Xn=function(t,e){return zn(function(t,e,n){return e=Kn(void 0===e?t.length-1:e,0),function(){for(var r=arguments,i=-1,o=Kn(r.length-e,0),s=Array(o);++i<o;)s[i]=r[e+i];i=-1;for(var a=Array(e+1);++i<e;)a[i]=r[i];return a[e]=n(s),function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}(t,this,a)}}(t,e,Z),t+"")},Zn=function(t,e,n){if(!z(n))return!1;var r=typeof e;return!!("number"==r?Y(n)&&N(e,n.length):"string"==r&&e in n)&&Pt(n[e],t)};var Jn=Object.prototype.hasOwnProperty;const Qn=(tr=function(t,e){if(B(e)||Y(e))Qe(e,q(e),t);else for(var n in e)Jn.call(e,n)&&Je(t,n,e[n])},Xn((function(t,e){var n=-1,r=e.length,i=r>1?e[r-1]:void 0,o=r>2?e[2]:void 0;for(i=tr.length>3&&"function"==typeof i?(r--,i):void 0,o&&Zn(e[0],e[1],o)&&(i=r<3?void 0:i,r=1),t=Object(t);++n<r;){var s=e[n];s&&tr(t,s,n,i)}return t})));var tr;const er=function(t,e,n,r){if(!z(t))return t;for(var i=-1,o=(e=Ue(e,t)).length,s=o-1,a=t;null!=a&&++i<o;){var c=Fe(e[i]),l=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return t;if(i!=s){var u=a[c];void 0===(l=r?r(u,c,a):void 0)&&(l=z(u)?u:N(e[i+1])?[]:{})}Je(a,c,l),a=a[c]}return t},nr=function(t,e){if(null==t)return{};var n=Q(un(t),(function(t){return[t]}));return e=Ke(e),function(t,e,n){for(var r=-1,i=e.length,o={};++r<i;){var s=e[r],a=De(t,s);n(a,s)&&er(o,Ue(s,t),a)}return o}(t,n,(function(t,n){return e(t,n[0])}))};var rr=w&&w.isRegExp;const ir=rr?b(rr):function(t){return m(t)&&"[object RegExp]"==E(t)};class or{get definition(){return this._definition}set definition(t){this._definition=t}constructor(t){this._definition=t}accept(t){t.visit(this),J(this.definition,(e=>{e.accept(t)}))}}class sr extends or{constructor(t){super([]),this.idx=1,Qn(this,nr(t,(t=>void 0!==t)))}set definition(t){}get definition(){return void 0!==this.referencedRule?this.referencedRule.definition:[]}accept(t){t.visit(this)}}class ar extends or{constructor(t){super(t.definition),this.orgText="",Qn(this,nr(t,(t=>void 0!==t)))}}class cr extends or{constructor(t){super(t.definition),this.ignoreAmbiguities=!1,Qn(this,nr(t,(t=>void 0!==t)))}}class lr extends or{constructor(t){super(t.definition),this.idx=1,Qn(this,nr(t,(t=>void 0!==t)))}}class ur extends or{constructor(t){super(t.definition),this.idx=1,Qn(this,nr(t,(t=>void 0!==t)))}}class hr extends or{constructor(t){super(t.definition),this.idx=1,Qn(this,nr(t,(t=>void 0!==t)))}}class fr extends or{constructor(t){super(t.definition),this.idx=1,Qn(this,nr(t,(t=>void 0!==t)))}}class pr extends or{constructor(t){super(t.definition),this.idx=1,Qn(this,nr(t,(t=>void 0!==t)))}}class dr extends or{get definition(){return this._definition}set definition(t){this._definition=t}constructor(t){super(t.definition),this.idx=1,this.ignoreAmbiguities=!1,this.hasPredicates=!1,Qn(this,nr(t,(t=>void 0!==t)))}}class Er{constructor(t){this.idx=1,Qn(this,nr(t,(t=>void 0!==t)))}accept(t){t.visit(this)}}function mr(t){function e(t){return We(t,mr)}if(t instanceof sr){const e={type:"NonTerminal",name:t.nonTerminalName,idx:t.idx};return Gn(t.label)&&(e.label=t.label),e}if(t instanceof cr)return{type:"Alternative",definition:e(t.definition)};if(t instanceof lr)return{type:"Option",idx:t.idx,definition:e(t.definition)};if(t instanceof ur)return{type:"RepetitionMandatory",idx:t.idx,definition:e(t.definition)};if(t instanceof hr)return{type:"RepetitionMandatoryWithSeparator",idx:t.idx,separator:mr(new Er({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof pr)return{type:"RepetitionWithSeparator",idx:t.idx,separator:mr(new Er({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof fr)return{type:"Repetition",idx:t.idx,definition:e(t.definition)};if(t instanceof dr)return{type:"Alternation",idx:t.idx,definition:e(t.definition)};if(t instanceof Er){const e={type:"Terminal",name:t.terminalType.name,label:(n=t.terminalType,Gn((r=n).LABEL)&&""!==r.LABEL?n.LABEL:n.name),idx:t.idx};Gn(t.label)&&(e.terminalLabel=t.label);const i=t.terminalType.PATTERN;return t.terminalType.PATTERN&&(e.pattern=ir(i)?i.source:i),e}var n,r;if(t instanceof ar)return{type:"Rule",name:t.name,orgText:t.orgText,definition:e(t.definition)};throw Error("non exhaustive match")}class yr{visit(t){const e=t;switch(e.constructor){case sr:return this.visitNonTerminal(e);case cr:return this.visitAlternative(e);case lr:return this.visitOption(e);case ur:return this.visitRepetitionMandatory(e);case hr:return this.visitRepetitionMandatoryWithSeparator(e);case pr:return this.visitRepetitionWithSeparator(e);case fr:return this.visitRepetition(e);case dr:return this.visitAlternation(e);case Er:return this.visitTerminal(e);case ar:return this.visitRule(e);default:throw Error("non exhaustive match")}}visitNonTerminal(t){}visitAlternative(t){}visitOption(t){}visitRepetition(t){}visitRepetitionMandatory(t){}visitRepetitionMandatoryWithSeparator(t){}visitRepetitionWithSeparator(t){}visitAlternation(t){}visitTerminal(t){}visitRule(t){}}const _r=function(t,e){var n;return X(t,(function(t,r,i){return!(n=e(t,r,i))})),!!n},gr=function(t,e,n){var r=A(t)?Xt:_r;return n&&Zn(t,e,n)&&(e=void 0),r(t,Ke(e))},Tr=function(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1},vr=function(t){return t!=t},Ar=function(t,e,n){return e==e?function(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}(t,e,n):Tr(t,vr,n)};var Rr=Math.max;const Or=function(t,e,n,r){t=Y(t)?t:tt(t),n=n&&!r?$n(n):0;var i=t.length;return n<0&&(n=Rr(i+n,0)),Gn(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&Ar(t,e,n)>-1},Sr=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0},Lr=function(t,e){var n=!0;return X(t,(function(t,r,i){return n=!!e(t,r,i)})),n},Ir=function(t,e,n){var r=A(t)?Sr:Lr;return n&&Zn(t,e,n)&&(e=void 0),r(t,Ke(e))};function Nr(t,e=[]){return!!(t instanceof lr||t instanceof fr||t instanceof pr)||(t instanceof dr?gr(t.definition,(t=>Nr(t,e))):!(t instanceof sr&&Or(e,t))&&t instanceof or&&(t instanceof sr&&e.push(t),Ir(t.definition,(t=>Nr(t,e)))))}function kr(t){if(t instanceof sr)return"SUBRULE";if(t instanceof lr)return"OPTION";if(t instanceof dr)return"OR";if(t instanceof ur)return"AT_LEAST_ONE";if(t instanceof hr)return"AT_LEAST_ONE_SEP";if(t instanceof pr)return"MANY_SEP";if(t instanceof fr)return"MANY";if(t instanceof Er)return"CONSUME";throw Error("non exhaustive match")}class xr{walk(t,e=[]){J(t.definition,((n,r)=>{const i=Bn(t.definition,r+1);if(n instanceof sr)this.walkProdRef(n,i,e);else if(n instanceof Er)this.walkTerminal(n,i,e);else if(n instanceof cr)this.walkFlat(n,i,e);else if(n instanceof lr)this.walkOption(n,i,e);else if(n instanceof ur)this.walkAtLeastOne(n,i,e);else if(n instanceof hr)this.walkAtLeastOneSep(n,i,e);else if(n instanceof pr)this.walkManySep(n,i,e);else if(n instanceof fr)this.walkMany(n,i,e);else{if(!(n instanceof dr))throw Error("non exhaustive match");this.walkOr(n,i,e)}}))}walkTerminal(t,e,n){}walkProdRef(t,e,n){}walkFlat(t,e,n){const r=e.concat(n);this.walk(t,r)}walkOption(t,e,n){const r=e.concat(n);this.walk(t,r)}walkAtLeastOne(t,e,n){const r=[new lr({definition:t.definition})].concat(e,n);this.walk(t,r)}walkAtLeastOneSep(t,e,n){const r=br(t,e,n);this.walk(t,r)}walkMany(t,e,n){const r=[new lr({definition:t.definition})].concat(e,n);this.walk(t,r)}walkManySep(t,e,n){const r=br(t,e,n);this.walk(t,r)}walkOr(t,e,n){const r=e.concat(n);J(t.definition,(t=>{const e=new cr({definition:[t]});this.walk(e,r)}))}}function br(t,e,n){return[new lr({definition:[new Er({terminalType:t.separator})].concat(t.definition)})].concat(e,n)}const Cr=function(t,e){return!(null==t||!t.length)&&Ar(t,e,0)>-1},Pr=function(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1},Mr=function(){},wr=yt&&1/ee(new yt([,-0]))[1]==1/0?function(t){return new yt(t)}:Mr,Ur=function(t){return t&&t.length?function(t,e,n){var r=-1,i=Cr,o=t.length,s=!0,a=[],c=a;if(n)s=!1,i=Pr;else if(o>=200){var l=e?null:wr(t);if(l)return ee(l);s=!1,i=Zt,c=new qt}else c=e?[]:a;t:for(;++r<o;){var u=t[r],h=e?e(u):u;if(u=n||0!==u?u:0,s&&h==h){for(var f=c.length;f--;)if(c[f]===h)continue t;e&&c.push(h),a.push(u)}else i(c,h,n)||(c!==a&&c.push(h),a.push(u))}return a}(t):[]};var Fr=c?c.isConcatSpreadable:void 0;const Dr=function(t){return A(t)||v(t)||!!(Fr&&t&&t[Fr])},jr=function t(e,n,r,i,o){var s=-1,a=e.length;for(r||(r=Dr),o||(o=[]);++s<a;){var c=e[s];n>0&&r(c)?n>1?t(c,n-1,r,i,o):ie(o,c):i||(o[o.length]=c)}return o},$r=function(t){return null!=t&&t.length?jr(t,1):[]};function Br(t){if(t instanceof sr)return Br(t.referencedRule);if(t instanceof Er)return[t.terminalType];if(function(t){return t instanceof cr||t instanceof lr||t instanceof fr||t instanceof ur||t instanceof hr||t instanceof pr||t instanceof Er||t instanceof ar}(t))return function(t){let e=[];const n=t.definition;let r,i=0,o=n.length>i,s=!0;for(;o&&s;)r=n[i],s=Nr(r),e=e.concat(Br(r)),i+=1,o=n.length>i;return Ur(e)}(t);if(function(t){return t instanceof dr}(t))return function(t){const e=We(t.definition,(t=>Br(t)));return Ur($r(e))}(t);throw Error("non exhaustive match")}const Gr="_~IN~_";class Kr extends xr{constructor(t){super(),this.topProd=t,this.follows={}}startWalking(){return this.walk(this.topProd),this.follows}walkTerminal(t,e,n){}walkProdRef(t,e,n){const r=(i=t.referencedRule,o=t.idx,i.name+o+Gr+this.topProd.name);var i,o;const s=e.concat(n),a=Br(new cr({definition:s}));this.follows[r]=a}}const Vr=function(t){return void 0===t};function Wr(t){return t.charCodeAt(0)}function zr(t,e){Array.isArray(t)?t.forEach((function(t){e.push(t)})):e.push(t)}function Hr(t,e){if(!0===t[e])throw"duplicate flag "+e;t[e],t[e]=!0}function Yr(t){if(void 0===t)throw Error("Internal Error - Should never get here!");return!0}function qr(){throw Error("Internal Error - Should never get here!")}function Xr(t){return"Character"===t.type}const Zr=[];for(let t=Wr("0");t<=Wr("9");t++)Zr.push(t);const Jr=[Wr("_")].concat(Zr);for(let t=Wr("a");t<=Wr("z");t++)Jr.push(t);for(let t=Wr("A");t<=Wr("Z");t++)Jr.push(t);const Qr=[Wr(" "),Wr("\f"),Wr("\n"),Wr("\r"),Wr("\t"),Wr("\v"),Wr("\t"),Wr(""),Wr(""),Wr(""),Wr(""),Wr(""),Wr(""),Wr(""),Wr(""),Wr(""),Wr(""),Wr(""),Wr(""),Wr(""),Wr("\u2028"),Wr("\u2029"),Wr(""),Wr(""),Wr(""),Wr("\ufeff")],ti=/[0-9a-fA-F]/,ei=/[0-9]/,ni=/[1-9]/;class ri{visitChildren(t){for(const e in t){const n=t[e];t.hasOwnProperty(e)&&(void 0!==n.type?this.visit(n):Array.isArray(n)&&n.forEach((t=>{this.visit(t)}),this))}}visit(t){switch(t.type){case"Pattern":this.visitPattern(t);break;case"Flags":this.visitFlags(t);break;case"Disjunction":this.visitDisjunction(t);break;case"Alternative":this.visitAlternative(t);break;case"StartAnchor":this.visitStartAnchor(t);break;case"EndAnchor":this.visitEndAnchor(t);break;case"WordBoundary":this.visitWordBoundary(t);break;case"NonWordBoundary":this.visitNonWordBoundary(t);break;case"Lookahead":this.visitLookahead(t);break;case"NegativeLookahead":this.visitNegativeLookahead(t);break;case"Character":this.visitCharacter(t);break;case"Set":this.visitSet(t);break;case"Group":this.visitGroup(t);break;case"GroupBackReference":this.visitGroupBackReference(t);break;case"Quantifier":this.visitQuantifier(t)}this.visitChildren(t)}visitPattern(t){}visitFlags(t){}visitDisjunction(t){}visitAlternative(t){}visitStartAnchor(t){}visitEndAnchor(t){}visitWordBoundary(t){}visitNonWordBoundary(t){}visitLookahead(t){}visitNegativeLookahead(t){}visitCharacter(t){}visitSet(t){}visitGroup(t){}visitGroupBackReference(t){}visitQuantifier(t){}}var ii=Object.prototype,oi=ii.hasOwnProperty;const si=Xn((function(t,e){t=Object(t);var n=-1,r=e.length,i=r>2?e[2]:void 0;for(i&&Zn(e[0],e[1],i)&&(r=1);++n<r;)for(var o=e[n],s=nn(o),a=-1,c=s.length;++a<c;){var l=s[a],u=t[l];(void 0===u||Pt(u,ii[l])&&!oi.call(t,l))&&(t[l]=o[l])}return t})),ai=function(t,e){var n=[];return X(t,(function(t,r,i){e(t,r,i)&&n.push(t)})),n},ci=function(t,e){return(A(t)?se:ai)(t,function(t){if("function"!=typeof t)throw new TypeError("Expected a function");return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}(Ke(e)))};var li=Math.max;const ui=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:$n(n);return i<0&&(i=li(r+i,0)),Ar(t,e,i)},hi=function(t,e,n,r){var i=-1,o=null==t?0:t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n},fi=function(t,e,n,r,i){return i(t,(function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)})),n},pi=function(t,e,n){var r=A(t)?hi:fi,i=arguments.length<3;return r(t,Ke(e),n,i,X)},di=function(t,e){return(A(t)?se:ai)(t,Ke(e))},Ei=function(t){return m(t)&&Y(t)},mi=Xn((function(t,e){return Ei(t)?function(t,e,n,r){var i=-1,o=Cr,s=!0,a=t.length,c=[],l=e.length;if(!a)return c;n&&(e=Q(e,b(n))),r?(o=Pr,s=!1):e.length>=200&&(o=Zt,s=!1,e=new qt(e));t:for(;++i<a;){var u=t[i],h=null==n?u:n(u);if(u=r||0!==u?u:0,s&&h==h){for(var f=l;f--;)if(e[f]===h)continue t;c.push(u)}else o(e,h,r)||c.push(u)}return c}(t,jr(e,1,Ei,!0)):[]})),yi=function(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var o=t[e];o&&(i[r++]=o)}return i},_i=function(t){return t&&t.length?t[0]:void 0};var gi=Math.max;const Ti=(vi=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:$n(n);return i<0&&(i=gi(r+i,0)),Tr(t,Ke(e),i)},function(t,e,n){var r=Object(t);if(!Y(t)){var i=Ke(e);t=q(t),e=function(t){return i(r[t],t,r)}}var o=vi(t,e,n);return o>-1?r[i?t[o]:o]:void 0});var vi;function Ai(t){console&&console.error&&console.error(`Error: ${t}`)}function Ri(t){console&&console.warn&&console.warn(`Warning: ${t}`)}let Oi={};const Si=new class{constructor(){this.idx=0,this.input="",this.groupIdx=0}saveState(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}}restoreState(t){this.idx=t.idx,this.input=t.input,this.groupIdx=t.groupIdx}pattern(t){this.idx=0,this.input=t,this.groupIdx=0,this.consumeChar("/");const e=this.disjunction();this.consumeChar("/");const n={type:"Flags",loc:{begin:this.idx,end:t.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};for(;this.isRegExpFlag();)switch(this.popChar()){case"g":Hr(n,"global");break;case"i":Hr(n,"ignoreCase");break;case"m":Hr(n,"multiLine");break;case"u":Hr(n,"unicode");break;case"y":Hr(n,"sticky")}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:n,value:e,loc:this.loc(0)}}disjunction(){const t=[],e=this.idx;for(t.push(this.alternative());"|"===this.peekChar();)this.consumeChar("|"),t.push(this.alternative());return{type:"Disjunction",value:t,loc:this.loc(e)}}alternative(){const t=[],e=this.idx;for(;this.isTerm();)t.push(this.term());return{type:"Alternative",value:t,loc:this.loc(e)}}term(){return this.isAssertion()?this.assertion():this.atom()}assertion(){const t=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(t)};case"$":return{type:"EndAnchor",loc:this.loc(t)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(t)};case"B":return{type:"NonWordBoundary",loc:this.loc(t)}}throw Error("Invalid Assertion Escape");case"(":let e;switch(this.consumeChar("?"),this.popChar()){case"=":e="Lookahead";break;case"!":e="NegativeLookahead"}Yr(e);const n=this.disjunction();return this.consumeChar(")"),{type:e,value:n,loc:this.loc(t)}}return qr()}quantifier(t=!1){let e;const n=this.idx;switch(this.popChar()){case"*":e={atLeast:0,atMost:1/0};break;case"+":e={atLeast:1,atMost:1/0};break;case"?":e={atLeast:0,atMost:1};break;case"{":const n=this.integerIncludingZero();switch(this.popChar()){case"}":e={atLeast:n,atMost:n};break;case",":let t;this.isDigit()?(t=this.integerIncludingZero(),e={atLeast:n,atMost:t}):e={atLeast:n,atMost:1/0},this.consumeChar("}")}if(!0===t&&void 0===e)return;Yr(e)}if(!0!==t||void 0!==e)return Yr(e)?("?"===this.peekChar(0)?(this.consumeChar("?"),e.greedy=!1):e.greedy=!0,e.type="Quantifier",e.loc=this.loc(n),e):void 0}atom(){let t;const e=this.idx;switch(this.peekChar()){case".":t=this.dotAll();break;case"\\":t=this.atomEscape();break;case"[":t=this.characterClass();break;case"(":t=this.group()}return void 0===t&&this.isPatternCharacter()&&(t=this.patternCharacter()),Yr(t)?(t.loc=this.loc(e),this.isQuantifier()&&(t.quantifier=this.quantifier()),t):qr()}dotAll(){return this.consumeChar("."),{type:"Set",complement:!0,value:[Wr("\n"),Wr("\r"),Wr("\u2028"),Wr("\u2029")]}}atomEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}decimalEscapeAtom(){return{type:"GroupBackReference",value:this.positiveInteger()}}characterClassEscape(){let t,e=!1;switch(this.popChar()){case"d":t=Zr;break;case"D":t=Zr,e=!0;break;case"s":t=Qr;break;case"S":t=Qr,e=!0;break;case"w":t=Jr;break;case"W":t=Jr,e=!0}return Yr(t)?{type:"Set",value:t,complement:e}:qr()}controlEscapeAtom(){let t;switch(this.popChar()){case"f":t=Wr("\f");break;case"n":t=Wr("\n");break;case"r":t=Wr("\r");break;case"t":t=Wr("\t");break;case"v":t=Wr("\v")}return Yr(t)?{type:"Character",value:t}:qr()}controlLetterEscapeAtom(){this.consumeChar("c");const t=this.popChar();if(!1===/[a-zA-Z]/.test(t))throw Error("Invalid ");return{type:"Character",value:t.toUpperCase().charCodeAt(0)-64}}nulCharacterAtom(){return this.consumeChar("0"),{type:"Character",value:Wr("\0")}}hexEscapeSequenceAtom(){return this.consumeChar("x"),this.parseHexDigits(2)}regExpUnicodeEscapeSequenceAtom(){return this.consumeChar("u"),this.parseHexDigits(4)}identityEscapeAtom(){return{type:"Character",value:Wr(this.popChar())}}classPatternCharacterAtom(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:return{type:"Character",value:Wr(this.popChar())}}}characterClass(){const t=[];let e=!1;for(this.consumeChar("["),"^"===this.peekChar(0)&&(this.consumeChar("^"),e=!0);this.isClassAtom();){const e=this.classAtom();if(e.type,Xr(e)&&this.isRangeDash()){this.consumeChar("-");const n=this.classAtom();if(n.type,Xr(n)){if(n.value<e.value)throw Error("Range out of order in character class");t.push({from:e.value,to:n.value})}else zr(e.value,t),t.push(Wr("-")),zr(n.value,t)}else zr(e.value,t)}return this.consumeChar("]"),{type:"Set",complement:e,value:t}}classAtom(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}}classEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:Wr("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}group(){let t=!0;this.consumeChar("("),"?"===this.peekChar(0)?(this.consumeChar("?"),this.consumeChar(":"),t=!1):this.groupIdx++;const e=this.disjunction();this.consumeChar(")");const n={type:"Group",capturing:t,value:e};return t&&(n.idx=this.groupIdx),n}positiveInteger(){let t=this.popChar();if(!1===ni.test(t))throw Error("Expecting a positive integer");for(;ei.test(this.peekChar(0));)t+=this.popChar();return parseInt(t,10)}integerIncludingZero(){let t=this.popChar();if(!1===ei.test(t))throw Error("Expecting an integer");for(;ei.test(this.peekChar(0));)t+=this.popChar();return parseInt(t,10)}patternCharacter(){const t=this.popChar();switch(t){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:Wr(t)}}}isRegExpFlag(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}}isRangeDash(){return"-"===this.peekChar()&&this.isClassAtom(1)}isDigit(){return ei.test(this.peekChar(0))}isClassAtom(t=0){switch(this.peekChar(t)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}isTerm(){return this.isAtom()||this.isAssertion()}isAtom(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}}isAssertion(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return"?"===this.peekChar(1)&&("="===this.peekChar(2)||"!"===this.peekChar(2));default:return!1}}isQuantifier(){const t=this.saveState();try{return void 0!==this.quantifier(!0)}catch(t){return!1}finally{this.restoreState(t)}}isPatternCharacter(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}parseHexDigits(t){let e="";for(let n=0;n<t;n++){const t=this.popChar();if(!1===ti.test(t))throw Error("Expecting a HexDecimal digits");e+=t}return{type:"Character",value:parseInt(e,16)}}peekChar(t=0){return this.input[this.idx+t]}popChar(){const t=this.peekChar(0);return this.consumeChar(void 0),t}consumeChar(t){if(void 0!==t&&this.input[this.idx]!==t)throw Error("Expected: '"+t+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++}loc(t){return{begin:t,end:this.idx}}};function Li(t){const e=t.toString();if(Oi.hasOwnProperty(e))return Oi[e];{const t=Si.pattern(e);return Oi[e]=t,t}}const Ii="Complement Sets are not supported for first char optimization",Ni='Unable to use "first char" lexer optimizations:\n';function ki(t,e=!1){try{const e=Li(t);return xi(e.value,{},e.flags.ignoreCase)}catch(n){if(n.message===Ii)e&&Ri(`${Ni}\tUnable to optimize: < ${t.toString()} >\n\tComplement Sets cannot be automatically optimized.\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{let n="";e&&(n="\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details."),Ai(`${Ni}\n\tFailed parsing: < ${t.toString()} >\n\tUsing the @chevrotain/regexp-to-ast library\n\tPlease open an issue at: https://github.com/chevrotain/chevrotain/issues`+n)}}return[]}function xi(t,e,n){switch(t.type){case"Disjunction":for(let r=0;r<t.value.length;r++)xi(t.value[r],e,n);break;case"Alternative":const r=t.value;for(let t=0;t<r.length;t++){const i=r[t];switch(i.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}const o=i;switch(o.type){case"Character":bi(o.value,e,n);break;case"Set":if(!0===o.complement)throw Error(Ii);J(o.value,(t=>{if("number"==typeof t)bi(t,e,n);else{const r=t;if(!0===n)for(let t=r.from;t<=r.to;t++)bi(t,e,n);else{for(let t=r.from;t<=r.to&&t<Xi;t++)bi(t,e,n);if(r.to>=Xi){const t=r.from>=Xi?r.from:Xi,n=r.to,i=Ji(t),o=Ji(n);for(let t=i;t<=o;t++)e[t]=t}}}}));break;case"Group":xi(o.value,e,n);break;default:throw Error("Non Exhaustive Match")}const s=void 0!==o.quantifier&&0===o.quantifier.atLeast;if("Group"===o.type&&!1===Pi(o)||"Group"!==o.type&&!1===s)break}break;default:throw Error("non exhaustive match!")}return tt(e)}function bi(t,e,n){const r=Ji(t);e[r]=r,!0===n&&function(t,e){const n=String.fromCharCode(t),r=n.toUpperCase();if(r!==n){const t=Ji(r.charCodeAt(0));e[t]=t}else{const t=n.toLowerCase();if(t!==n){const n=Ji(t.charCodeAt(0));e[n]=n}}}(t,e)}function Ci(t,e){return Ti(t.value,(t=>{if("number"==typeof t)return Or(e,t);{const n=t;return void 0!==Ti(e,(t=>n.from<=t&&t<=n.to))}}))}function Pi(t){const e=t.quantifier;return!(!e||0!==e.atLeast)||!!t.value&&(A(t.value)?Ir(t.value,Pi):Pi(t.value))}class Mi extends ri{constructor(t){super(),this.targetCharCodes=t,this.found=!1}visitChildren(t){if(!0!==this.found){switch(t.type){case"Lookahead":return void this.visitLookahead(t);case"NegativeLookahead":return void this.visitNegativeLookahead(t)}super.visitChildren(t)}}visitCharacter(t){Or(this.targetCharCodes,t.value)&&(this.found=!0)}visitSet(t){t.complement?void 0===Ci(t,this.targetCharCodes)&&(this.found=!0):void 0!==Ci(t,this.targetCharCodes)&&(this.found=!0)}}function wi(t,e){if(e instanceof RegExp){const n=Li(e),r=new Mi(t);return r.visit(n),r.found}return void 0!==Ti(e,(e=>Or(t,e.charCodeAt(0))))}const Ui="PATTERN",Fi="defaultMode",Di="modes";let ji="boolean"==typeof new RegExp("(?:)").sticky;const $i=/[^\\][$]/,Bi=/[^\\[][\^]|^\^/;function Gi(t){const e=t.ignoreCase?"i":"";return new RegExp(`^(?:${t.source})`,e)}function Ki(t){const e=t.ignoreCase?"iy":"y";return new RegExp(`${t.source}`,e)}function Vi(t){const e=t.PATTERN;if(ir(e))return!1;if(H(e))return!0;if(Ye(e,"exec"))return!0;if(Gn(e))return!1;throw Error("non exhaustive match")}function Wi(t){return!(!Gn(t)||1!==t.length)&&t.charCodeAt(0)}const zi={test:function(t){const e=t.length;for(let n=this.lastIndex;n<e;n++){const e=t.charCodeAt(n);if(10===e)return this.lastIndex=n+1,!0;if(13===e)return 10===t.charCodeAt(n+1)?this.lastIndex=n+2:this.lastIndex=n+1,!0}return!1},lastIndex:0};function Hi(t,e){if(Ye(t,"LINE_BREAKS"))return!1;if(ir(t.PATTERN)){try{wi(e,t.PATTERN)}catch(t){return{issue:uo.IDENTIFY_TERMINATOR,errMsg:t.message}}return!1}if(Gn(t.PATTERN))return!1;if(Vi(t))return{issue:uo.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}function Yi(t){return We(t,(t=>Gn(t)?t.charCodeAt(0):t))}function qi(t,e,n){void 0===t[e]?t[e]=[n]:t[e].push(n)}const Xi=256;let Zi=[];function Ji(t){return t<Xi?t:Zi[t]}const Qi=function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0};function to(t){const e=(new Date).getTime(),n=t();return{time:(new Date).getTime()-e,value:n}}function eo(t,e){const n=t.tokenTypeIdx;return n===e.tokenTypeIdx||!0===e.isParent&&!0===e.categoryMatchesMap[n]}function no(t,e){return t.tokenTypeIdx===e.tokenTypeIdx}let ro=1;const io={};function oo(t){const e=function(t){let e=Nn(t),n=t,r=!0;for(;r;){n=yi($r(We(n,(t=>t.CATEGORIES))));const t=mi(n,e);e=e.concat(t),Ct(t)?r=!1:n=t}return e}(t);!function(t){J(t,(t=>{ao(t)||(io[ro]=t,t.tokenTypeIdx=ro++),co(t)&&!A(t.CATEGORIES)&&(t.CATEGORIES=[t.CATEGORIES]),co(t)||(t.CATEGORIES=[]),Ye(t,"categoryMatches")||(t.categoryMatches=[]),Ye(t,"categoryMatchesMap")||(t.categoryMatchesMap={})}))}(e),function(t){J(t,(t=>{so([],t)}))}(e),function(t){J(t,(t=>{t.categoryMatches=[],J(t.categoryMatchesMap,((e,n)=>{t.categoryMatches.push(io[n].tokenTypeIdx)}))}))}(e),J(e,(t=>{t.isParent=t.categoryMatches.length>0}))}function so(t,e){J(t,(t=>{e.categoryMatchesMap[t.tokenTypeIdx]=!0})),J(e.CATEGORIES,(n=>{const r=t.concat(e);Or(r,n)||so(r,n)}))}function ao(t){return Ye(t,"tokenTypeIdx")}function co(t){return Ye(t,"CATEGORIES")}function lo(t){return Ye(t,"tokenTypeIdx")}var uo;!function(t){t[t.MISSING_PATTERN=0]="MISSING_PATTERN",t[t.INVALID_PATTERN=1]="INVALID_PATTERN",t[t.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",t[t.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",t[t.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",t[t.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",t[t.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",t[t.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",t[t.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",t[t.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",t[t.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",t[t.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",t[t.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",t[t.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",t[t.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",t[t.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",t[t.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK",t[t.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE=17]="MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE"}(uo||(uo={}));const ho={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:{buildUnableToPopLexerModeMessage:t=>`Unable to pop Lexer Mode after encountering Token ->${t.image}<- The Mode Stack is empty`,buildUnexpectedCharactersMessage:(t,e,n,r,i)=>`unexpected character: ->${t.charAt(e)}<- at offset: ${e}, skipped ${n} characters.`},traceInitPerf:!1,skipValidations:!1,recoveryEnabled:!0};Object.freeze(ho);class fo{constructor(t,e=ho){if(this.lexerDefinition=t,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},this.TRACE_INIT=(t,e)=>{if(!0===this.traceInitPerf){this.traceInitIndent++;const n=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${n}--\x3e <${t}>`);const{time:r,value:i}=to(e),o=r>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&o(`${n}<-- <${t}> time: ${r}ms`),this.traceInitIndent--,i}return e()},"boolean"==typeof e)throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\na boolean 2nd argument is no longer supported");this.config=Qn({},ho,e);const n=this.config.traceInitPerf;!0===n?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):"number"==typeof n&&(this.traceInitMaxIdent=n,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",(()=>{let n,r=!0;this.TRACE_INIT("Lexer Config handling",(()=>{if(this.config.lineTerminatorsPattern===ho.lineTerminatorsPattern)this.config.lineTerminatorsPattern=zi;else if(this.config.lineTerminatorCharacters===ho.lineTerminatorCharacters)throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS");if(e.safeMode&&e.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking),this.trackEndLines=/full/i.test(this.config.positionTracking),A(t)?n={modes:{defaultMode:Nn(t)},defaultMode:Fi}:(r=!1,n=Nn(t))})),!1===this.config.skipValidations&&(this.TRACE_INIT("performRuntimeChecks",(()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(function(t,e,n){const r=[];return Ye(t,Fi)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+Fi+"> property in its definition\n",type:uo.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),Ye(t,Di)||r.push({message:"A MultiMode Lexer cannot be initialized without a <modes> property in its definition\n",type:uo.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),Ye(t,Di)&&Ye(t,Fi)&&!Ye(t.modes,t.defaultMode)&&r.push({message:`A MultiMode Lexer cannot be initialized with a ${Fi}: <${t.defaultMode}>which does not exist\n`,type:uo.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),Ye(t,Di)&&J(t.modes,((t,e)=>{J(t,((n,i)=>{if(Vr(n))r.push({message:`A Lexer cannot be initialized using an undefined Token Type. Mode:<${e}> at index: <${i}>\n`,type:uo.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED});else if(Ye(n,"LONGER_ALT")){const i=A(n.LONGER_ALT)?n.LONGER_ALT:[n.LONGER_ALT];J(i,(i=>{Vr(i)||Or(t,i)||r.push({message:`A MultiMode Lexer cannot be initialized with a longer_alt <${i.name}> on token <${n.name}> outside of mode <${e}>\n`,type:uo.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE})}))}}))})),r}(n,this.trackStartLines,this.config.lineTerminatorCharacters))})),this.TRACE_INIT("performWarningRuntimeChecks",(()=>{this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(function(t,e,n){const r=[];let i=!1;const o=yi($r(tt(t.modes))),s=ci(o,(t=>t[Ui]===fo.NA)),a=Yi(n);return e&&J(s,(t=>{const e=Hi(t,a);if(!1!==e){const n=function(t,e){if(e.issue===uo.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.\n\tThe problem is in the <${t.name}> Token Type\n\t Root cause: ${e.errMsg}.\n\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR`;if(e.issue===uo.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.\n\tThe problem is in the <${t.name}> Token Type\n\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK`;throw Error("non exhaustive match")}(t,e),i={message:n,type:e.issue,tokenType:t};r.push(i)}else Ye(t,"LINE_BREAKS")?!0===t.LINE_BREAKS&&(i=!0):wi(a,t.PATTERN)&&(i=!0)})),e&&!i&&r.push({message:"Warning: No LINE_BREAKS Found.\n\tThis Lexer has been defined to track line and column information,\n\tBut none of the Token Types can be identified as matching a line terminator.\n\tSee https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n\tfor details.",type:uo.NO_LINE_BREAKS_FLAGS}),r}(n,this.trackStartLines,this.config.lineTerminatorCharacters))}))),n.modes=n.modes?n.modes:{},J(n.modes,((t,e)=>{n.modes[e]=ci(t,(t=>Vr(t)))}));const i=q(n.modes);if(J(n.modes,((t,n)=>{this.TRACE_INIT(`Mode: <${n}> processing`,(()=>{if(this.modes.push(n),!1===this.config.skipValidations&&this.TRACE_INIT("validatePatterns",(()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(function(t,e){let n=[];const r=function(t){const e=di(t,(t=>!Ye(t,Ui)));return{errors:We(e,(t=>({message:"Token Type: ->"+t.name+"<- missing static 'PATTERN' property",type:uo.MISSING_PATTERN,tokenTypes:[t]}))),valid:mi(t,e)}}(t);n=n.concat(r.errors);const i=function(t){const e=di(t,(t=>{const e=t[Ui];return!(ir(e)||H(e)||Ye(e,"exec")||Gn(e))}));return{errors:We(e,(t=>({message:"Token Type: ->"+t.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:uo.INVALID_PATTERN,tokenTypes:[t]}))),valid:mi(t,e)}}(r.valid),o=i.valid;return n=n.concat(i.errors),n=n.concat(function(t){let e=[];const n=di(t,(t=>ir(t[Ui])));return e=e.concat(function(t){class e extends ri{constructor(){super(...arguments),this.found=!1}visitEndAnchor(t){this.found=!0}}const n=di(t,(t=>{const n=t.PATTERN;try{const t=Li(n),r=new e;return r.visit(t),r.found}catch(t){return $i.test(n.source)}}));return We(n,(t=>({message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+t.name+"<- static 'PATTERN' cannot contain end of input anchor '$'\n\tSee chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:uo.EOI_ANCHOR_FOUND,tokenTypes:[t]})))}(n)),e=e.concat(function(t){class e extends ri{constructor(){super(...arguments),this.found=!1}visitStartAnchor(t){this.found=!0}}const n=di(t,(t=>{const n=t.PATTERN;try{const t=Li(n),r=new e;return r.visit(t),r.found}catch(t){return Bi.test(n.source)}}));return We(n,(t=>({message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+t.name+"<- static 'PATTERN' cannot contain start of input anchor '^'\n\tSee https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:uo.SOI_ANCHOR_FOUND,tokenTypes:[t]})))}(n)),e=e.concat(function(t){const e=di(t,(t=>{const e=t[Ui];return e instanceof RegExp&&(e.multiline||e.global)}));return We(e,(t=>({message:"Token Type: ->"+t.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:uo.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[t]})))}(n)),e=e.concat(function(t){const e=[];let n=We(t,(n=>pi(t,((t,r)=>(n.PATTERN.source!==r.PATTERN.source||Or(e,r)||r.PATTERN===fo.NA||(e.push(r),t.push(r)),t)),[])));n=yi(n);const r=di(n,(t=>t.length>1));return We(r,(t=>{const e=We(t,(t=>t.name));return{message:`The same RegExp pattern ->${_i(t).PATTERN}<-has been used in all of the following Token Types: ${e.join(", ")} <-`,type:uo.DUPLICATE_PATTERNS_FOUND,tokenTypes:t}}))}(n)),e=e.concat(function(t){const e=di(t,(t=>t.PATTERN.test("")));return We(e,(t=>({message:"Token Type: ->"+t.name+"<- static 'PATTERN' must not match an empty string",type:uo.EMPTY_MATCH_PATTERN,tokenTypes:[t]})))}(n)),e}(o)),n=n.concat(function(t){const e=di(t,(t=>{if(!Ye(t,"GROUP"))return!1;const e=t.GROUP;return e!==fo.SKIPPED&&e!==fo.NA&&!Gn(e)}));return We(e,(t=>({message:"Token Type: ->"+t.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:uo.INVALID_GROUP_TYPE_FOUND,tokenTypes:[t]})))}(o)),n=n.concat(function(t,e){const n=di(t,(t=>void 0!==t.PUSH_MODE&&!Or(e,t.PUSH_MODE)));return We(n,(t=>({message:`Token Type: ->${t.name}<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->${t.PUSH_MODE}<-which does not exist`,type:uo.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[t]})))}(o,e)),n=n.concat(function(t){const e=[],n=pi(t,((t,e,n)=>{const r=e.PATTERN;return r===fo.NA||(Gn(r)?t.push({str:r,idx:n,tokenType:e}):ir(r)&&(i=r,void 0===Ti([".","\\","[","]","|","^","$","(",")","?","*","+","{"],(t=>-1!==i.source.indexOf(t))))&&t.push({str:r.source,idx:n,tokenType:e})),t;var i}),[]);return J(t,((t,r)=>{J(n,(({str:n,idx:i,tokenType:o})=>{if(r<i&&function(t,e){if(ir(e)){const n=e.exec(t);return null!==n&&0===n.index}if(H(e))return e(t,0,[],{});if(Ye(e,"exec"))return e.exec(t,0,[],{});if("string"==typeof e)return e===t;throw Error("non exhaustive match")}(n,t.PATTERN)){const n=`Token: ->${o.name}<- can never be matched.\nBecause it appears AFTER the Token Type ->${t.name}<-in the lexer's definition.\nSee https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:n,type:uo.UNREACHABLE_PATTERN,tokenTypes:[t,o]})}}))})),e}(o)),n}(t,i))})),Ct(this.lexerDefinitionErrors)){let r;oo(t),this.TRACE_INIT("analyzeTokenTypes",(()=>{r=function(t,e){const n=(e=si(e,{useSticky:ji,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r","\n"],tracer:(t,e)=>e()})).tracer;let r;n("initCharCodeToOptimizedIndexMap",(()=>{!function(){if(Ct(Zi)){Zi=new Array(65536);for(let t=0;t<65536;t++)Zi[t]=t>255?255+~~(t/255):t}}()})),n("Reject Lexer.NA",(()=>{r=ci(t,(t=>t[Ui]===fo.NA))}));let i,o,s,a,c,l,u,h,f,p,d,E=!1;n("Transform Patterns",(()=>{E=!1,i=We(r,(t=>{const n=t[Ui];if(ir(n)){const t=n.source;return 1!==t.length||"^"===t||"$"===t||"."===t||n.ignoreCase?2!==t.length||"\\"!==t[0]||Or(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],t[1])?e.useSticky?Ki(n):Gi(n):t[1]:t}if(H(n))return E=!0,{exec:n};if("object"==typeof n)return E=!0,n;if("string"==typeof n){if(1===n.length)return n;{const t=n.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),r=new RegExp(t);return e.useSticky?Ki(r):Gi(r)}}throw Error("non exhaustive match")}))})),n("misc mapping",(()=>{o=We(r,(t=>t.tokenTypeIdx)),s=We(r,(t=>{const e=t.GROUP;if(e!==fo.SKIPPED){if(Gn(e))return e;if(Vr(e))return!1;throw Error("non exhaustive match")}})),a=We(r,(t=>{const e=t.LONGER_ALT;if(e)return A(e)?We(e,(t=>ui(r,t))):[ui(r,e)]})),c=We(r,(t=>t.PUSH_MODE)),l=We(r,(t=>Ye(t,"POP_MODE")))})),n("Line Terminator Handling",(()=>{const t=Yi(e.lineTerminatorCharacters);u=We(r,(t=>!1)),"onlyOffset"!==e.positionTracking&&(u=We(r,(e=>Ye(e,"LINE_BREAKS")?!!e.LINE_BREAKS:!1===Hi(e,t)&&wi(t,e.PATTERN))))})),n("Misc Mapping #2",(()=>{h=We(r,Vi),f=We(i,Wi),p=pi(r,((t,e)=>{const n=e.GROUP;return Gn(n)&&n!==fo.SKIPPED&&(t[n]=[]),t}),{}),d=We(i,((t,e)=>({pattern:i[e],longerAlt:a[e],canLineTerminator:u[e],isCustom:h[e],short:f[e],group:s[e],push:c[e],pop:l[e],tokenTypeIdx:o[e],tokenType:r[e]})))}));let m=!0,y=[];return e.safeMode||n("First Char Optimization",(()=>{y=pi(r,((t,n,r)=>{if("string"==typeof n.PATTERN){const e=Ji(n.PATTERN.charCodeAt(0));qi(t,e,d[r])}else if(A(n.START_CHARS_HINT)){let e;J(n.START_CHARS_HINT,(n=>{const i=Ji("string"==typeof n?n.charCodeAt(0):n);e!==i&&(e=i,qi(t,i,d[r]))}))}else if(ir(n.PATTERN))if(n.PATTERN.unicode)m=!1,e.ensureOptimizations&&Ai(`${Ni}\tUnable to analyze < ${n.PATTERN.toString()} > pattern.\n\tThe regexp unicode flag is not currently supported by the regexp-to-ast library.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{const i=ki(n.PATTERN,e.ensureOptimizations);Ct(i)&&(m=!1),J(i,(e=>{qi(t,e,d[r])}))}else e.ensureOptimizations&&Ai(`${Ni}\tTokenType: <${n.name}> is using a custom token pattern without providing <start_chars_hint> parameter.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),m=!1;return t}),[])})),{emptyGroups:p,patternIdxToConfig:d,charCodeToPatternIdxToConfig:y,hasCustom:E,canBeOptimized:m}}(t,{lineTerminatorCharacters:this.config.lineTerminatorCharacters,positionTracking:e.positionTracking,ensureOptimizations:e.ensureOptimizations,safeMode:e.safeMode,tracer:this.TRACE_INIT})})),this.patternIdxToConfig[n]=r.patternIdxToConfig,this.charCodeToPatternIdxToConfig[n]=r.charCodeToPatternIdxToConfig,this.emptyGroups=Qn({},this.emptyGroups,r.emptyGroups),this.hasCustom=r.hasCustom||this.hasCustom,this.canModeBeOptimized[n]=r.canBeOptimized}}))})),this.defaultMode=n.defaultMode,!Ct(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling){const t=We(this.lexerDefinitionErrors,(t=>t.message)).join("-----------------------\n");throw new Error("Errors detected in definition of Lexer:\n"+t)}J(this.lexerDefinitionWarning,(t=>{Ri(t.message)})),this.TRACE_INIT("Choosing sub-methods implementations",(()=>{if(ji?(this.chopInput=Z,this.match=this.matchWithTest):(this.updateLastIndex=Mr,this.match=this.matchWithExec),r&&(this.handleModes=Mr),!1===this.trackStartLines&&(this.computeNewColumn=Z),!1===this.trackEndLines&&(this.updateTokenEndLineColumnLocation=Mr),/full/i.test(this.config.positionTracking))this.createTokenInstance=this.createFullToken;else if(/onlyStart/i.test(this.config.positionTracking))this.createTokenInstance=this.createStartOnlyToken;else{if(!/onlyOffset/i.test(this.config.positionTracking))throw Error(`Invalid <positionTracking> config option: "${this.config.positionTracking}"`);this.createTokenInstance=this.createOffsetOnlyToken}this.hasCustom?(this.addToken=this.addTokenUsingPush,this.handlePayload=this.handlePayloadWithCustom):(this.addToken=this.addTokenUsingMemberAccess,this.handlePayload=this.handlePayloadNoCustom)})),this.TRACE_INIT("Failed Optimization Warnings",(()=>{const t=pi(this.canModeBeOptimized,((t,e,n)=>(!1===e&&t.push(n),t)),[]);if(e.ensureOptimizations&&!Ct(t))throw Error(`Lexer Modes: < ${t.join(", ")} > cannot be optimized.\n\t Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n\t Or inspect the console log for details on how to resolve these issues.`)})),this.TRACE_INIT("clearRegExpParserCache",(()=>{Oi={}})),this.TRACE_INIT("toFastProperties",(()=>{kn(this)}))}))}tokenize(t,e=this.defaultMode){if(!Ct(this.lexerDefinitionErrors)){const t=We(this.lexerDefinitionErrors,(t=>t.message)).join("-----------------------\n");throw new Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+t)}return this.tokenizeInternal(t,e)}tokenizeInternal(t,e){let n,r,i,o,s,a,c,l,u,h,f,p,d,E,m;const y=t,_=y.length;let g=0,T=0;const v=this.hasCustom?0:Math.floor(t.length/10),R=new Array(v),O=[];let S=this.trackStartLines?1:void 0,L=this.trackStartLines?1:void 0;const I=function(t){const e={},n=q(t);return J(n,(n=>{const r=t[n];if(!A(r))throw Error("non exhaustive match");e[n]=[]})),e}(this.emptyGroups),N=this.trackStartLines,k=this.config.lineTerminatorsPattern;let x=0,b=[],C=[];const P=[],M=[];let w;function U(){return b}function F(t){const e=Ji(t),n=C[e];return void 0===n?M:n}Object.freeze(M);const D=t=>{if(1===P.length&&void 0===t.tokenType.PUSH_MODE){const e=this.config.errorMessageProvider.buildUnableToPopLexerModeMessage(t);O.push({offset:t.startOffset,line:t.startLine,column:t.startColumn,length:t.image.length,message:e})}else{P.pop();const t=Qi(P);b=this.patternIdxToConfig[t],C=this.charCodeToPatternIdxToConfig[t],x=b.length;const e=this.canModeBeOptimized[t]&&!1===this.config.safeMode;w=C&&e?F:U}};function j(t){P.push(t),C=this.charCodeToPatternIdxToConfig[t],b=this.patternIdxToConfig[t],x=b.length,x=b.length;const e=this.canModeBeOptimized[t]&&!1===this.config.safeMode;w=C&&e?F:U}let $;j.call(this,e);const B=this.config.recoveryEnabled;for(;g<_;){a=null;const e=y.charCodeAt(g),v=w(e),A=v.length;for(n=0;n<A;n++){$=v[n];const r=$.pattern;c=null;const u=$.short;if(!1!==u?e===u&&(a=r):!0===$.isCustom?(m=r.exec(y,g,R,I),null!==m?(a=m[0],void 0!==m.payload&&(c=m.payload)):a=null):(this.updateLastIndex(r,g),a=this.match(r,t,g)),null!==a){if(s=$.longerAlt,void 0!==s){const e=s.length;for(i=0;i<e;i++){const e=b[s[i]],n=e.pattern;if(l=null,!0===e.isCustom?(m=n.exec(y,g,R,I),null!==m?(o=m[0],void 0!==m.payload&&(l=m.payload)):o=null):(this.updateLastIndex(n,g),o=this.match(n,t,g)),o&&o.length>a.length){a=o,c=l,$=e;break}}}break}}if(null!==a){if(u=a.length,h=$.group,void 0!==h&&(f=$.tokenTypeIdx,p=this.createTokenInstance(a,g,f,$.tokenType,S,L,u),this.handlePayload(p,c),!1===h?T=this.addToken(R,T,p):I[h].push(p)),t=this.chopInput(t,u),g+=u,L=this.computeNewColumn(L,u),!0===N&&!0===$.canLineTerminator){let t,e,n=0;k.lastIndex=0;do{t=k.test(a),!0===t&&(e=k.lastIndex-1,n++)}while(!0===t);0!==n&&(S+=n,L=u-e,this.updateTokenEndLineColumnLocation(p,h,e,n,S,L,u))}this.handleModes($,D,j,p)}else{const e=g,n=S,i=L;let o=!1===B;for(;!1===o&&g<_;)for(t=this.chopInput(t,1),g++,r=0;r<x;r++){const e=b[r],n=e.pattern,i=e.short;if(!1!==i?y.charCodeAt(g)===i&&(o=!0):!0===e.isCustom?o=null!==n.exec(y,g,R,I):(this.updateLastIndex(n,g),o=null!==n.exec(t)),!0===o)break}if(d=g-e,L=this.computeNewColumn(L,d),E=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(y,e,d,n,i),O.push({offset:e,line:n,column:i,length:d,message:E}),!1===B)break}}return this.hasCustom||(R.length=T),{tokens:R,groups:I,errors:O}}handleModes(t,e,n,r){if(!0===t.pop){const i=t.push;e(r),void 0!==i&&n.call(this,i)}else void 0!==t.push&&n.call(this,t.push)}chopInput(t,e){return t.substring(e)}updateLastIndex(t,e){t.lastIndex=e}updateTokenEndLineColumnLocation(t,e,n,r,i,o,s){let a,c;void 0!==e&&(a=n===s-1,c=a?-1:0,1===r&&!0===a||(t.endLine=i+c,t.endColumn=o-1-c))}computeNewColumn(t,e){return t+e}createOffsetOnlyToken(t,e,n,r){return{image:t,startOffset:e,tokenTypeIdx:n,tokenType:r}}createStartOnlyToken(t,e,n,r,i,o){return{image:t,startOffset:e,startLine:i,startColumn:o,tokenTypeIdx:n,tokenType:r}}createFullToken(t,e,n,r,i,o,s){return{image:t,startOffset:e,endOffset:e+s-1,startLine:i,endLine:i,startColumn:o,endColumn:o+s-1,tokenTypeIdx:n,tokenType:r}}addTokenUsingPush(t,e,n){return t.push(n),e}addTokenUsingMemberAccess(t,e,n){return t[e]=n,++e}handlePayloadNoCustom(t,e){}handlePayloadWithCustom(t,e){null!==e&&(t.payload=e)}matchWithTest(t,e,n){return!0===t.test(e)?e.substring(n,t.lastIndex):null}matchWithExec(t,e){const n=t.exec(e);return null!==n?n[0]:null}}function po(t){return Eo(t)?t.LABEL:t.name}function Eo(t){return Gn(t.LABEL)&&""!==t.LABEL}fo.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",fo.NA=/NOT_APPLICABLE/;const mo="categories",yo="label",_o="group",go="push_mode",To="pop_mode",vo="longer_alt",Ao="line_breaks",Ro="start_chars_hint";function Oo(t){return function(t){const e=t.pattern,n={};if(n.name=t.name,Vr(e)||(n.PATTERN=e),Ye(t,"parent"))throw"The parent property is no longer supported.\nSee: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.";return Ye(t,mo)&&(n.CATEGORIES=t[mo]),oo([n]),Ye(t,yo)&&(n.LABEL=t[yo]),Ye(t,_o)&&(n.GROUP=t[_o]),Ye(t,To)&&(n.POP_MODE=t[To]),Ye(t,go)&&(n.PUSH_MODE=t[go]),Ye(t,vo)&&(n.LONGER_ALT=t[vo]),Ye(t,Ao)&&(n.LINE_BREAKS=t[Ao]),Ye(t,Ro)&&(n.START_CHARS_HINT=t[Ro]),n}(t)}const So=Oo({name:"EOF",pattern:fo.NA});function Lo(t,e,n,r,i,o,s,a){return{image:e,startOffset:n,endOffset:r,startLine:i,endLine:o,startColumn:s,endColumn:a,tokenTypeIdx:t.tokenTypeIdx,tokenType:t}}oo([So]);const Io={buildMismatchTokenMessage:({expected:t,actual:e,previous:n,ruleName:r})=>`Expecting ${Eo(t)?`--\x3e ${po(t)} <--`:`token of type --\x3e ${t.name} <--`} but found --\x3e '${e.image}' <--`,buildNotAllInputParsedMessage:({firstRedundant:t,ruleName:e})=>"Redundant input, expecting EOF but found: "+t.image,buildNoViableAltMessage({expectedPathsPerAlt:t,actual:e,previous:n,customUserDescription:r,ruleName:i}){const o="Expecting: ",s="\nbut found: '"+_i(e).image+"'";if(r)return o+r+s;{const e=pi(t,((t,e)=>t.concat(e)),[]),n=We(e,(t=>`[${We(t,(t=>po(t))).join(", ")}]`));return o+`one of these possible Token sequences:\n${We(n,((t,e)=>`  ${e+1}. ${t}`)).join("\n")}`+s}},buildEarlyExitMessage({expectedIterationPaths:t,actual:e,customUserDescription:n,ruleName:r}){const i="Expecting: ",o="\nbut found: '"+_i(e).image+"'";return n?i+n+o:i+`expecting at least one iteration which starts with one of these possible Token sequences::\n  <${We(t,(t=>`[${We(t,(t=>po(t))).join(",")}]`)).join(" ,")}>`+o}};Object.freeze(Io);const No={buildRuleNotFoundError:(t,e)=>"Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+"<-\ninside top level rule: ->"+t.name+"<-"},ko={buildDuplicateFoundError(t,e){const n=t.name,r=_i(e),i=r.idx,o=kr(r),s=(a=r)instanceof Er?a.terminalType.name:a instanceof sr?a.nonTerminalName:"";var a;let c=`->${o}${i>0?i:""}<- ${s?`with argument: ->${s}<-`:""}\n                  appears more than once (${e.length} times) in the top level rule: ->${n}<-.                  \n                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  `;return c=c.replace(/[ \t]+/g," "),c=c.replace(/\s\s+/g,"\n"),c},buildNamespaceConflictError:t=>`Namespace conflict found in grammar.\nThe grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <${t.name}>.\nTo resolve this make sure each Terminal and Non-Terminal names are unique\nThis is easy to accomplish by using the convention that Terminal names start with an uppercase letter\nand Non-Terminal names start with a lower case letter.`,buildAlternationPrefixAmbiguityError(t){const e=We(t.prefixPath,(t=>po(t))).join(", "),n=0===t.alternation.idx?"":t.alternation.idx;return`Ambiguous alternatives: <${t.ambiguityIndices.join(" ,")}> due to common lookahead prefix\nin <OR${n}> inside <${t.topLevelRule.name}> Rule,\n<${e}> may appears as a prefix path in all these alternatives.\nSee: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\nFor Further details.`},buildAlternationAmbiguityError(t){const e=We(t.prefixPath,(t=>po(t))).join(", "),n=0===t.alternation.idx?"":t.alternation.idx;let r=`Ambiguous Alternatives Detected: <${t.ambiguityIndices.join(" ,")}> in <OR${n}> inside <${t.topLevelRule.name}> Rule,\n<${e}> may appears as a prefix path in all these alternatives.\n`;return r+="See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES\nFor Further details.",r},buildEmptyRepetitionError(t){let e=kr(t.repetition);return 0!==t.repetition.idx&&(e+=t.repetition.idx),`The repetition <${e}> within Rule <${t.topLevelRule.name}> can never consume any tokens.\nThis could lead to an infinite loop.`},buildTokenNameError:t=>"deprecated",buildEmptyAlternationError:t=>`Ambiguous empty alternative: <${t.emptyChoiceIdx+1}> in <OR${t.alternation.idx}> inside <${t.topLevelRule.name}> Rule.\nOnly the last alternative may be an empty alternative.`,buildTooManyAlternativesError:t=>`An Alternation cannot have more than 256 alternatives:\n<OR${t.alternation.idx}> inside <${t.topLevelRule.name}> Rule.\n has ${t.alternation.definition.length+1} alternatives.`,buildLeftRecursionError(t){const e=t.topLevelRule.name;return`Left Recursion found in grammar.\nrule: <${e}> can be invoked from itself (directly or indirectly)\nwithout consuming any Tokens. The grammar path that causes this is: \n ${e} --\x3e ${We(t.leftRecursionPath,(t=>t.name)).concat([e]).join(" --\x3e ")}\n To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`},buildInvalidRuleNameError:t=>"deprecated",buildDuplicateRuleNameError(t){let e;return e=t.topLevelRule instanceof ar?t.topLevelRule.name:t.topLevelRule,`Duplicate definition, rule: ->${e}<- is already defined in the grammar: ->${t.grammarName}<-`}};class xo extends yr{constructor(t,e){super(),this.nameToTopRule=t,this.errMsgProvider=e,this.errors=[]}resolveRefs(){J(tt(this.nameToTopRule),(t=>{this.currTopLevel=t,t.accept(this)}))}visitNonTerminal(t){const e=this.nameToTopRule[t.nonTerminalName];if(e)t.referencedRule=e;else{const e=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,t);this.errors.push({message:e,type:na.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:t.nonTerminalName})}}}const bo=function(t,e){return jr(We(t,e),1)},Co=function(t,e,n,r){for(var i=-1,o=null==t?0:t.length;++i<o;){var s=t[i];e(r,s,n(s),t)}return r},Po=function(t,e,n,r){return X(t,(function(t,i,o){e(r,t,n(t),o)})),r};var Mo=Object.prototype.hasOwnProperty;const wo=(Uo=function(t,e,n){Mo.call(t,n)?t[n].push(e):Xe(t,n,[e])},function(t,e){var n=A(t)?Co:Po,r=Fo?Fo():{};return n(t,Uo,Ke(e),r)});var Uo,Fo;const Do=function(t,e,n){var r=null==t?0:t.length;return r?(e=n||void 0===e?1:$n(e),xn(t,0,(e=r-e)<0?0:e)):[]};class jo extends xr{constructor(t,e){super(),this.topProd=t,this.path=e,this.possibleTokTypes=[],this.nextProductionName="",this.nextProductionOccurrence=0,this.found=!1,this.isAtEndOfPath=!1}startWalking(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Nn(this.path.ruleStack).reverse(),this.occurrenceStack=Nn(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes}walk(t,e=[]){this.found||super.walk(t,e)}walkProdRef(t,e,n){if(t.referencedRule.name===this.nextProductionName&&t.idx===this.nextProductionOccurrence){const r=e.concat(n);this.updateExpectedNext(),this.walk(t.referencedRule,r)}}updateExpectedNext(){Ct(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())}}class $o extends jo{constructor(t,e){super(t,e),this.path=e,this.nextTerminalName="",this.nextTerminalOccurrence=0,this.nextTerminalName=this.path.lastTok.name,this.nextTerminalOccurrence=this.path.lastTokOccurrence}walkTerminal(t,e,n){if(this.isAtEndOfPath&&t.terminalType.name===this.nextTerminalName&&t.idx===this.nextTerminalOccurrence&&!this.found){const t=e.concat(n),r=new cr({definition:t});this.possibleTokTypes=Br(r),this.found=!0}}}class Bo extends xr{constructor(t,e){super(),this.topRule=t,this.occurrence=e,this.result={token:void 0,occurrence:void 0,isEndOfRule:void 0}}startWalking(){return this.walk(this.topRule),this.result}}class Go extends Bo{walkMany(t,e,n){if(t.idx===this.occurrence){const t=_i(e.concat(n));this.result.isEndOfRule=void 0===t,t instanceof Er&&(this.result.token=t.terminalType,this.result.occurrence=t.idx)}else super.walkMany(t,e,n)}}class Ko extends Bo{walkManySep(t,e,n){if(t.idx===this.occurrence){const t=_i(e.concat(n));this.result.isEndOfRule=void 0===t,t instanceof Er&&(this.result.token=t.terminalType,this.result.occurrence=t.idx)}else super.walkManySep(t,e,n)}}class Vo extends Bo{walkAtLeastOne(t,e,n){if(t.idx===this.occurrence){const t=_i(e.concat(n));this.result.isEndOfRule=void 0===t,t instanceof Er&&(this.result.token=t.terminalType,this.result.occurrence=t.idx)}else super.walkAtLeastOne(t,e,n)}}class Wo extends Bo{walkAtLeastOneSep(t,e,n){if(t.idx===this.occurrence){const t=_i(e.concat(n));this.result.isEndOfRule=void 0===t,t instanceof Er&&(this.result.token=t.terminalType,this.result.occurrence=t.idx)}else super.walkAtLeastOneSep(t,e,n)}}function zo(t,e,n=[]){n=Nn(n);let r=[],i=0;function o(o){const s=zo(o.concat(Bn(t,i+1)),e,n);return r.concat(s)}for(;n.length<e&&i<t.length;){const e=t[i];if(e instanceof cr)return o(e.definition);if(e instanceof sr)return o(e.definition);if(e instanceof lr)r=o(e.definition);else{if(e instanceof ur)return o(e.definition.concat([new fr({definition:e.definition})]));if(e instanceof hr)return o([new cr({definition:e.definition}),new fr({definition:[new Er({terminalType:e.separator})].concat(e.definition)})]);if(e instanceof pr){const t=e.definition.concat([new fr({definition:[new Er({terminalType:e.separator})].concat(e.definition)})]);r=o(t)}else if(e instanceof fr){const t=e.definition.concat([new fr({definition:e.definition})]);r=o(t)}else{if(e instanceof dr)return J(e.definition,(t=>{!1===Ct(t.definition)&&(r=o(t.definition))})),r;if(!(e instanceof Er))throw Error("non exhaustive match");n.push(e.terminalType)}}i++}return r.push({partialPath:n,suffixDef:Bn(t,i)}),r}function Ho(t,e,n,r){const i="EXIT_NONE_TERMINAL",o=[i],s="EXIT_ALTERNATIVE";let a=!1;const c=e.length,l=c-r-1,u=[],h=[];for(h.push({idx:-1,def:t,ruleStack:[],occurrenceStack:[]});!Ct(h);){const t=h.pop();if(t===s){a&&Qi(h).idx<=l&&h.pop();continue}const r=t.def,f=t.idx,p=t.ruleStack,d=t.occurrenceStack;if(Ct(r))continue;const E=r[0];if(E===i){const t={idx:f,def:Bn(r),ruleStack:Do(p),occurrenceStack:Do(d)};h.push(t)}else if(E instanceof Er)if(f<c-1){const t=f+1;if(n(e[t],E.terminalType)){const e={idx:t,def:Bn(r),ruleStack:p,occurrenceStack:d};h.push(e)}}else{if(f!==c-1)throw Error("non exhaustive match");u.push({nextTokenType:E.terminalType,nextTokenOccurrence:E.idx,ruleStack:p,occurrenceStack:d}),a=!0}else if(E instanceof sr){const t=Nn(p);t.push(E.nonTerminalName);const e=Nn(d);e.push(E.idx);const n={idx:f,def:E.definition.concat(o,Bn(r)),ruleStack:t,occurrenceStack:e};h.push(n)}else if(E instanceof lr){const t={idx:f,def:Bn(r),ruleStack:p,occurrenceStack:d};h.push(t),h.push(s);const e={idx:f,def:E.definition.concat(Bn(r)),ruleStack:p,occurrenceStack:d};h.push(e)}else if(E instanceof ur){const t=new fr({definition:E.definition,idx:E.idx}),e={idx:f,def:E.definition.concat([t],Bn(r)),ruleStack:p,occurrenceStack:d};h.push(e)}else if(E instanceof hr){const t=new Er({terminalType:E.separator}),e=new fr({definition:[t].concat(E.definition),idx:E.idx}),n={idx:f,def:E.definition.concat([e],Bn(r)),ruleStack:p,occurrenceStack:d};h.push(n)}else if(E instanceof pr){const t={idx:f,def:Bn(r),ruleStack:p,occurrenceStack:d};h.push(t),h.push(s);const e=new Er({terminalType:E.separator}),n=new fr({definition:[e].concat(E.definition),idx:E.idx}),i={idx:f,def:E.definition.concat([n],Bn(r)),ruleStack:p,occurrenceStack:d};h.push(i)}else if(E instanceof fr){const t={idx:f,def:Bn(r),ruleStack:p,occurrenceStack:d};h.push(t),h.push(s);const e=new fr({definition:E.definition,idx:E.idx}),n={idx:f,def:E.definition.concat([e],Bn(r)),ruleStack:p,occurrenceStack:d};h.push(n)}else if(E instanceof dr)for(let t=E.definition.length-1;t>=0;t--){const e={idx:f,def:E.definition[t].definition.concat(Bn(r)),ruleStack:p,occurrenceStack:d};h.push(e),h.push(s)}else if(E instanceof cr)h.push({idx:f,def:E.definition.concat(Bn(r)),ruleStack:p,occurrenceStack:d});else{if(!(E instanceof ar))throw Error("non exhaustive match");h.push(Yo(E,f,p,d))}}return u}function Yo(t,e,n,r){const i=Nn(n);i.push(t.name);const o=Nn(r);return o.push(1),{idx:e,def:t.definition,ruleStack:i,occurrenceStack:o}}var qo;function Xo(t){if(t instanceof lr||"Option"===t)return qo.OPTION;if(t instanceof fr||"Repetition"===t)return qo.REPETITION;if(t instanceof ur||"RepetitionMandatory"===t)return qo.REPETITION_MANDATORY;if(t instanceof hr||"RepetitionMandatoryWithSeparator"===t)return qo.REPETITION_MANDATORY_WITH_SEPARATOR;if(t instanceof pr||"RepetitionWithSeparator"===t)return qo.REPETITION_WITH_SEPARATOR;if(t instanceof dr||"Alternation"===t)return qo.ALTERNATION;throw Error("non exhaustive match")}function Zo(t,e,n,r){const i=t.length,o=Ir(t,(t=>Ir(t,(t=>1===t.length))));if(e)return function(e){const r=We(e,(t=>t.GATE));for(let e=0;e<i;e++){const i=t[e],o=i.length,s=r[e];if(void 0===s||!1!==s.call(this))t:for(let t=0;t<o;t++){const r=i[t],o=r.length;for(let t=0;t<o;t++){const e=this.LA(t+1);if(!1===n(e,r[t]))continue t}return e}}};if(o&&!r){const e=We(t,(t=>$r(t))),n=pi(e,((t,e,n)=>(J(e,(e=>{Ye(t,e.tokenTypeIdx)||(t[e.tokenTypeIdx]=n),J(e.categoryMatches,(e=>{Ye(t,e)||(t[e]=n)}))})),t)),{});return function(){const t=this.LA(1);return n[t.tokenTypeIdx]}}return function(){for(let e=0;e<i;e++){const r=t[e],i=r.length;t:for(let t=0;t<i;t++){const i=r[t],o=i.length;for(let t=0;t<o;t++){const e=this.LA(t+1);if(!1===n(e,i[t]))continue t}return e}}}}function Jo(t,e,n){const r=Ir(t,(t=>1===t.length)),i=t.length;if(r&&!n){const e=$r(t);if(1===e.length&&Ct(e[0].categoryMatches)){const t=e[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===t}}{const t=pi(e,((t,e,n)=>(t[e.tokenTypeIdx]=!0,J(e.categoryMatches,(e=>{t[e]=!0})),t)),[]);return function(){const e=this.LA(1);return!0===t[e.tokenTypeIdx]}}}return function(){t:for(let n=0;n<i;n++){const r=t[n],i=r.length;for(let t=0;t<i;t++){const n=this.LA(t+1);if(!1===e(n,r[t]))continue t}return!0}return!1}}!function(t){t[t.OPTION=0]="OPTION",t[t.REPETITION=1]="REPETITION",t[t.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",t[t.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",t[t.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",t[t.ALTERNATION=5]="ALTERNATION"}(qo||(qo={}));class Qo extends xr{constructor(t,e,n){super(),this.topProd=t,this.targetOccurrence=e,this.targetProdType=n}startWalking(){return this.walk(this.topProd),this.restDef}checkIsTarget(t,e,n,r){return t.idx===this.targetOccurrence&&this.targetProdType===e&&(this.restDef=n.concat(r),!0)}walkOption(t,e,n){this.checkIsTarget(t,qo.OPTION,e,n)||super.walkOption(t,e,n)}walkAtLeastOne(t,e,n){this.checkIsTarget(t,qo.REPETITION_MANDATORY,e,n)||super.walkOption(t,e,n)}walkAtLeastOneSep(t,e,n){this.checkIsTarget(t,qo.REPETITION_MANDATORY_WITH_SEPARATOR,e,n)||super.walkOption(t,e,n)}walkMany(t,e,n){this.checkIsTarget(t,qo.REPETITION,e,n)||super.walkOption(t,e,n)}walkManySep(t,e,n){this.checkIsTarget(t,qo.REPETITION_WITH_SEPARATOR,e,n)||super.walkOption(t,e,n)}}class ts extends yr{constructor(t,e,n){super(),this.targetOccurrence=t,this.targetProdType=e,this.targetRef=n,this.result=[]}checkIsTarget(t,e){t.idx!==this.targetOccurrence||this.targetProdType!==e||void 0!==this.targetRef&&t!==this.targetRef||(this.result=t.definition)}visitOption(t){this.checkIsTarget(t,qo.OPTION)}visitRepetition(t){this.checkIsTarget(t,qo.REPETITION)}visitRepetitionMandatory(t){this.checkIsTarget(t,qo.REPETITION_MANDATORY)}visitRepetitionMandatoryWithSeparator(t){this.checkIsTarget(t,qo.REPETITION_MANDATORY_WITH_SEPARATOR)}visitRepetitionWithSeparator(t){this.checkIsTarget(t,qo.REPETITION_WITH_SEPARATOR)}visitAlternation(t){this.checkIsTarget(t,qo.ALTERNATION)}}function es(t){const e=new Array(t);for(let n=0;n<t;n++)e[n]=[];return e}function ns(t){let e=[""];for(let n=0;n<t.length;n++){const r=t[n],i=[];for(let t=0;t<e.length;t++){const n=e[t];i.push(n+"_"+r.tokenTypeIdx);for(let t=0;t<r.categoryMatches.length;t++){const e="_"+r.categoryMatches[t];i.push(n+e)}}e=i}return e}function rs(t,e,n){for(let r=0;r<t.length;r++){if(r===n)continue;const i=t[r];for(let t=0;t<e.length;t++)if(!0===i[e[t]])return!1}return!0}function is(t,e){const n=We(t,(t=>zo([t],1))),r=es(n.length),i=We(n,(t=>{const e={};return J(t,(t=>{const n=ns(t.partialPath);J(n,(t=>{e[t]=!0}))})),e}));let o=n;for(let t=1;t<=e;t++){const n=o;o=es(n.length);for(let s=0;s<n.length;s++){const a=n[s];for(let n=0;n<a.length;n++){const c=a[n].partialPath,l=a[n].suffixDef,u=ns(c);if(rs(i,u,s)||Ct(l)||c.length===e){const t=r[s];if(!1===as(t,c)){t.push(c);for(let t=0;t<u.length;t++){const e=u[t];i[s][e]=!0}}}else{const e=zo(l,t+1,c);o[s]=o[s].concat(e),J(e,(t=>{const e=ns(t.partialPath);J(e,(t=>{i[s][t]=!0}))}))}}}}return r}function os(t,e,n,r){const i=new ts(t,qo.ALTERNATION,r);return e.accept(i),is(i.result,n)}function ss(t,e,n,r){const i=new ts(t,n);e.accept(i);const o=i.result,s=new Qo(e,t,n).startWalking();return is([new cr({definition:o}),new cr({definition:s})],r)}function as(t,e){t:for(let n=0;n<t.length;n++){const r=t[n];if(r.length===e.length){for(let t=0;t<r.length;t++){const n=e[t],i=r[t];if(!1==(n===i||void 0!==i.categoryMatchesMap[n.tokenTypeIdx]))continue t}return!0}}return!1}function cs(t){return Ir(t,(t=>Ir(t,(t=>Ir(t,(t=>Ct(t.categoryMatches)))))))}function ls(t){return`${kr(t)}_#_${t.idx}_#_${us(t)}`}function us(t){return t instanceof Er?t.terminalType.name:t instanceof sr?t.nonTerminalName:""}class hs extends yr{constructor(){super(...arguments),this.allProductions=[]}visitNonTerminal(t){this.allProductions.push(t)}visitOption(t){this.allProductions.push(t)}visitRepetitionWithSeparator(t){this.allProductions.push(t)}visitRepetitionMandatory(t){this.allProductions.push(t)}visitRepetitionMandatoryWithSeparator(t){this.allProductions.push(t)}visitRepetition(t){this.allProductions.push(t)}visitAlternation(t){this.allProductions.push(t)}visitTerminal(t){this.allProductions.push(t)}}function fs(t,e,n,r=[]){const i=[],o=ps(e.definition);if(Ct(o))return[];{const e=t.name;Or(o,t)&&i.push({message:n.buildLeftRecursionError({topLevelRule:t,leftRecursionPath:r}),type:na.LEFT_RECURSION,ruleName:e});const s=mi(o,r.concat([t])),a=bo(s,(e=>{const i=Nn(r);return i.push(e),fs(t,e,n,i)}));return i.concat(a)}}function ps(t){let e=[];if(Ct(t))return e;const n=_i(t);if(n instanceof sr)e.push(n.referencedRule);else if(n instanceof cr||n instanceof lr||n instanceof ur||n instanceof hr||n instanceof pr||n instanceof fr)e=e.concat(ps(n.definition));else if(n instanceof dr)e=$r(We(n.definition,(t=>ps(t.definition))));else if(!(n instanceof Er))throw Error("non exhaustive match");const r=Nr(n),i=t.length>1;if(r&&i){const n=Bn(t);return e.concat(ps(n))}return e}class ds extends yr{constructor(){super(...arguments),this.alternations=[]}visitAlternation(t){this.alternations.push(t)}}class Es extends yr{constructor(){super(...arguments),this.allProductions=[]}visitRepetitionWithSeparator(t){this.allProductions.push(t)}visitRepetitionMandatory(t){this.allProductions.push(t)}visitRepetitionMandatoryWithSeparator(t){this.allProductions.push(t)}visitRepetition(t){this.allProductions.push(t)}}const ms="MismatchedTokenException",ys="NoViableAltException",_s="EarlyExitException",gs="NotAllInputParsedException",Ts=[ms,ys,_s,gs];function vs(t){return Or(Ts,t.name)}Object.freeze(Ts);class As extends Error{constructor(t,e){super(t),this.token=e,this.resyncedTokens=[],Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class Rs extends As{constructor(t,e,n){super(t,e),this.previousToken=n,this.name=ms}}class Os extends As{constructor(t,e,n){super(t,e),this.previousToken=n,this.name=ys}}class Ss extends As{constructor(t,e){super(t,e),this.name=gs}}class Ls extends As{constructor(t,e,n){super(t,e),this.previousToken=n,this.name=_s}}const Is={},Ns="InRuleRecoveryException";class ks extends Error{constructor(t){super(t),this.name=Ns}}function xs(t,e,n,r,i,o,s){const a=this.getKeyForAutomaticLookahead(r,i);let c=this.firstAfterRepMap[a];if(void 0===c){const t=this.getCurrRuleFullName();c=new o(this.getGAstProductions()[t],i).startWalking(),this.firstAfterRepMap[a]=c}let l=c.token,u=c.occurrence;const h=c.isEndOfRule;1===this.RULE_STACK.length&&h&&void 0===l&&(l=So,u=1),void 0!==l&&void 0!==u&&this.shouldInRepetitionRecoveryBeTried(l,u,s)&&this.tryInRepetitionRecovery(t,e,n,l)}const bs=1024,Cs=1280,Ps=1536;function Ms(t,e,n){return n|e|t}class ws{constructor(t){var e;this.maxLookahead=null!==(e=null==t?void 0:t.maxLookahead)&&void 0!==e?e:ta.maxLookahead}validate(t){const e=this.validateNoLeftRecursion(t.rules);if(Ct(e)){const n=this.validateEmptyOrAlternatives(t.rules),r=this.validateAmbiguousAlternationAlternatives(t.rules,this.maxLookahead),i=this.validateSomeNonEmptyLookaheadPath(t.rules,this.maxLookahead);return[...e,...n,...r,...i]}return e}validateNoLeftRecursion(t){return bo(t,(t=>fs(t,t,ko)))}validateEmptyOrAlternatives(t){return bo(t,(t=>function(t,e){const n=new ds;t.accept(n);const r=n.alternations;return bo(r,(n=>{const r=Do(n.definition);return bo(r,((r,i)=>{const o=Ho([r],[],eo,1);return Ct(o)?[{message:e.buildEmptyAlternationError({topLevelRule:t,alternation:n,emptyChoiceIdx:i}),type:na.NONE_LAST_EMPTY_ALT,ruleName:t.name,occurrence:n.idx,alternative:i+1}]:[]}))}))}(t,ko)))}validateAmbiguousAlternationAlternatives(t,e){return bo(t,(t=>function(t,e,n){const r=new ds;t.accept(r);let i=r.alternations;i=ci(i,(t=>!0===t.ignoreAmbiguities));const o=bo(i,(r=>{const i=r.idx,o=r.maxLookahead||e,s=os(i,t,o,r),a=function(t,e,n,r){const i=[],o=pi(t,((n,r,o)=>(!0===e.definition[o].ignoreAmbiguities||J(r,(r=>{const s=[o];J(t,((t,n)=>{o!==n&&as(t,r)&&!0!==e.definition[n].ignoreAmbiguities&&s.push(n)})),s.length>1&&!as(i,r)&&(i.push(r),n.push({alts:s,path:r}))})),n)),[]);return We(o,(t=>{const i=We(t.alts,(t=>t+1));return{message:r.buildAlternationAmbiguityError({topLevelRule:n,alternation:e,ambiguityIndices:i,prefixPath:t.path}),type:na.AMBIGUOUS_ALTS,ruleName:n.name,occurrence:e.idx,alternatives:t.alts}}))}(s,r,t,n),c=function(t,e,n,r){const i=pi(t,((t,e,n)=>{const r=We(e,(t=>({idx:n,path:t})));return t.concat(r)}),[]);return yi(bo(i,(t=>{if(!0===e.definition[t.idx].ignoreAmbiguities)return[];const o=t.idx,s=t.path,a=di(i,(t=>{return!0!==e.definition[t.idx].ignoreAmbiguities&&t.idx<o&&(n=t.path,r=s,n.length<r.length&&Ir(n,((t,e)=>{const n=r[e];return t===n||n.categoryMatchesMap[t.tokenTypeIdx]})));var n,r}));return We(a,(t=>{const i=[t.idx+1,o+1],s=0===e.idx?"":e.idx;return{message:r.buildAlternationPrefixAmbiguityError({topLevelRule:n,alternation:e,ambiguityIndices:i,prefixPath:t.path}),type:na.AMBIGUOUS_PREFIX_ALTS,ruleName:n.name,occurrence:s,alternatives:i}}))})))}(s,r,t,n);return a.concat(c)}));return o}(t,e,ko)))}validateSomeNonEmptyLookaheadPath(t,e){return function(t,e,n){const r=[];return J(t,(t=>{const i=new Es;t.accept(i);const o=i.allProductions;J(o,(i=>{const o=Xo(i),s=i.maxLookahead||e,a=ss(i.idx,t,o,s)[0];if(Ct($r(a))){const e=n.buildEmptyRepetitionError({topLevelRule:t,repetition:i});r.push({message:e,type:na.NO_NON_EMPTY_LOOKAHEAD,ruleName:t.name})}}))})),r}(t,e,ko)}buildLookaheadForAlternation(t){return function(t,e,n,r,i,o){const s=os(t,e,n);return o(s,r,cs(s)?no:eo,i)}(t.prodOccurrence,t.rule,t.maxLookahead,t.hasPredicates,t.dynamicTokensEnabled,Zo)}buildLookaheadForOptional(t){return function(t,e,n,r,i,o){const s=ss(t,e,i,n),a=cs(s)?no:eo;return o(s[0],a,r)}(t.prodOccurrence,t.rule,t.maxLookahead,t.dynamicTokensEnabled,Xo(t.prodType),Jo)}}const Us=new class extends yr{constructor(){super(...arguments),this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}reset(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}visitOption(t){this.dslMethods.option.push(t)}visitRepetitionWithSeparator(t){this.dslMethods.repetitionWithSeparator.push(t)}visitRepetitionMandatory(t){this.dslMethods.repetitionMandatory.push(t)}visitRepetitionMandatoryWithSeparator(t){this.dslMethods.repetitionMandatoryWithSeparator.push(t)}visitRepetition(t){this.dslMethods.repetition.push(t)}visitAlternation(t){this.dslMethods.alternation.push(t)}};function Fs(t,e){!0===isNaN(t.startOffset)?(t.startOffset=e.startOffset,t.endOffset=e.endOffset):t.endOffset<e.endOffset==1&&(t.endOffset=e.endOffset)}function Ds(t,e){!0===isNaN(t.startOffset)?(t.startOffset=e.startOffset,t.startColumn=e.startColumn,t.startLine=e.startLine,t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine):t.endOffset<e.endOffset==1&&(t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine)}const js="name";function $s(t,e){Object.defineProperty(t,js,{enumerable:!1,configurable:!0,writable:!1,value:e})}function Bs(t,e){const n=q(t),r=n.length;for(let i=0;i<r;i++){const r=t[n[i]],o=r.length;for(let t=0;t<o;t++){const n=r[t];void 0===n.tokenTypeIdx&&this[n.name](n.children,e)}}}var Gs;!function(t){t[t.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",t[t.MISSING_METHOD=1]="MISSING_METHOD"}(Gs||(Gs={}));const Ks={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(Ks);const Vs=!0,Ws=Math.pow(2,8)-1,zs=Oo({name:"RECORDING_PHASE_TOKEN",pattern:fo.NA});oo([zs]);const Hs=Lo(zs,"This IToken indicates the Parser is in Recording Phase\n\tSee: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details",-1,-1,-1,-1,-1,-1);Object.freeze(Hs);const Ys={name:"This CSTNode indicates the Parser is in Recording Phase\n\tSee: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details",children:{}};function qs(t,e,n,r=!1){Js(n);const i=Qi(this.recordingProdStack),o=H(e)?e:e.DEF,s=new t({definition:[],idx:n});return r&&(s.separator=e.SEP),Ye(e,"MAX_LOOKAHEAD")&&(s.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(s),o.call(this),i.definition.push(s),this.recordingProdStack.pop(),Ks}function Xs(t,e){Js(e);const n=Qi(this.recordingProdStack),r=!1===A(t),i=!1===r?t:t.DEF,o=new dr({definition:[],idx:e,ignoreAmbiguities:r&&!0===t.IGNORE_AMBIGUITIES});Ye(t,"MAX_LOOKAHEAD")&&(o.maxLookahead=t.MAX_LOOKAHEAD);const s=gr(i,(t=>H(t.GATE)));return o.hasPredicates=s,n.definition.push(o),J(i,(t=>{const e=new cr({definition:[]});o.definition.push(e),Ye(t,"IGNORE_AMBIGUITIES")?e.ignoreAmbiguities=t.IGNORE_AMBIGUITIES:Ye(t,"GATE")&&(e.ignoreAmbiguities=!0),this.recordingProdStack.push(e),t.ALT.call(this),this.recordingProdStack.pop()})),Ks}function Zs(t){return 0===t?"":`${t}`}function Js(t){if(t<0||t>Ws){const e=new Error(`Invalid DSL Method idx value: <${t}>\n\tIdx value must be a none negative value smaller than ${Ws+1}`);throw e.KNOWN_RECORDER_ERROR=!0,e}}const Qs=Lo(So,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(Qs);const ta=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:Io,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),ea=Object.freeze({recoveryValueFunc:()=>{},resyncEnabled:!0});var na,ra;!function(t){t[t.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",t[t.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",t[t.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",t[t.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",t[t.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",t[t.LEFT_RECURSION=5]="LEFT_RECURSION",t[t.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",t[t.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",t[t.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",t[t.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",t[t.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",t[t.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",t[t.TOO_MANY_ALTS=12]="TOO_MANY_ALTS",t[t.CUSTOM_LOOKAHEAD_VALIDATION=13]="CUSTOM_LOOKAHEAD_VALIDATION"}(na||(na={}));class ia{static performSelfAnalysis(t){throw Error("The **static** `performSelfAnalysis` method has been deprecated.\t\nUse the **instance** method with the same name instead.")}performSelfAnalysis(){this.TRACE_INIT("performSelfAnalysis",(()=>{let t;this.selfAnalysisDone=!0;const e=this.className;this.TRACE_INIT("toFastProps",(()=>{kn(this)})),this.TRACE_INIT("Grammar Recording",(()=>{try{this.enableRecording(),J(this.definedRulesNames,(t=>{const e=this[t].originalGrammarAction;let n;this.TRACE_INIT(`${t} Rule`,(()=>{n=this.topLevelRuleRecord(t,e)})),this.gastProductionsCache[t]=n}))}finally{this.disableRecording()}}));let n=[];if(this.TRACE_INIT("Grammar Resolving",(()=>{n=function(t){const e=si(t,{errMsgProvider:No}),n={};return J(t.rules,(t=>{n[t.name]=t})),function(t,e){const n=new xo(t,e);return n.resolveRefs(),n.errors}(n,e.errMsgProvider)}({rules:tt(this.gastProductionsCache)}),this.definitionErrors=this.definitionErrors.concat(n)})),this.TRACE_INIT("Grammar Validations",(()=>{if(Ct(n)&&!1===this.skipValidations){const n=(t={rules:tt(this.gastProductionsCache),tokenTypes:tt(this.tokensMap),errMsgProvider:ko,grammarName:e},function(t,e,n,r){const i=bo(t,(t=>function(t,e){const n=new hs;t.accept(n);const r=n.allProductions,i=wo(r,ls),o=nr(i,(t=>t.length>1));return We(tt(o),(n=>{const r=_i(n),i=e.buildDuplicateFoundError(t,n),o=kr(r),s={message:i,type:na.DUPLICATE_PRODUCTIONS,ruleName:t.name,dslName:o,occurrence:r.idx},a=us(r);return a&&(s.parameter=a),s}))}(t,n))),o=function(t,e,n){const r=[],i=We(e,(t=>t.name));return J(t,(t=>{const e=t.name;if(Or(i,e)){const i=n.buildNamespaceConflictError(t);r.push({message:i,type:na.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:e})}})),r}(t,e,n),s=bo(t,(t=>function(t,e){const n=new ds;t.accept(n);const r=n.alternations;return bo(r,(n=>n.definition.length>255?[{message:e.buildTooManyAlternativesError({topLevelRule:t,alternation:n}),type:na.TOO_MANY_ALTS,ruleName:t.name,occurrence:n.idx}]:[]))}(t,n))),a=bo(t,(e=>function(t,e,n,r){const i=[],o=pi(e,((e,n)=>n.name===t.name?e+1:e),0);if(o>1){const e=r.buildDuplicateRuleNameError({topLevelRule:t,grammarName:n});i.push({message:e,type:na.DUPLICATE_RULE_NAME,ruleName:t.name})}return i}(e,t,r,n)));return i.concat(o,s,a)}((t=si(t,{errMsgProvider:ko})).rules,t.tokenTypes,t.errMsgProvider,t.grammarName)),r=function(t){const e=t.lookaheadStrategy.validate({rules:t.rules,tokenTypes:t.tokenTypes,grammarName:t.grammarName});return We(e,(t=>Object.assign({type:na.CUSTOM_LOOKAHEAD_VALIDATION},t)))}({lookaheadStrategy:this.lookaheadStrategy,rules:tt(this.gastProductionsCache),tokenTypes:tt(this.tokensMap),grammarName:e});this.definitionErrors=this.definitionErrors.concat(n,r)}var t})),Ct(this.definitionErrors)&&(this.recoveryEnabled&&this.TRACE_INIT("computeAllProdsFollows",(()=>{const t=function(t){const e={};return J(t,(t=>{const n=new Kr(t).startWalking();Qn(e,n)})),e}(tt(this.gastProductionsCache));this.resyncFollows=t})),this.TRACE_INIT("ComputeLookaheadFunctions",(()=>{var t,e;null===(e=(t=this.lookaheadStrategy).initialize)||void 0===e||e.call(t,{rules:tt(this.gastProductionsCache)}),this.preComputeLookaheadFunctions(tt(this.gastProductionsCache))}))),!ia.DEFER_DEFINITION_ERRORS_HANDLING&&!Ct(this.definitionErrors))throw t=We(this.definitionErrors,(t=>t.message)),new Error(`Parser Definition Errors detected:\n ${t.join("\n-------------------------------\n")}`)}))}constructor(t,e){this.definitionErrors=[],this.selfAnalysisDone=!1;const n=this;if(n.initErrorHandler(e),n.initLexerAdapter(),n.initLooksAhead(e),n.initRecognizerEngine(t,e),n.initRecoverable(e),n.initTreeBuilder(e),n.initContentAssist(),n.initGastRecorder(e),n.initPerformanceTracer(e),Ye(e,"ignoredIssues"))throw new Error("The <ignoredIssues> IParserConfig property has been deprecated.\n\tPlease use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.\n\tSee: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES\n\tFor further details.");this.skipValidations=Ye(e,"skipValidations")?e.skipValidations:ta.skipValidations}}ia.DEFER_DEFINITION_ERRORS_HANDLING=!1,ra=ia,[class{initRecoverable(t){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=Ye(t,"recoveryEnabled")?t.recoveryEnabled:ta.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=xs)}getTokenToInsert(t){const e=Lo(t,"",NaN,NaN,NaN,NaN,NaN,NaN);return e.isInsertedInRecovery=!0,e}canTokenTypeBeInsertedInRecovery(t){return!0}canTokenTypeBeDeletedInRecovery(t){return!0}tryInRepetitionRecovery(t,e,n,r){const i=this.findReSyncTokenType(),o=this.exportLexerState(),s=[];let a=!1;const c=this.LA(1);let l=this.LA(1);const u=()=>{const t=this.LA(0),e=this.errorMessageProvider.buildMismatchTokenMessage({expected:r,actual:c,previous:t,ruleName:this.getCurrRuleFullName()}),n=new Rs(e,c,this.LA(0));n.resyncedTokens=Do(s),this.SAVE_ERROR(n)};for(;!a;){if(this.tokenMatcher(l,r))return void u();if(n.call(this))return u(),void t.apply(this,e);this.tokenMatcher(l,i)?a=!0:(l=this.SKIP_TOKEN(),this.addToResyncTokens(l,s))}this.importLexerState(o)}shouldInRepetitionRecoveryBeTried(t,e,n){return!1!==n&&!this.tokenMatcher(this.LA(1),t)&&!this.isBackTracking()&&!this.canPerformInRuleRecovery(t,this.getFollowsForInRuleRecovery(t,e))}getFollowsForInRuleRecovery(t,e){const n=this.getCurrentGrammarPath(t,e);return this.getNextPossibleTokenTypes(n)}tryInRuleRecovery(t,e){if(this.canRecoverWithSingleTokenInsertion(t,e))return this.getTokenToInsert(t);if(this.canRecoverWithSingleTokenDeletion(t)){const t=this.SKIP_TOKEN();return this.consumeToken(),t}throw new ks("sad sad panda")}canPerformInRuleRecovery(t,e){return this.canRecoverWithSingleTokenInsertion(t,e)||this.canRecoverWithSingleTokenDeletion(t)}canRecoverWithSingleTokenInsertion(t,e){if(!this.canTokenTypeBeInsertedInRecovery(t))return!1;if(Ct(e))return!1;const n=this.LA(1);return void 0!==Ti(e,(t=>this.tokenMatcher(n,t)))}canRecoverWithSingleTokenDeletion(t){return!!this.canTokenTypeBeDeletedInRecovery(t)&&this.tokenMatcher(this.LA(2),t)}isInCurrentRuleReSyncSet(t){const e=this.getCurrFollowKey(),n=this.getFollowSetFromFollowKey(e);return Or(n,t)}findReSyncTokenType(){const t=this.flattenFollowSet();let e=this.LA(1),n=2;for(;;){const r=Ti(t,(t=>eo(e,t)));if(void 0!==r)return r;e=this.LA(n),n++}}getCurrFollowKey(){if(1===this.RULE_STACK.length)return Is;const t=this.getLastExplicitRuleShortName(),e=this.getLastExplicitRuleOccurrenceIndex(),n=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(t),idxInCallingRule:e,inRule:this.shortRuleNameToFullName(n)}}buildFullFollowKeyStack(){const t=this.RULE_STACK,e=this.RULE_OCCURRENCE_STACK;return We(t,((n,r)=>0===r?Is:{ruleName:this.shortRuleNameToFullName(n),idxInCallingRule:e[r],inRule:this.shortRuleNameToFullName(t[r-1])}))}flattenFollowSet(){const t=We(this.buildFullFollowKeyStack(),(t=>this.getFollowSetFromFollowKey(t)));return $r(t)}getFollowSetFromFollowKey(t){if(t===Is)return[So];const e=t.ruleName+t.idxInCallingRule+Gr+t.inRule;return this.resyncFollows[e]}addToResyncTokens(t,e){return this.tokenMatcher(t,So)||e.push(t),e}reSyncTo(t){const e=[];let n=this.LA(1);for(;!1===this.tokenMatcher(n,t);)n=this.SKIP_TOKEN(),this.addToResyncTokens(n,e);return Do(e)}attemptInRepetitionRecovery(t,e,n,r,i,o,s){}getCurrentGrammarPath(t,e){return{ruleStack:this.getHumanReadableRuleStack(),occurrenceStack:Nn(this.RULE_OCCURRENCE_STACK),lastTok:t,lastTokOccurrence:e}}getHumanReadableRuleStack(){return We(this.RULE_STACK,(t=>this.shortRuleNameToFullName(t)))}},class{initLooksAhead(t){this.dynamicTokensEnabled=Ye(t,"dynamicTokensEnabled")?t.dynamicTokensEnabled:ta.dynamicTokensEnabled,this.maxLookahead=Ye(t,"maxLookahead")?t.maxLookahead:ta.maxLookahead,this.lookaheadStrategy=Ye(t,"lookaheadStrategy")?t.lookaheadStrategy:new ws({maxLookahead:this.maxLookahead}),this.lookAheadFuncsCache=new Map}preComputeLookaheadFunctions(t){J(t,(t=>{this.TRACE_INIT(`${t.name} Rule Lookahead`,(()=>{const{alternation:e,repetition:n,option:r,repetitionMandatory:i,repetitionMandatoryWithSeparator:o,repetitionWithSeparator:s}=function(t){Us.reset(),t.accept(Us);const e=Us.dslMethods;return Us.reset(),e}(t);J(e,(e=>{const n=0===e.idx?"":e.idx;this.TRACE_INIT(`${kr(e)}${n}`,(()=>{const n=this.lookaheadStrategy.buildLookaheadForAlternation({prodOccurrence:e.idx,rule:t,maxLookahead:e.maxLookahead||this.maxLookahead,hasPredicates:e.hasPredicates,dynamicTokensEnabled:this.dynamicTokensEnabled}),r=Ms(this.fullRuleNameToShort[t.name],256,e.idx);this.setLaFuncCache(r,n)}))})),J(n,(e=>{this.computeLookaheadFunc(t,e.idx,768,"Repetition",e.maxLookahead,kr(e))})),J(r,(e=>{this.computeLookaheadFunc(t,e.idx,512,"Option",e.maxLookahead,kr(e))})),J(i,(e=>{this.computeLookaheadFunc(t,e.idx,bs,"RepetitionMandatory",e.maxLookahead,kr(e))})),J(o,(e=>{this.computeLookaheadFunc(t,e.idx,Ps,"RepetitionMandatoryWithSeparator",e.maxLookahead,kr(e))})),J(s,(e=>{this.computeLookaheadFunc(t,e.idx,Cs,"RepetitionWithSeparator",e.maxLookahead,kr(e))}))}))}))}computeLookaheadFunc(t,e,n,r,i,o){this.TRACE_INIT(`${o}${0===e?"":e}`,(()=>{const o=this.lookaheadStrategy.buildLookaheadForOptional({prodOccurrence:e,rule:t,maxLookahead:i||this.maxLookahead,dynamicTokensEnabled:this.dynamicTokensEnabled,prodType:r}),s=Ms(this.fullRuleNameToShort[t.name],n,e);this.setLaFuncCache(s,o)}))}getKeyForAutomaticLookahead(t,e){return Ms(this.getLastExplicitRuleShortName(),t,e)}getLaFuncFromCache(t){return this.lookAheadFuncsCache.get(t)}setLaFuncCache(t,e){this.lookAheadFuncsCache.set(t,e)}},class{initTreeBuilder(t){if(this.CST_STACK=[],this.outputCst=t.outputCst,this.nodeLocationTracking=Ye(t,"nodeLocationTracking")?t.nodeLocationTracking:ta.nodeLocationTracking,this.outputCst)if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Ds,this.setNodeLocationFromNode=Ds,this.cstPostRule=Mr,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=Mr,this.setNodeLocationFromNode=Mr,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Fs,this.setNodeLocationFromNode=Fs,this.cstPostRule=Mr,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=Mr,this.setNodeLocationFromNode=Mr,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else{if(!/none/i.test(this.nodeLocationTracking))throw Error(`Invalid <nodeLocationTracking> config option: "${t.nodeLocationTracking}"`);this.setNodeLocationFromToken=Mr,this.setNodeLocationFromNode=Mr,this.cstPostRule=Mr,this.setInitialNodeLocation=Mr}else this.cstInvocationStateUpdate=Mr,this.cstFinallyStateUpdate=Mr,this.cstPostTerminal=Mr,this.cstPostNonTerminal=Mr,this.cstPostRule=Mr}setInitialNodeLocationOnlyOffsetRecovery(t){t.location={startOffset:NaN,endOffset:NaN}}setInitialNodeLocationOnlyOffsetRegular(t){t.location={startOffset:this.LA(1).startOffset,endOffset:NaN}}setInitialNodeLocationFullRecovery(t){t.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}}setInitialNodeLocationFullRegular(t){const e=this.LA(1);t.location={startOffset:e.startOffset,startLine:e.startLine,startColumn:e.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}}cstInvocationStateUpdate(t){const e={name:t,children:Object.create(null)};this.setInitialNodeLocation(e),this.CST_STACK.push(e)}cstFinallyStateUpdate(){this.CST_STACK.pop()}cstPostRuleFull(t){const e=this.LA(0),n=t.location;n.startOffset<=e.startOffset==1?(n.endOffset=e.endOffset,n.endLine=e.endLine,n.endColumn=e.endColumn):(n.startOffset=NaN,n.startLine=NaN,n.startColumn=NaN)}cstPostRuleOnlyOffset(t){const e=this.LA(0),n=t.location;n.startOffset<=e.startOffset==1?n.endOffset=e.endOffset:n.startOffset=NaN}cstPostTerminal(t,e){const n=this.CST_STACK[this.CST_STACK.length-1];var r,i,o;i=e,o=t,void 0===(r=n).children[o]?r.children[o]=[i]:r.children[o].push(i),this.setNodeLocationFromToken(n.location,e)}cstPostNonTerminal(t,e){const n=this.CST_STACK[this.CST_STACK.length-1];!function(t,e,n){void 0===t.children[e]?t.children[e]=[n]:t.children[e].push(n)}(n,e,t),this.setNodeLocationFromNode(n.location,t.location)}getBaseCstVisitorConstructor(){if(Vr(this.baseCstVisitorConstructor)){const t=function(t,e){const n=function(){};$s(n,t+"BaseSemantics");const r={visit:function(t,e){if(A(t)&&(t=t[0]),!Vr(t))return this[t.name](t.children,e)},validateVisitor:function(){const t=function(t,e){const n=function(t,e){const n=di(e,(e=>!1===H(t[e]))),r=We(n,(e=>({msg:`Missing visitor method: <${e}> on ${t.constructor.name} CST Visitor.`,type:Gs.MISSING_METHOD,methodName:e})));return yi(r)}(t,e);return n}(this,e);if(!Ct(t)){const e=We(t,(t=>t.msg));throw Error(`Errors Detected in CST Visitor <${this.constructor.name}>:\n\t${e.join("\n\n").replace(/\n/g,"\n\t")}`)}}};return(n.prototype=r).constructor=n,n._RULE_NAMES=e,n}(this.className,q(this.gastProductionsCache));return this.baseCstVisitorConstructor=t,t}return this.baseCstVisitorConstructor}getBaseCstVisitorConstructorWithDefaults(){if(Vr(this.baseCstVisitorWithDefaultsConstructor)){const t=function(t,e,n){const r=function(){};$s(r,t+"BaseSemanticsWithDefaults");const i=Object.create(n.prototype);return J(e,(t=>{i[t]=Bs})),(r.prototype=i).constructor=r,r}(this.className,q(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=t,t}return this.baseCstVisitorWithDefaultsConstructor}getLastExplicitRuleShortName(){const t=this.RULE_STACK;return t[t.length-1]}getPreviousExplicitRuleShortName(){const t=this.RULE_STACK;return t[t.length-2]}getLastExplicitRuleOccurrenceIndex(){const t=this.RULE_OCCURRENCE_STACK;return t[t.length-1]}},class{initLexerAdapter(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1}set input(t){if(!0!==this.selfAnalysisDone)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=t,this.tokVectorLength=t.length}get input(){return this.tokVector}SKIP_TOKEN(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):Qs}LA(t){const e=this.currIdx+t;return e<0||this.tokVectorLength<=e?Qs:this.tokVector[e]}consumeToken(){this.currIdx++}exportLexerState(){return this.currIdx}importLexerState(t){this.currIdx=t}resetLexerState(){this.currIdx=-1}moveToTerminatedState(){this.currIdx=this.tokVector.length-1}getLexerPosition(){return this.exportLexerState()}},class{initRecognizerEngine(t,e){if(this.className=this.constructor.name,this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=no,this.subruleIdx=0,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},Ye(e,"serializedGrammar"))throw Error("The Parser's configuration can no longer contain a <serializedGrammar> property.\n\tSee: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0\n\tFor Further details.");if(A(t)){if(Ct(t))throw Error("A Token Vocabulary cannot be empty.\n\tNote that the first argument for the parser constructor\n\tis no longer a Token vector (since v4.0).");if("number"==typeof t[0].startOffset)throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n\tSee: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0\n\tFor Further details.")}if(A(t))this.tokensMap=pi(t,((t,e)=>(t[e.name]=e,t)),{});else if(Ye(t,"modes")&&Ir($r(tt(t.modes)),lo)){const e=$r(tt(t.modes)),n=Ur(e);this.tokensMap=pi(n,((t,e)=>(t[e.name]=e,t)),{})}else{if(!z(t))throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap=Nn(t)}this.tokensMap.EOF=So;const n=Ye(t,"modes")?$r(tt(t.modes)):tt(t),r=Ir(n,(t=>Ct(t.categoryMatches)));this.tokenMatcher=r?no:eo,oo(tt(this.tokensMap))}defineRule(t,e,n){if(this.selfAnalysisDone)throw Error(`Grammar rule <${t}> may not be defined after the 'performSelfAnalysis' method has been called'\nMake sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);const r=Ye(n,"resyncEnabled")?n.resyncEnabled:ea.resyncEnabled,i=Ye(n,"recoveryValueFunc")?n.recoveryValueFunc:ea.recoveryValueFunc,o=this.ruleShortNameIdx<<12;let s;return this.ruleShortNameIdx++,this.shortRuleNameToFull[o]=t,this.fullRuleNameToShort[t]=o,s=!0===this.outputCst?function(...n){try{this.ruleInvocationStateUpdate(o,t,this.subruleIdx),e.apply(this,n);const r=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(r),r}catch(t){return this.invokeRuleCatch(t,r,i)}finally{this.ruleFinallyStateUpdate()}}:function(...n){try{return this.ruleInvocationStateUpdate(o,t,this.subruleIdx),e.apply(this,n)}catch(t){return this.invokeRuleCatch(t,r,i)}finally{this.ruleFinallyStateUpdate()}},Object.assign(s,{ruleName:t,originalGrammarAction:e})}invokeRuleCatch(t,e,n){const r=1===this.RULE_STACK.length,i=e&&!this.isBackTracking()&&this.recoveryEnabled;if(vs(t)){const e=t;if(i){const r=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(r)){if(e.resyncedTokens=this.reSyncTo(r),this.outputCst){const t=this.CST_STACK[this.CST_STACK.length-1];return t.recoveredNode=!0,t}return n(t)}if(this.outputCst){const t=this.CST_STACK[this.CST_STACK.length-1];t.recoveredNode=!0,e.partialCstResult=t}throw e}if(r)return this.moveToTerminatedState(),n(t);throw e}throw t}optionInternal(t,e){const n=this.getKeyForAutomaticLookahead(512,e);return this.optionInternalLogic(t,e,n)}optionInternalLogic(t,e,n){let r,i=this.getLaFuncFromCache(n);if("function"!=typeof t){r=t.DEF;const e=t.GATE;if(void 0!==e){const t=i;i=()=>e.call(this)&&t.call(this)}}else r=t;if(!0===i.call(this))return r.call(this)}atLeastOneInternal(t,e){const n=this.getKeyForAutomaticLookahead(bs,t);return this.atLeastOneInternalLogic(t,e,n)}atLeastOneInternalLogic(t,e,n){let r,i=this.getLaFuncFromCache(n);if("function"!=typeof e){r=e.DEF;const t=e.GATE;if(void 0!==t){const e=i;i=()=>t.call(this)&&e.call(this)}}else r=e;if(!0!==i.call(this))throw this.raiseEarlyExitException(t,qo.REPETITION_MANDATORY,e.ERR_MSG);{let t=this.doSingleRepetition(r);for(;!0===i.call(this)&&!0===t;)t=this.doSingleRepetition(r)}this.attemptInRepetitionRecovery(this.atLeastOneInternal,[t,e],i,bs,t,Vo)}atLeastOneSepFirstInternal(t,e){const n=this.getKeyForAutomaticLookahead(Ps,t);this.atLeastOneSepFirstInternalLogic(t,e,n)}atLeastOneSepFirstInternalLogic(t,e,n){const r=e.DEF,i=e.SEP;if(!0!==this.getLaFuncFromCache(n).call(this))throw this.raiseEarlyExitException(t,qo.REPETITION_MANDATORY_WITH_SEPARATOR,e.ERR_MSG);{r.call(this);const e=()=>this.tokenMatcher(this.LA(1),i);for(;!0===this.tokenMatcher(this.LA(1),i);)this.CONSUME(i),r.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,i,e,r,Wo],e,Ps,t,Wo)}}manyInternal(t,e){const n=this.getKeyForAutomaticLookahead(768,t);return this.manyInternalLogic(t,e,n)}manyInternalLogic(t,e,n){let r,i=this.getLaFuncFromCache(n);if("function"!=typeof e){r=e.DEF;const t=e.GATE;if(void 0!==t){const e=i;i=()=>t.call(this)&&e.call(this)}}else r=e;let o=!0;for(;!0===i.call(this)&&!0===o;)o=this.doSingleRepetition(r);this.attemptInRepetitionRecovery(this.manyInternal,[t,e],i,768,t,Go,o)}manySepFirstInternal(t,e){const n=this.getKeyForAutomaticLookahead(Cs,t);this.manySepFirstInternalLogic(t,e,n)}manySepFirstInternalLogic(t,e,n){const r=e.DEF,i=e.SEP;if(!0===this.getLaFuncFromCache(n).call(this)){r.call(this);const e=()=>this.tokenMatcher(this.LA(1),i);for(;!0===this.tokenMatcher(this.LA(1),i);)this.CONSUME(i),r.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,i,e,r,Ko],e,Cs,t,Ko)}}repetitionSepSecondInternal(t,e,n,r,i){for(;n();)this.CONSUME(e),r.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,e,n,r,i],n,Ps,t,i)}doSingleRepetition(t){const e=this.getLexerPosition();return t.call(this),this.getLexerPosition()>e}orInternal(t,e){const n=this.getKeyForAutomaticLookahead(256,e),r=A(t)?t:t.DEF,i=this.getLaFuncFromCache(n).call(this,r);if(void 0!==i)return r[i].ALT.call(this);this.raiseNoAltException(e,t.ERR_MSG)}ruleFinallyStateUpdate(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),0===this.RULE_STACK.length&&!1===this.isAtEndOfInput()){const t=this.LA(1),e=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:t,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new Ss(e,t))}}subruleInternal(t,e,n){let r;try{const i=void 0!==n?n.ARGS:void 0;return this.subruleIdx=e,r=t.apply(this,i),this.cstPostNonTerminal(r,void 0!==n&&void 0!==n.LABEL?n.LABEL:t.ruleName),r}catch(e){throw this.subruleInternalError(e,n,t.ruleName)}}subruleInternalError(t,e,n){throw vs(t)&&void 0!==t.partialCstResult&&(this.cstPostNonTerminal(t.partialCstResult,void 0!==e&&void 0!==e.LABEL?e.LABEL:n),delete t.partialCstResult),t}consumeInternal(t,e,n){let r;try{const e=this.LA(1);!0===this.tokenMatcher(e,t)?(this.consumeToken(),r=e):this.consumeInternalError(t,e,n)}catch(n){r=this.consumeInternalRecovery(t,e,n)}return this.cstPostTerminal(void 0!==n&&void 0!==n.LABEL?n.LABEL:t.name,r),r}consumeInternalError(t,e,n){let r;const i=this.LA(0);throw r=void 0!==n&&n.ERR_MSG?n.ERR_MSG:this.errorMessageProvider.buildMismatchTokenMessage({expected:t,actual:e,previous:i,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new Rs(r,e,i))}consumeInternalRecovery(t,e,n){if(!this.recoveryEnabled||"MismatchedTokenException"!==n.name||this.isBackTracking())throw n;{const r=this.getFollowsForInRuleRecovery(t,e);try{return this.tryInRuleRecovery(t,r)}catch(t){throw t.name===Ns?n:t}}}saveRecogState(){const t=this.errors,e=Nn(this.RULE_STACK);return{errors:t,lexerState:this.exportLexerState(),RULE_STACK:e,CST_STACK:this.CST_STACK}}reloadRecogState(t){this.errors=t.errors,this.importLexerState(t.lexerState),this.RULE_STACK=t.RULE_STACK}ruleInvocationStateUpdate(t,e,n){this.RULE_OCCURRENCE_STACK.push(n),this.RULE_STACK.push(t),this.cstInvocationStateUpdate(e)}isBackTracking(){return 0!==this.isBackTrackingStack.length}getCurrRuleFullName(){const t=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[t]}shortRuleNameToFullName(t){return this.shortRuleNameToFull[t]}isAtEndOfInput(){return this.tokenMatcher(this.LA(1),So)}reset(){this.resetLexerState(),this.subruleIdx=0,this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]}},class{ACTION(t){return t.call(this)}consume(t,e,n){return this.consumeInternal(e,t,n)}subrule(t,e,n){return this.subruleInternal(e,t,n)}option(t,e){return this.optionInternal(e,t)}or(t,e){return this.orInternal(e,t)}many(t,e){return this.manyInternal(t,e)}atLeastOne(t,e){return this.atLeastOneInternal(t,e)}CONSUME(t,e){return this.consumeInternal(t,0,e)}CONSUME1(t,e){return this.consumeInternal(t,1,e)}CONSUME2(t,e){return this.consumeInternal(t,2,e)}CONSUME3(t,e){return this.consumeInternal(t,3,e)}CONSUME4(t,e){return this.consumeInternal(t,4,e)}CONSUME5(t,e){return this.consumeInternal(t,5,e)}CONSUME6(t,e){return this.consumeInternal(t,6,e)}CONSUME7(t,e){return this.consumeInternal(t,7,e)}CONSUME8(t,e){return this.consumeInternal(t,8,e)}CONSUME9(t,e){return this.consumeInternal(t,9,e)}SUBRULE(t,e){return this.subruleInternal(t,0,e)}SUBRULE1(t,e){return this.subruleInternal(t,1,e)}SUBRULE2(t,e){return this.subruleInternal(t,2,e)}SUBRULE3(t,e){return this.subruleInternal(t,3,e)}SUBRULE4(t,e){return this.subruleInternal(t,4,e)}SUBRULE5(t,e){return this.subruleInternal(t,5,e)}SUBRULE6(t,e){return this.subruleInternal(t,6,e)}SUBRULE7(t,e){return this.subruleInternal(t,7,e)}SUBRULE8(t,e){return this.subruleInternal(t,8,e)}SUBRULE9(t,e){return this.subruleInternal(t,9,e)}OPTION(t){return this.optionInternal(t,0)}OPTION1(t){return this.optionInternal(t,1)}OPTION2(t){return this.optionInternal(t,2)}OPTION3(t){return this.optionInternal(t,3)}OPTION4(t){return this.optionInternal(t,4)}OPTION5(t){return this.optionInternal(t,5)}OPTION6(t){return this.optionInternal(t,6)}OPTION7(t){return this.optionInternal(t,7)}OPTION8(t){return this.optionInternal(t,8)}OPTION9(t){return this.optionInternal(t,9)}OR(t){return this.orInternal(t,0)}OR1(t){return this.orInternal(t,1)}OR2(t){return this.orInternal(t,2)}OR3(t){return this.orInternal(t,3)}OR4(t){return this.orInternal(t,4)}OR5(t){return this.orInternal(t,5)}OR6(t){return this.orInternal(t,6)}OR7(t){return this.orInternal(t,7)}OR8(t){return this.orInternal(t,8)}OR9(t){return this.orInternal(t,9)}MANY(t){this.manyInternal(0,t)}MANY1(t){this.manyInternal(1,t)}MANY2(t){this.manyInternal(2,t)}MANY3(t){this.manyInternal(3,t)}MANY4(t){this.manyInternal(4,t)}MANY5(t){this.manyInternal(5,t)}MANY6(t){this.manyInternal(6,t)}MANY7(t){this.manyInternal(7,t)}MANY8(t){this.manyInternal(8,t)}MANY9(t){this.manyInternal(9,t)}MANY_SEP(t){this.manySepFirstInternal(0,t)}MANY_SEP1(t){this.manySepFirstInternal(1,t)}MANY_SEP2(t){this.manySepFirstInternal(2,t)}MANY_SEP3(t){this.manySepFirstInternal(3,t)}MANY_SEP4(t){this.manySepFirstInternal(4,t)}MANY_SEP5(t){this.manySepFirstInternal(5,t)}MANY_SEP6(t){this.manySepFirstInternal(6,t)}MANY_SEP7(t){this.manySepFirstInternal(7,t)}MANY_SEP8(t){this.manySepFirstInternal(8,t)}MANY_SEP9(t){this.manySepFirstInternal(9,t)}AT_LEAST_ONE(t){this.atLeastOneInternal(0,t)}AT_LEAST_ONE1(t){return this.atLeastOneInternal(1,t)}AT_LEAST_ONE2(t){this.atLeastOneInternal(2,t)}AT_LEAST_ONE3(t){this.atLeastOneInternal(3,t)}AT_LEAST_ONE4(t){this.atLeastOneInternal(4,t)}AT_LEAST_ONE5(t){this.atLeastOneInternal(5,t)}AT_LEAST_ONE6(t){this.atLeastOneInternal(6,t)}AT_LEAST_ONE7(t){this.atLeastOneInternal(7,t)}AT_LEAST_ONE8(t){this.atLeastOneInternal(8,t)}AT_LEAST_ONE9(t){this.atLeastOneInternal(9,t)}AT_LEAST_ONE_SEP(t){this.atLeastOneSepFirstInternal(0,t)}AT_LEAST_ONE_SEP1(t){this.atLeastOneSepFirstInternal(1,t)}AT_LEAST_ONE_SEP2(t){this.atLeastOneSepFirstInternal(2,t)}AT_LEAST_ONE_SEP3(t){this.atLeastOneSepFirstInternal(3,t)}AT_LEAST_ONE_SEP4(t){this.atLeastOneSepFirstInternal(4,t)}AT_LEAST_ONE_SEP5(t){this.atLeastOneSepFirstInternal(5,t)}AT_LEAST_ONE_SEP6(t){this.atLeastOneSepFirstInternal(6,t)}AT_LEAST_ONE_SEP7(t){this.atLeastOneSepFirstInternal(7,t)}AT_LEAST_ONE_SEP8(t){this.atLeastOneSepFirstInternal(8,t)}AT_LEAST_ONE_SEP9(t){this.atLeastOneSepFirstInternal(9,t)}RULE(t,e,n=ea){if(Or(this.definedRulesNames,t)){const e={message:ko.buildDuplicateRuleNameError({topLevelRule:t,grammarName:this.className}),type:na.DUPLICATE_RULE_NAME,ruleName:t};this.definitionErrors.push(e)}this.definedRulesNames.push(t);const r=this.defineRule(t,e,n);return this[t]=r,r}OVERRIDE_RULE(t,e,n=ea){const r=function(t,e,n){const r=[];let i;return Or(e,t)||(i=`Invalid rule override, rule: ->${t}<- cannot be overridden in the grammar: ->${n}<-as it is not defined in any of the super grammars `,r.push({message:i,type:na.INVALID_RULE_OVERRIDE,ruleName:t})),r}(t,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(r);const i=this.defineRule(t,e,n);return this[t]=i,i}BACKTRACK(t,e){return function(){this.isBackTrackingStack.push(1);const n=this.saveRecogState();try{return t.apply(this,e),!0}catch(t){if(vs(t))return!1;throw t}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}}getGAstProductions(){return this.gastProductionsCache}getSerializedGastProductions(){return t=tt(this.gastProductionsCache),We(t,mr);var t}},class{initErrorHandler(t){this._errors=[],this.errorMessageProvider=Ye(t,"errorMessageProvider")?t.errorMessageProvider:ta.errorMessageProvider}SAVE_ERROR(t){if(vs(t))return t.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Nn(this.RULE_OCCURRENCE_STACK)},this._errors.push(t),t;throw Error("Trying to save an Error which is not a RecognitionException")}get errors(){return Nn(this._errors)}set errors(t){this._errors=t}raiseEarlyExitException(t,e,n){const r=this.getCurrRuleFullName(),i=ss(t,this.getGAstProductions()[r],e,this.maxLookahead)[0],o=[];for(let t=1;t<=this.maxLookahead;t++)o.push(this.LA(t));const s=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:i,actual:o,previous:this.LA(0),customUserDescription:n,ruleName:r});throw this.SAVE_ERROR(new Ls(s,this.LA(1),this.LA(0)))}raiseNoAltException(t,e){const n=this.getCurrRuleFullName(),r=os(t,this.getGAstProductions()[n],this.maxLookahead),i=[];for(let t=1;t<=this.maxLookahead;t++)i.push(this.LA(t));const o=this.LA(0),s=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:r,actual:i,previous:o,customUserDescription:e,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new Os(s,this.LA(1),o))}},class{initContentAssist(){}computeContentAssist(t,e){const n=this.gastProductionsCache[t];if(Vr(n))throw Error(`Rule ->${t}<- does not exist in this grammar.`);return Ho([n],e,this.tokenMatcher,this.maxLookahead)}getNextPossibleTokenTypes(t){const e=_i(t.ruleStack),n=this.getGAstProductions()[e];return new $o(n,t).startWalking()}},class{initGastRecorder(t){this.recordingProdStack=[],this.RECORDING_PHASE=!1}enableRecording(){this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",(()=>{for(let t=0;t<10;t++){const e=t>0?t:"";this[`CONSUME${e}`]=function(e,n){return this.consumeInternalRecord(e,t,n)},this[`SUBRULE${e}`]=function(e,n){return this.subruleInternalRecord(e,t,n)},this[`OPTION${e}`]=function(e){return this.optionInternalRecord(e,t)},this[`OR${e}`]=function(e){return this.orInternalRecord(e,t)},this[`MANY${e}`]=function(e){this.manyInternalRecord(t,e)},this[`MANY_SEP${e}`]=function(e){this.manySepFirstInternalRecord(t,e)},this[`AT_LEAST_ONE${e}`]=function(e){this.atLeastOneInternalRecord(t,e)},this[`AT_LEAST_ONE_SEP${e}`]=function(e){this.atLeastOneSepFirstInternalRecord(t,e)}}this.consume=function(t,e,n){return this.consumeInternalRecord(e,t,n)},this.subrule=function(t,e,n){return this.subruleInternalRecord(e,t,n)},this.option=function(t,e){return this.optionInternalRecord(e,t)},this.or=function(t,e){return this.orInternalRecord(e,t)},this.many=function(t,e){this.manyInternalRecord(t,e)},this.atLeastOne=function(t,e){this.atLeastOneInternalRecord(t,e)},this.ACTION=this.ACTION_RECORD,this.BACKTRACK=this.BACKTRACK_RECORD,this.LA=this.LA_RECORD}))}disableRecording(){this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",(()=>{const t=this;for(let e=0;e<10;e++){const n=e>0?e:"";delete t[`CONSUME${n}`],delete t[`SUBRULE${n}`],delete t[`OPTION${n}`],delete t[`OR${n}`],delete t[`MANY${n}`],delete t[`MANY_SEP${n}`],delete t[`AT_LEAST_ONE${n}`],delete t[`AT_LEAST_ONE_SEP${n}`]}delete t.consume,delete t.subrule,delete t.option,delete t.or,delete t.many,delete t.atLeastOne,delete t.ACTION,delete t.BACKTRACK,delete t.LA}))}ACTION_RECORD(t){}BACKTRACK_RECORD(t,e){return()=>!0}LA_RECORD(t){return Qs}topLevelRuleRecord(t,e){try{const n=new ar({definition:[],name:t});return n.name=t,this.recordingProdStack.push(n),e.call(this),this.recordingProdStack.pop(),n}catch(t){if(!0!==t.KNOWN_RECORDER_ERROR)try{t.message=t.message+'\n\t This error was thrown during the "grammar recording phase" For more info see:\n\thttps://chevrotain.io/docs/guide/internals.html#grammar-recording'}catch(e){throw t}throw t}}optionInternalRecord(t,e){return qs.call(this,lr,t,e)}atLeastOneInternalRecord(t,e){qs.call(this,ur,e,t)}atLeastOneSepFirstInternalRecord(t,e){qs.call(this,hr,e,t,Vs)}manyInternalRecord(t,e){qs.call(this,fr,e,t)}manySepFirstInternalRecord(t,e){qs.call(this,pr,e,t,Vs)}orInternalRecord(t,e){return Xs.call(this,t,e)}subruleInternalRecord(t,e,n){if(Js(e),!t||!1===Ye(t,"ruleName")){const n=new Error(`<SUBRULE${Zs(e)}> argument is invalid expecting a Parser method reference but got: <${JSON.stringify(t)}>\n inside top level rule: <${this.recordingProdStack[0].name}>`);throw n.KNOWN_RECORDER_ERROR=!0,n}const r=Qi(this.recordingProdStack),i=t.ruleName,o=new sr({idx:e,nonTerminalName:i,label:null==n?void 0:n.LABEL,referencedRule:void 0});return r.definition.push(o),this.outputCst?Ys:Ks}consumeInternalRecord(t,e,n){if(Js(e),!ao(t)){const n=new Error(`<CONSUME${Zs(e)}> argument is invalid expecting a TokenType reference but got: <${JSON.stringify(t)}>\n inside top level rule: <${this.recordingProdStack[0].name}>`);throw n.KNOWN_RECORDER_ERROR=!0,n}const r=Qi(this.recordingProdStack),i=new Er({idx:e,terminalType:t,label:null==n?void 0:n.LABEL});return r.definition.push(i),Hs}},class{initPerformanceTracer(t){if(Ye(t,"traceInitPerf")){const e=t.traceInitPerf,n="number"==typeof e;this.traceInitMaxIdent=n?e:1/0,this.traceInitPerf=n?e>0:e}else this.traceInitMaxIdent=0,this.traceInitPerf=ta.traceInitPerf;this.traceInitIndent=-1}TRACE_INIT(t,e){if(!0===this.traceInitPerf){this.traceInitIndent++;const n=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${n}--\x3e <${t}>`);const{time:r,value:i}=to(e),o=r>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&o(`${n}<-- <${t}> time: ${r}ms`),this.traceInitIndent--,i}return e()}}].forEach((t=>{const e=t.prototype;Object.getOwnPropertyNames(e).forEach((n=>{if("constructor"===n)return;const r=Object.getOwnPropertyDescriptor(e,n);r&&(r.get||r.set)?Object.defineProperty(ra.prototype,n,r):ra.prototype[n]=t.prototype[n]}))}));class oa extends ia{constructor(t,e=ta){const n=Nn(e);n.outputCst=!0,super(t,n)}}const sa=Oo({name:"Plus",pattern:/\+/}),aa=Oo({name:"Minus",pattern:/-/}),ca=Oo({name:"Mult",pattern:/\*/}),la=Oo({name:"Div",pattern:/\//}),ua=Oo({name:"LParen",pattern:/\(/}),ha=Oo({name:"RParen",pattern:/\)/}),fa=Oo({name:"Comma",pattern:/,/}),pa=Oo({name:"RowRange",pattern:/\$?\d+:\$?\d+/}),da=Oo({name:"NumberLiteral",pattern:/\d+(\.\d+)?/,longer_alt:pa}),Ea=Oo({name:"Variable",pattern:/[A-Za-z_][A-Za-z0-9_]*/}),ma=Oo({name:"SheetName",pattern:/[A-Za-z_][A-Za-z0-9_]*!/}),ya=Oo({name:"CellRange",pattern:/\$?[A-Za-z]+\$?\d+:\$?[A-Za-z]+\$?\d+/}),_a=Oo({name:"CellRef",pattern:/\$?[A-Za-z]+\$?\d+/}),ga=Oo({name:"StringLiteral",pattern:/(["'])(?:(?!\1).)*\1/}),Ta=Oo({name:"Concat",pattern:/&/}),va=Oo({name:"FunctionName",pattern:/[A-Za-z]+(?=\()/i,longer_alt:_a}),Aa=Oo({name:"WhiteSpace",pattern:/\s+/,group:fo.SKIPPED}),Ra=Oo({name:"GreaterThan",pattern:/>/}),Oa=Oo({name:"LessThan",pattern:/</}),Sa=Oo({name:"GreaterThanEqual",pattern:/>=/}),La=Oo({name:"LessThanEqual",pattern:/<=/}),Ia=Oo({name:"Equal",pattern:/=/}),Na=Oo({name:"NotEqual",pattern:/<>/}),ka=Oo({name:"IfFunction",pattern:/IF(?=\()/i,longer_alt:Ea}),xa=Oo({name:"TrueKeyword",pattern:/TRUE/i,longer_alt:Ea}),ba=Oo({name:"FalseKeyword",pattern:/FALSE/i,longer_alt:Ea}),Ca=Oo({name:"NullKeyword",pattern:/NULL/i,longer_alt:Ea}),Pa=Oo({name:"ArrayRowSep",pattern:/;/}),Ma=Oo({name:"RangeIntersect",pattern:/ +/}),wa=Oo({name:"ErrorConstant",pattern:/#(DIV\/0!|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!|#SPILL!)/}),Ua=Oo({name:"IfErrorFunction",pattern:/IFERROR(?=\()/i,longer_alt:Ea}),Fa=Oo({name:"IfsFunction",pattern:/IFS(?=\()/i,longer_alt:Ea}),Da=Oo({name:"SwitchFunction",pattern:/SWITCH(?=\()/i,longer_alt:Ea}),ja=Oo({name:"LCurly",pattern:/{/}),$a=Oo({name:"RCurly",pattern:/}/}),Ba=Oo({name:"ColumnRange",pattern:/\$?[A-Za-z]+:\$?[A-Za-z]+/}),Ga=Oo({name:"Power",pattern:/\*\*|\^/}),Ka=[Aa,Sa,La,Na,Ra,Oa,Ia,sa,aa,Ta,Ga,ca,la,ua,ha,ja,$a,fa,Pa,ma,Ba,pa,ya,_a,Ma,da,ga,wa,ka,Ua,Fa,Da,xa,ba,Ca,va,Ea],Va=new fo(Ka);class Wa extends oa{constructor(){super(Ka),this.cache={comparisonExpression:!1,atomicExpression:!1};const t=this;t.RULE("expression",(()=>{t.OR([{ALT:()=>t.SUBRULE(t.arrayFormula)},{ALT:()=>t.SUBRULE(t.comparisonExpression)}])})),t.RULE("arrayFormula",(()=>{t.CONSUME(ja),t.OPTION((()=>{t.CONSUME(Ia)})),t.SUBRULE(t.expression),t.MANY((()=>{t.CONSUME(fa),t.SUBRULE2(t.expression)})),t.CONSUME($a)})),t.RULE("comparisonExpression",(()=>{t.SUBRULE(t.additionExpression,{LABEL:"lhs"}),t.OPTION((()=>{t.cache.comparisonExpression||t.OR([{ALT:()=>t.CONSUME(Ra)},{ALT:()=>t.CONSUME(Oa)},{ALT:()=>t.CONSUME(Sa)},{ALT:()=>t.CONSUME(La)},{ALT:()=>t.CONSUME(Ia)},{ALT:()=>t.CONSUME(Na)}]),t.SUBRULE2(t.additionExpression,{LABEL:"rhs"})}))})),t.RULE("additionExpression",(()=>{t.SUBRULE(t.concatenationExpression,{LABEL:"lhs"}),t.MANY((()=>{t.OR([{ALT:()=>t.CONSUME(sa)},{ALT:()=>t.CONSUME(aa)}]),t.SUBRULE2(t.concatenationExpression,{LABEL:"rhs"})}))})),t.RULE("concatenationExpression",(()=>{t.SUBRULE(t.multiplicationExpression,{LABEL:"lhs"}),t.MANY((()=>{t.CONSUME(Ta),t.SUBRULE2(t.multiplicationExpression,{LABEL:"rhs"})}))})),t.RULE("multiplicationExpression",(()=>{t.SUBRULE(t.exponentiationExpression,{LABEL:"lhs"}),t.MANY((()=>{t.OR([{ALT:()=>t.CONSUME(ca)},{ALT:()=>t.CONSUME(la)}]),t.SUBRULE2(t.exponentiationExpression,{LABEL:"rhs"})}))})),t.RULE("exponentiationExpression",(()=>{t.SUBRULE(t.unaryExpression,{LABEL:"lhs"}),t.MANY((()=>{t.CONSUME(Ga),t.SUBRULE2(t.unaryExpression,{LABEL:"rhs"})}))})),t.RULE("unaryExpression",(()=>{t.OR([{ALT:()=>{t.CONSUME(aa),t.SUBRULE(t.unaryExpression)}},{ALT:()=>t.SUBRULE(t.atomicExpression)}])})),t.RULE("atomicExpression",(()=>{t.cache.atomicExpression||t.OR([{ALT:()=>t.CONSUME(da)},{ALT:()=>t.CONSUME(ga)},{ALT:()=>t.CONSUME(xa)},{ALT:()=>t.CONSUME(ba)},{ALT:()=>t.CONSUME(Ca)},{ALT:()=>{t.OPTION((()=>{t.CONSUME(ma)})),t.OR1([{ALT:()=>t.CONSUME(Ea)},{ALT:()=>t.CONSUME(_a)},{ALT:()=>t.CONSUME(ya)},{ALT:()=>t.CONSUME(pa)},{ALT:()=>t.CONSUME(Ba)}])}},{ALT:()=>t.SUBRULE(t.ifFunctionCall)},{ALT:()=>t.SUBRULE(t.functionCall)},{ALT:()=>t.CONSUME(wa)},{ALT:()=>t.SUBRULE(t.ifErrorFunctionCall)},{ALT:()=>t.SUBRULE(t.ifsFunctionCall)},{ALT:()=>t.SUBRULE(t.switchFunctionCall)},{ALT:()=>{t.CONSUME(ua),t.SUBRULE(t.expression),t.CONSUME(ha)}}])})),t.RULE("ifFunctionCall",(()=>{t.CONSUME(ka),t.CONSUME(ua),t.SUBRULE(t.expression,{LABEL:"condition"}),t.CONSUME1(fa),t.SUBRULE2(t.expression,{LABEL:"whenTrue"}),t.OPTION((()=>{t.CONSUME2(fa),t.SUBRULE3(t.expression,{LABEL:"whenFalse"})})),t.CONSUME(ha)})),t.RULE("ifErrorFunctionCall",(()=>{t.CONSUME(Ua),t.CONSUME(ua),t.SUBRULE(t.expression,{LABEL:"value"}),t.CONSUME1(fa),t.SUBRULE2(t.expression,{LABEL:"valueIfError"}),t.CONSUME(ha)})),t.RULE("ifsFunctionCall",(()=>{t.CONSUME(Fa),t.CONSUME(ua),t.AT_LEAST_ONE((()=>{t.SUBRULE(t.expression,{LABEL:"condition"}),t.CONSUME1(fa),t.SUBRULE2(t.expression,{LABEL:"value"}),t.OPTION((()=>t.CONSUME2(fa)))})),t.CONSUME(ha)})),t.RULE("switchFunctionCall",(()=>{t.CONSUME(Da),t.CONSUME(ua),t.SUBRULE(t.expression,{LABEL:"expression"}),t.CONSUME1(fa),t.AT_LEAST_ONE((()=>{t.SUBRULE2(t.expression,{LABEL:"value"}),t.CONSUME2(fa),t.SUBRULE3(t.expression,{LABEL:"result"}),t.OPTION((()=>t.CONSUME3(fa)))})),t.OPTION2((()=>{t.SUBRULE4(t.expression,{LABEL:"default"})})),t.CONSUME(ha)})),t.RULE("functionCall",(()=>{t.CONSUME(va),t.CONSUME(ua),t.OPTION((()=>{t.SUBRULE(t.expression),t.MANY((()=>{t.CONSUME(fa),t.SUBRULE2(t.expression)}))})),t.CONSUME(ha)})),t.RULE("arrayExpression",(()=>{t.CONSUME(ua),t.SUBRULE(t.arrayRow),t.MANY((()=>{t.CONSUME(Pa),t.SUBRULE2(t.arrayRow)})),t.CONSUME(ha)})),t.RULE("arrayRow",(()=>{t.SUBRULE(t.expression),t.MANY((()=>{t.CONSUME(fa),t.SUBRULE2(t.expression)}))})),this.performSelfAnalysis()}parse(t){console.log("Parsing input:",t);const e=Va.tokenize(t);if(console.log("Lexer result:",e.tokens),e.errors.length>0)throw console.error(e.errors),new Error("Lexer errors detected");this.input=e.tokens;const n=this.expression();if(this.errors.length>0)throw console.error(this.errors),new Error("Parsing errors detected");return n}}const za=Wa,Ha=new Wa;class Ya extends(Ha.getBaseCstVisitorConstructorWithDefaults()){constructor(){super(),this.validateVisitor()}setContext(t){this.context=t}expression(t){return console.log("Visiting expression"),this.visit(t.additionExpression[0])}arrayFormula(t){console.log("Visiting arrayFormula")}comparisonExpression(t){console.log("Visiting comparisonExpression")}additionExpression(t){console.log("Visiting additionExpression")}concatenationExpression(t){console.log("Visiting concatenationExpression")}multiplicationExpression(t){console.log("Visiting multiplicationExpression")}exponentiationExpression(t){console.log("Visiting exponentiationExpression")}unaryExpression(t){console.log("Visiting unaryExpression")}atomicExpression(t){console.log("Visiting atomicExpression")}ifFunctionCall(t){console.log("Visiting ifFunctionCall")}functionCall(t){console.log("Visiting functionCall")}ifErrorFunctionCall(t){console.log("Visiting ifErrorFunctionCall")}ifsFunctionCall(t){console.log("Visiting ifsFunctionCall")}switchFunctionCall(t){console.log("Visiting switchFunctionCall")}arrayExpression(t){console.log("Visiting arrayExpression")}arrayRow(t){console.log("Visiting arrayRow")}parseInput(t){const e=Va.tokenize(t);Ha.input=e.tokens;const n=Ha.expression();if(Ha.errors.length>0)throw Error("Parsing errors detected");return this.visit(n)}parseCst(t){return this.visit(t)}}const qa=Ya;class Xa{constructor(){this._listeners={},this._isEventPaused=!1}listen(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}addListener(t,e){this.listen(t,e)}hasListener(t,e){return void 0!==this._listeners&&void 0!==this._listeners[t]&&-1!==this._listeners[t].indexOf(e)}removeListener(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}}}dispatch(t,e={}){if(!this._isEventPaused&&void 0!==this._listeners&&void 0!==(n=this._listeners[t])){e.target=self;for(var n,r=0,i=(n=n.slice(0)).length;r<i;r++)n[r].call(this,e)}}pauseListener(){this._isEventPaused=!0}resumeListener(){this._isEventPaused=!1}}var Za,Ja;!function(t){t.CALCULATION_STARTED="calculation.started",t.CALCULATION_PAUSED="calculation.paused",t.CALCULATION_RESUMED="calculation.resumed",t.CALCULATION_FINISHED="calculation.finished",t.CELL_ADDED="cell.added",t.CELL_REMOVED="cell.removed",t.CELL_CREATED="CELL_CREATED",t.ELEMENT_ATTACHED="element.attached",t.ELEMENT_DETACHED="element.detached"}(Za||(Za={})),function(t){t.CALCULATION_STARTED="calculation.started",t.CALCULATION_PAUSED="calculation.paused",t.CALCULATION_RESUMED="calculation.resumed",t.CALCULATION_FINISHED="calculation.finished",t.CALCULATION_IDLE="calculation.idle"}(Ja||(Ja={}));class Qa{constructor(t,e,n=new Xa){this.workbook=t,this.name=e,this.dispatcher=n,this._states={calculation:Ja.CALCULATION_IDLE},this._id=this._generateId()}_generateId(){return"xxxx-xxxx-xxx-xxxx".replace(/[x]/g,(t=>Math.floor(16*Math.random()).toString(16)))}set element(t){t.setAttribute("data-calx-id",this.id),this._el=t,this.dispatcher.dispatch(Za.ELEMENT_ATTACHED,{sheet:this,el:t})}get element(){return this._el}get id(){return this._id}get cells(){return this._cells.all()}calculate(t={withoutEvent:!1}){t.withoutEvent&&this.dispatcher.pauseListener(),this.dispatcher.resumeListener()}requestCalculate(t){}getCell(t){return this._cells.get(t)}getCellValue(t){return this.getCell(t).value}createCell(t,e){return this._cells.create(t,e)}eval(t){return this.workbook.setActiveSheet(this),this.workbook.parser.parse(t)}buildDependencyTree(){}}var tc=n(386);function ec(t){const e=new tc.iX;return e.yy=t,e}function nc(t){var e="";for(t=Math.round(t-1);t>=0;)e=String.fromCharCode(t%26+97)+e,t=Math.floor(t/26)-1;return e.toUpperCase()}function rc(t){const e=t.toUpperCase().split(""),n="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");let r,i,o=0;for(r=0,i=e.length-1;r<e.length;r+=1,i-=1)o+=Math.pow(n.length,i)*(n.indexOf(e[r])+1);return o}function ic(t){const e=/[A-Z]+/,n=/[0-9]+/;if(!(t=t.toUpperCase()).match(/^[A-Za-z]+[0-9]+\s*:\s*[A-Za-z]+[0-9]+$/))throw new Error("Invalid range syntax!");const r=t.split(":")[0],i=t.split(":")[1],o={start:{col:rc(r.match(e)[0]),row:parseInt(r.match(n)[0])},end:{col:rc(i.match(e)[0]),row:parseInt(i.match(n)[0])}},s=[];for(let t=Math.min(o.start.col,o.end.col);t<=Math.max(o.start.col,o.end.col);t++)for(let e=Math.min(o.start.row,o.end.row);e<=Math.max(o.start.row,o.end.row);e++)s.push(nc(t)+e+"");return s}function oc(t){return/^[01]{1,10}$/.test(t)}function sc(t,e){if(e<1)return"";for(var n="";e>0;)1&e&&(n+=t),e>>=1,t+=t;return n}function ac(t,e,n){if(null==t)return"";if(e=~~e,null==n)return sc(String(t),e);for(var r=[];e>0;r[--e]=t);return r.join(n)}function cc(t){return t.reduce((function(t,e){return t.indexOf(e)<0&&t.push(e),t}),[])}function lc(t,e,n){return Array.prototype.slice.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))}function uc(t,e,n){return Array.prototype.slice.call(t,null==e||n?1:e)}function hc(t){let e=[];for(let n=0;n<t.length;n++)if("object"==typeof t[n])for(let r in t[n])""!==t[n][r].trim()&&(e=e.concat(t[n][r]));else""!==e.concat(t[n]).join().trim()&&(e=e.concat(t[n]));return e}function fc(t){return Array.prototype.slice.call(t,0)}function pc(t){return Object.values(t)}function dc(t){var e={};for(var n in t)""!==t[n].trim()&&(e[n]=t[n]);return e}function Ec(t){var e,n,r=0,i=/[A-Z]+/,o=/[0-9]+/,s=[],a=[];for(e in t)n=rc(e.match(i)[0])-1,void 0===s[r=parseInt(e.match(o)[0],10)-1]&&(s[r]=[]),s[r][n]=t[e];var c,l=0,u=s.length;for(r=0;r<u;r++)if(void 0!==s[r]){for(c=s[r].length,void 0===a[l]&&(a[l]=[]),n=0;n<c;n++)void 0!==s[r][n]&&a[l].push(s[r][n]);l++}return a}function mc(t){var e,n,r,i,o;for(r=t.length,o=[],e=0;e<r;e++)for(i=t[e].length,n=0;n<i;n++)void 0===o[n]&&(o[n]=[]),o[n].push(t[e][n]);return o}class yc{constructor(){this._nameRegistry={}}setContext(t){this._workbook=t}define(t,e){this._nameRegistry[t]=e}resolve(t){return this._workbook.parser.parse(this._nameRegistry[t])}remove(t){delete this._nameRegistry[t]}}const _c={equal:(t,e)=>"string"==typeof t?t.toLowerCase()==(""+e).toLowerCase():t==e,notEqual:(t,e)=>"string"==typeof t?t.toLowerCase()!=(""+e).toLowerCase():t!=e,lessThan:(t,e)=>t<e,greaterThan:(t,e)=>t>e,lessEqualThan:(t,e)=>t<=e,greaterEqualThan:(t,e)=>t>=e};class gc{constructor(t,e,n){this._sheets={},this._parser=t,this._dispatcher=n,this._nameManager=e,this._nameManager.setContext(this),this._parser.yy.nameManager=this._nameManager,this._parser.yy.workbook=this,this._parser.yy.sheets=this._sheets}get parser(){return this._parser}get dispatcher(){return this._dispatcher}setActiveSheet(t){this._parser.yy.activeSheet=t}getActiveSheet(){return this._parser.yy.activeSheet}isValidCellAddress(t){return t.match(/^[A-Z]+\d+$/)}calculcate(){}build(){}hydrateObj(t){for(const e in t)if("object"==typeof t[e])this.hydrateObj(t[e]);else if("string"==typeof t[e]&&t[e].startsWith("#")){const[n,r]=t[e].split("!");n in this._sheets&&(t[e]=this._sheets[n].getCell(r).value)}}createSheet(t,e){if(!t)throw new Error("Sheet should have a name");if(this._sheets[t])throw new Error(`Sheet with the name "${t}" is already exists`);const n=new Qa(this,t);return e&&(n.element=e),this._sheets[t]=n,this._parser.yy.sheets[t]=n,n}getSheets(){return this._sheets}getSheet(t){if(t in this._sheets)return this._sheets[t];throw Error(`Sheet not found with name ${t}`)}loadData(t){var e;for(const n in t.sheets){const r=this.createSheet(n,null===(e=t.sheets[n])||void 0===e?void 0:e.element);for(const e in t.sheets[n].cells){const i=t.sheets[n].cells[e];if(i.hasOwnProperty("formula"))r.createCell(e,i);else for(const t in i)r.createCell(t,i[t])}}}static createFromData(e){const n={sheets:{},utility:t,comparator:_c},r=ec(n),i=new Xa,o=new yc,s=new gc(r,o,i);return n.workbook=s,s.loadData(e),s}static createFromElement(e,n){const r=ec({sheets:{},utility:t,comparator:null}),i=new Xa,o=new yc,s=new gc(r,o,i);return s.loadData(n),s}}function Tc(){return vc({sheets:{}})}function vc(t){return gc.createFromData(t)}function Ac(t,e){return gc.createFromElement(t,e)}function Rc(){return new za}function Oc(){return new qa}})(),r})()));
//# sourceMappingURL=calx.js.map